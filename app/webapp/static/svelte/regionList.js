var regionList=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function c(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let r,i;function s(t,e){return r||(r=document.createElement("a")),r.href=e,t===r.href}function a(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode&&t.parentNode.removeChild(t)}function f(t){return document.createElement(t)}function g(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function p(t){return document.createTextNode(t)}function m(){return p(" ")}function h(){return p("")}function b(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function $(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function y(t,e){e=""+e,t.data!==e&&(t.data=e)}function k(t,e,n){t.classList[n?"add":"remove"](e)}function v(t){i=t}function w(){const t=function(){if(!i)throw new Error("Function called outside component initialization");return i}();return(e,n,{cancelable:o=!1}={})=>{const c=t.$$.callbacks[e];if(c){const l=function(t,e,{bubbles:n=!1,cancelable:o=!1}={}){const c=document.createEvent("CustomEvent");return c.initCustomEvent(t,n,o,e),c}(e,n,{cancelable:o});return c.slice().forEach((e=>{e.call(t,l)})),!l.defaultPrevented}return!0}}const x=[],S=[];let _=[];const E=[],L=Promise.resolve();let N=!1;function O(t){_.push(t)}const j=new Set;let C=0;function A(){if(0!==C)return;const t=i;do{try{for(;C<x.length;){const t=x[C];C++,v(t),P(t.$$)}}catch(t){throw x.length=0,C=0,t}for(v(null),x.length=0,C=0;S.length;)S.pop()();for(let t=0;t<_.length;t+=1){const e=_[t];j.has(e)||(j.add(e),e())}_.length=0}while(x.length);for(;E.length;)E.pop()();N=!1,j.clear(),v(t)}function P(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(O)}}const V=new Set;let I;function M(){I={r:0,c:[],p:I}}function T(){I.r||o(I.c),I=I.p}function B(t,e){t&&t.i&&(V.delete(t),t.i(e))}function R(t,e,n,o){if(t&&t.o){if(V.has(t))return;V.add(t),I.c.push((()=>{V.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function z(t,e){R(t,1,1,(()=>{e.delete(t.key)}))}function H(t,n,l,r){const{fragment:i,after_update:s}=t.$$;i&&i.m(n,l),r||O((()=>{const n=t.$$.on_mount.map(e).filter(c);t.$$.on_destroy?t.$$.on_destroy.push(...n):o(n),t.$$.on_mount=[]})),s.forEach(O)}function J(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];_.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),_=e}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function U(t,e){-1===t.$$.dirty[0]&&(x.push(t),N||(N=!0,L.then(A)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function q(e,c,l,r,s,a,u,f=[-1]){const g=i;v(e);const p=e.$$={fragment:null,ctx:[],props:a,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c.context||(g?g.$$.context:[])),callbacks:n(),dirty:f,skip_bound:!1,root:c.target||g.$$.root};u&&u(p.root);let m=!1;if(p.ctx=l?l(e,c.props||{},((t,n,...o)=>{const c=o.length?o[0]:n;return p.ctx&&s(p.ctx[t],p.ctx[t]=c)&&(!p.skip_bound&&p.bound[t]&&p.bound[t](c),m&&U(e,t)),n})):[],p.update(),m=!0,o(p.before_update),p.fragment=!!r&&r(p.ctx),c.target){if(c.hydrate){const t=function(t){return Array.from(t.childNodes)}(c.target);p.fragment&&p.fragment.l(t),t.forEach(d)}else p.fragment&&p.fragment.c();c.intro&&B(e.$$.fragment),H(e,c.target,c.anchor,c.customElement),A()}v(g)}class F{$destroy(){J(this,1),this.$destroy=t}$on(e,n){if(!c(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function G(t=null,e="full",n="full"){if(!t)return"https://via.placeholder.com/96x96?text=No+Image";if((t=t.split("_")).length<3)return"https://via.placeholder.com/96x96?text=No+Image";const o=t[t.length-1].includes(",")?t.pop().replace(".jpg",""):e,c=t.join("_").replace(".jpg","");return`${CANTALOUPE_APP_URL??"http://localhost:8182"}/iiif/2/${c}.jpg/${o}/${n}/0/default.jpg`}function D(t){let e;return{c(){e=g("path"),$(e,"fill","currentColor"),$(e,"d","M0 48C0 21.5 21.5 0 48 0l0 48V441.4l130.1-92.9c8.3-6 19.6-6 27.9 0L336 441.4V48H48V0H336c26.5 0 48 21.5 48 48V488c0 9-5 17.2-13 21.3s-17.6 3.4-24.9-1.8L192 397.5 37.9 507.5c-7.3 5.2-16.9 5.9-24.9 1.8S0 497 0 488V48z"),$(e,"class","svelte-13ytpws")},m(t,n){u(t,e,n)},d(t){t&&d(e)}}}function K(t){let e;return{c(){e=g("path"),$(e,"fill","currentColor"),$(e,"d","M0 48V487.7C0 501.1 10.9 512 24.3 512c5 0 9.9-1.5 14-4.4L192 400 345.7 507.6c4.1 2.9 9 4.4 14 4.4c13.4 0 24.3-10.9 24.3-24.3V48c0-26.5-21.5-48-48-48H48C21.5 0 0 21.5 0 48z"),$(e,"class","svelte-13ytpws")},m(t,n){u(t,e,n)},d(t){t&&d(e)}}}function Q(e){let n,c,l,r,i,p,h,y,k,v,w;function x(t,e){return t[1]?K:D}let S=x(e),_=S(e);return{c(){n=f("div"),c=f("figure"),l=f("img"),p=m(),h=f("button"),y=g("svg"),_.c(),s(l.src,r=G(e[0].metadata.img,e[0].metadata.xyhw,"96,"))||$(l,"src",r),$(l,"alt","Extracted region"),$(c,"id",i="region-"+e[0].id),$(c,"class","image is-96x96 card svelte-13ytpws"),$(y,"xmlns","http://www.w3.org/2000/svg"),$(y,"viewBox","0 0 384 512"),$(y,"class","svelte-13ytpws"),$(h,"class","button check-btn tag svelte-13ytpws"),$(n,"class",k="region image is-96x96 "+(e[1]?"checked":"")+" svelte-13ytpws"),$(n,"tabindex","-1")},m(t,o){u(t,n,o),a(n,c),a(c,l),a(n,p),a(n,h),a(h,y),_.m(y,null),v||(w=[b(n,"click",e[3]),b(n,"keyup",e[4])],v=!0)},p(t,[e]){1&e&&!s(l.src,r=G(t[0].metadata.img,t[0].metadata.xyhw,"96,"))&&$(l,"src",r),1&e&&i!==(i="region-"+t[0].id)&&$(c,"id",i),S!==(S=x(t))&&(_.d(1),_=S(t),_&&(_.c(),_.m(y,null))),2&e&&k!==(k="region image is-96x96 "+(t[1]?"checked":"")+" svelte-13ytpws")&&$(n,"class",k)},i:t,o:t,d(t){t&&d(n),_.d(),v=!1,o(w)}}}function W(t,e,n){const o=w();function c(t){o("toggleSelection",{block:t})}let{block:l}=e,{isSelected:r=!1}=e;return t.$$set=t=>{"block"in t&&n(0,l=t.block),"isSelected"in t&&n(1,r=t.isSelected)},[l,r,c,()=>c(l),t=>"Enter"===t.key&&c(l)]}class X extends F{constructor(t){super(),q(this,t,W,Q,l,{block:0,isSelected:1})}}function Y(t){localStorage.setItem("documentSet",JSON.stringify(t))}function Z(t,e,n){const{[e]:o,...c}=t[n];return t[n]=c,Y(t),t}function tt(t,e,n){const o=t.slice();return o[14]=e[n][0],o[15]=e[n][1],o}function et(t,e,n){const o=t.slice();return o[18]=e[n],o}function nt(t){let e,n,c,l=[],r=new Map,i=t[1];const s=t=>t[18].id;for(let e=0;e<i.length;e+=1){let n=et(t,i,e),o=s(n);r.set(o,l[e]=ct(o,n))}let g=null;return i.length||(g=ot()),{c(){e=f("div"),n=f("div");for(let t=0;t<l.length;t+=1)l[t].c();g&&g.c(),$(n,"class","grid is-gap-2"),$(e,"class","fixed-grid has-auto-count")},m(t,o){u(t,e,o),a(e,n);for(let t=0;t<l.length;t+=1)l[t]&&l[t].m(n,null);g&&g.m(n,null),c=!0},p(t,e){1094&e&&(i=t[1],M(),l=function(t,e,n,c,l,r,i,s,a,u,d,f){let g=t.length,p=r.length,m=g;const h={};for(;m--;)h[t[m].key]=m;const b=[],$=new Map,y=new Map,k=[];for(m=p;m--;){const t=f(l,r,m),o=n(t);let s=i.get(o);s?c&&k.push((()=>s.p(t,e))):(s=u(o,t),s.c()),$.set(o,b[m]=s),o in h&&y.set(o,Math.abs(m-h[o]))}const v=new Set,w=new Set;function x(t){B(t,1),t.m(s,d),i.set(t.key,t),d=t.first,p--}for(;g&&p;){const e=b[p-1],n=t[g-1],o=e.key,c=n.key;e===n?(d=e.first,g--,p--):$.has(c)?!i.has(o)||v.has(o)?x(e):w.has(c)?g--:y.get(o)>y.get(c)?(w.add(o),x(e)):(v.add(c),g--):(a(n,i),g--)}for(;g--;){const e=t[g];$.has(e.key)||a(e,i)}for(;p;)x(b[p-1]);return o(k),b}(l,e,s,1,t,i,r,n,z,ct,null,et),T(),i.length?g&&(g.d(1),g=null):g||(g=ot(),g.c(),g.m(n,null)))},i(t){if(!c){for(let t=0;t<i.length;t+=1)B(l[t]);c=!0}},o(t){for(let t=0;t<l.length;t+=1)R(l[t]);c=!1},d(t){t&&d(e);for(let t=0;t<l.length;t+=1)l[t].d();g&&g.d()}}}function ot(e){return{c:t,m:t,d:t}}function ct(t,e){let n,o,c;return o=new X({props:{block:e[18],appLang:e[2],isSelected:e[6](e[18])}}),o.$on("toggleSelection",e[10]),{key:t,first:null,c(){var t;n=h(),(t=o.$$.fragment)&&t.c(),this.first=n},m(t,e){u(t,n,e),H(o,t,e),c=!0},p(t,n){e=t;const c={};2&n&&(c.block=e[18]),4&n&&(c.appLang=e[2]),66&n&&(c.isSelected=e[6](e[18])),o.$set(c)},i(t){c||(B(o.$$.fragment,t),c=!0)},o(t){R(o.$$.fragment,t),c=!1},d(t){t&&d(n),J(o,t)}}}function lt(t){let e,n,o,c="en"===t[2]?"No regions in selection":"Aucune région sélectionnée";return{c(){e=f("tr"),n=f("td"),o=p(c)},m(t,c){u(t,e,c),a(e,n),a(n,o)},p(t,e){4&e&&c!==(c="en"===t[2]?"No regions in selection":"Aucune région sélectionnée")&&y(o,c)},d(t){t&&d(e)}}}function rt(t){let e,n=Object.entries(t[3][t[0]]),o=[];for(let e=0;e<n.length;e+=1)o[e]=it(tt(t,n,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=h()},m(t,n){for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,n);u(t,e,n)},p(t,c){if(9&c){let l;for(n=Object.entries(t[3][t[0]]),l=0;l<n.length;l+=1){const r=tt(t,n,l);o[l]?o[l].p(r,c):(o[l]=it(r),o[l].c(),o[l].m(e.parentNode,e))}for(;l<o.length;l+=1)o[l].d(1);o.length=n.length}},d(t){!function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(o,t),t&&d(e)}}}function it(t){let e,n,o,c,l,r,i,s,g,h,k,v,w,x,S,_,E=t[14]+"",L=t[15].title+"";function N(){return t[11](t[14])}return{c(){e=f("tr"),n=f("th"),o=f("span"),c=p("#"),l=p(E),r=m(),i=f("td"),s=f("a"),g=p(L),k=m(),v=f("td"),w=f("button"),x=m(),$(o,"class","tag px-2 py-1 mb-1 is-dark is-rounded"),$(n,"class","is-narrow is-3"),$(s,"href",h=t[15].url),$(s,"target","_blank"),$(w,"class","delete"),$(w,"aria-label","close"),$(v,"class","is-narrow")},m(t,d){u(t,e,d),a(e,n),a(n,o),a(o,c),a(o,l),a(e,r),a(e,i),a(i,s),a(s,g),a(e,k),a(e,v),a(v,w),a(e,x),S||(_=b(w,"click",N),S=!0)},p(e,n){t=e,8&n&&E!==(E=t[14]+"")&&y(l,E),8&n&&L!==(L=t[15].title+"")&&y(g,L),8&n&&h!==(h=t[15].url)&&$(s,"href",h)},d(t){t&&d(e),S=!1,_()}}}function st(t){let e,n,c,l,r,i,s,g,h,v,w,x,S,_,E,L,N,O,j,C,A,P,V,I,z,H,J,U,q,F,G,D,K,Q,W,X,Y,Z,tt,et,ot,ct,it,st,at,ut="en"===t[2]?"Selection":"Sélection",dt="en"===t[2]?"Selected regions":"Regions sélectionnées",ft="en"===t[2]?"Clear selection":"Vider la sélection",gt="en"===t[2]?"Save selection":"Sauvegarder la sélection",pt=0!==t[1].length&&nt(t);function mt(t,e){return 8&e&&(D=null),null==D&&(D=!!(t[3].hasOwnProperty(t[0])&&Object.keys(t[3][t[0]]).length>0)),D?rt:lt}let ht=mt(t,-1),bt=ht(t);return{c(){e=f("div"),n=f("button"),c=f("span"),l=f("i"),r=m(),i=p(ut),s=p("\n            ("),g=f("span"),h=p(t[7]),v=p(")"),w=m(),pt&&pt.c(),x=m(),S=f("div"),_=f("div"),E=m(),L=f("div"),N=f("div"),O=f("div"),j=f("i"),C=m(),A=p(dt),P=p("\n                ("),V=f("span"),I=p(t[7]),z=p(")"),H=m(),J=f("button"),U=m(),q=f("section"),F=f("table"),G=f("tbody"),bt.c(),K=m(),Q=f("footer"),W=f("div"),X=f("button"),Y=p(ft),Z=m(),tt=f("button"),et=f("i"),ot=m(),ct=p(gt),$(l,"class","fa-solid fa-book-bookmark"),$(g,"id","selection-count"),$(n,"id","set-btn"),$(n,"class","button px-5 py-4 is-link js-modal-trigger"),$(n,"data-target","selection-modal"),k(n,"add-animation",t[4]),k(n,"remove-animation",t[5]),$(e,"class","set-container"),$(_,"class","modal-background"),$(j,"class","fa-solid fa-book-bookmark"),$(V,"id","selection-count"),$(O,"class","title is-4 mb-0 media-content"),$(J,"class","delete media-left"),$(J,"aria-label","close"),$(N,"class","modal-card-head media mb-0"),$(F,"class","table pl-2 is-fullwidth"),$(q,"class","modal-card-body"),$(X,"class","button is-link is-light"),$(et,"class","fa-solid fa-floppy-disk"),$(tt,"class","button is-link"),$(W,"class","buttons"),$(Q,"class","modal-card-foot is-centered"),$(L,"class","modal-content"),$(S,"id","selection-modal"),$(S,"class","modal fade"),$(S,"tabindex","-1"),$(S,"aria-labelledby","selection-modal-label"),$(S,"aria-hidden","true")},m(o,d){u(o,e,d),a(e,n),a(n,c),a(c,l),a(c,r),a(c,i),a(c,s),a(c,g),a(g,h),a(c,v),u(o,w,d),pt&&pt.m(o,d),u(o,x,d),u(o,S,d),a(S,_),a(S,E),a(S,L),a(L,N),a(N,O),a(O,j),a(O,C),a(O,A),a(O,P),a(O,V),a(V,I),a(O,z),a(N,H),a(N,J),a(L,U),a(L,q),a(q,F),a(F,G),bt.m(G,null),a(L,K),a(L,Q),a(Q,W),a(W,X),a(X,Y),a(W,Z),a(W,tt),a(tt,et),a(tt,ot),a(tt,ct),it=!0,st||(at=[b(X,"click",t[9]),b(tt,"click",t[8])],st=!0)},p(t,[e]){(!it||4&e)&&ut!==(ut="en"===t[2]?"Selection":"Sélection")&&y(i,ut),(!it||128&e)&&y(h,t[7]),(!it||16&e)&&k(n,"add-animation",t[4]),(!it||32&e)&&k(n,"remove-animation",t[5]),0!==t[1].length?pt?(pt.p(t,e),2&e&&B(pt,1)):(pt=nt(t),pt.c(),B(pt,1),pt.m(x.parentNode,x)):pt&&(M(),R(pt,1,1,(()=>{pt=null})),T()),(!it||4&e)&&dt!==(dt="en"===t[2]?"Selected regions":"Regions sélectionnées")&&y(A,dt),(!it||128&e)&&y(I,t[7]),ht===(ht=mt(t,e))&&bt?bt.p(t,e):(bt.d(1),bt=ht(t),bt&&(bt.c(),bt.m(G,null))),(!it||4&e)&&ft!==(ft="en"===t[2]?"Clear selection":"Vider la sélection")&&y(Y,ft),(!it||4&e)&&gt!==(gt="en"===t[2]?"Save selection":"Sauvegarder la sélection")&&y(ct,gt)},i(t){it||(B(pt),it=!0)},o(t){R(pt),it=!1},d(t){t&&d(e),t&&d(w),pt&&pt.d(t),t&&d(x),t&&d(S),bt.d(),st=!1,o(at)}}}function at(t,e,n){let o,c,l=!1,r=!1;const i="Regions";let{regions:s=[]}=e,{appLang:a="en"}=e,u=JSON.parse(localStorage.getItem("documentSet"))??{};function d(t){n(3,u=function(t,e){return t.hasOwnProperty(e.type)||(t[e.type]=[]),t[e.type]={...t[e.type],[e.id]:e},Y(t),t}(u,t)),n(4,l=!0),setTimeout((()=>n(4,l=!1)),300)}return t.$$set=t=>{"regions"in t&&n(1,s=t.regions),"appLang"in t&&n(2,a=t.appLang)},t.$$.update=()=>{8&t.$$.dirty&&n(7,o=u.hasOwnProperty(i)?Object.keys(u[i]).length:0),8&t.$$.dirty&&n(6,c=t=>u[i]?.hasOwnProperty(t.id))},[i,s,a,u,l,r,c,o,function(){!function(t){console.log(t)}(u)},function(){n(3,(Y({}),u={}))},function(t){const{block:e}=t.detail;var o;c(e)?(o=e.id,n(3,u=Z(u,o,i)),n(5,r=!0),setTimeout((()=>n(5,r=!1)),300)):d(e)},t=>Z(t,i)]}const ut=(dt="regions-data",document.getElementById(dt)?JSON.parse(document.getElementById(dt).textContent):[]);var dt;APP_LANG;return new class extends F{constructor(t){super(),q(this,t,at,st,l,{regionsType:0,regions:1,appLang:2})}get regionsType(){return this.$$.ctx[0]}}({target:document.getElementById("region-list"),props:{regions:ut,regionsType:"Regions"}})}();
//# sourceMappingURL=regionList.js.map
