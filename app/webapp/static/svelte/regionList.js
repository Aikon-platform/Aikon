var regionList=function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function o(){return Object.create(null)}function i(t){t.forEach(n)}function s(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let r;function c(t,e){return r||(r=document.createElement("a")),r.href=e,t===r.href}function a(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function u(t,e,n){t.$$.on_destroy.push(a(e,n))}function d(t,e,n,o){return t[1]&&o?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](o(e))):n.ctx}const f="undefined"!=typeof window;let p=f?()=>window.performance.now():()=>Date.now(),g=f?t=>requestAnimationFrame(t):t;const m=new Set;function h(t){m.forEach((e=>{e.c(t)||(m.delete(e),e.f())})),0!==m.size&&g(h)}function b(t,e){t.appendChild(e)}function $(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function v(t){const e=x("style");return function(t,e){b(t.head||t,e),e.sheet}($(t),e),e.sheet}function y(t,e,n){t.insertBefore(e,n||null)}function w(t){t.parentNode&&t.parentNode.removeChild(t)}function k(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function x(t){return document.createElement(t)}function L(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function E(t){return document.createTextNode(t)}function S(){return E(" ")}function _(){return E("")}function C(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function O(t){return function(e){return e.preventDefault(),t.call(this,e)}}function P(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function N(t,e){e=""+e,t.data!==e&&(t.data=e)}function A(t,e,n){t.classList[n?"add":"remove"](e)}function j(t,e,{bubbles:n=!1,cancelable:o=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,o,e),i}const I=new Map;let R,V=0;function z(t,e,n,o,i,s,l,r=0){const c=16.666/o;let a="{\n";for(let t=0;t<=1;t+=c){const o=e+(n-e)*s(t);a+=100*t+`%{${l(o,1-o)}}\n`}const u=a+`100% {${l(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(u)}_${r}`,f=$(t),{stylesheet:p,rules:g}=I.get(f)||function(t,e){const n={stylesheet:v(e),rules:{}};return I.set(t,n),n}(f,t);g[d]||(g[d]=!0,p.insertRule(`@keyframes ${d} ${u}`,p.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?`${m}, `:""}${d} ${o}ms linear ${i}ms 1 both`,V+=1,d}function M(t,e){const n=(t.style.animation||"").split(", "),o=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),i=n.length-o.length;i&&(t.style.animation=o.join(", "),V-=i,V||g((()=>{V||(I.forEach((t=>{const{ownerNode:e}=t.stylesheet;e&&w(e)})),I.clear())})))}function T(t){R=t}function H(){if(!R)throw new Error("Function called outside component initialization");return R}const B=[],D=[];let q=[];const U=[],F=Promise.resolve();let G=!1;function J(t){q.push(t)}const X=new Set;let K,Y=0;function Q(){if(0!==Y)return;const t=R;do{try{for(;Y<B.length;){const t=B[Y];Y++,T(t),W(t.$$)}}catch(t){throw B.length=0,Y=0,t}for(T(null),B.length=0,Y=0;D.length;)D.pop()();for(let t=0;t<q.length;t+=1){const e=q[t];X.has(e)||(X.add(e),e())}q.length=0}while(B.length);for(;U.length;)U.pop()();G=!1,X.clear(),T(t)}function W(t){if(null!==t.fragment){t.update(),i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(J)}}function Z(t,e,n){t.dispatchEvent(j(`${e?"intro":"outro"}${n}`))}const tt=new Set;let et;function nt(){et={r:0,c:[],p:et}}function ot(){et.r||i(et.c),et=et.p}function it(t,e){t&&t.i&&(tt.delete(t),t.i(e))}function st(t,e,n,o){if(t&&t.o){if(tt.has(t))return;tt.add(t),et.c.push((()=>{tt.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}const lt={duration:0};function rt(n,o,l,r){const c={direction:"both"};let a=o(n,l,c),u=r?0:1,d=null,f=null,b=null;function $(){b&&M(n,b)}function v(t,e){const n=t.b-u;return e*=Math.abs(n),{a:u,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function y(o){const{delay:s=0,duration:l=300,easing:r=e,tick:c=t,css:y}=a||lt,w={start:p()+s,b:o};o||(w.group=et,et.r+=1),d||f?f=w:(y&&($(),b=z(n,u,o,l,s,r,y)),o&&c(0,1),d=v(w,l),J((()=>Z(n,o,"start"))),function(t){let e;0===m.size&&g(h),new Promise((n=>{m.add(e={c:t,f:n})}))}((t=>{if(f&&t>f.start&&(d=v(f,l),f=null,Z(n,d.b,"start"),y&&($(),b=z(n,u,d.b,d.duration,0,r,a.css))),d)if(t>=d.end)c(u=d.b,1-u),Z(n,d.b,"end"),f||(d.b?$():--d.group.r||i(d.group.c)),d=null;else if(t>=d.start){const e=t-d.start;u=d.a+d.d*r(e/d.duration),c(u,1-u)}return!(!d&&!f)})))}return{run(t){s(a)?(K||(K=Promise.resolve(),K.then((()=>{K=null}))),K).then((()=>{a=a(c),y(t)})):y(t)},end(){$(),d=f=null}}}function ct(t,e){const n=e.token={};function o(t,o,i,s){if(e.token!==n)return;e.resolved=s;let l=e.ctx;void 0!==i&&(l=l.slice(),l[i]=s);const r=t&&(e.current=t)(l);let c=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==o&&t&&(nt(),st(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),ot())})):e.block.d(1),r.c(),it(r,1),r.m(e.mount(),e.anchor),c=!0),e.block=r,e.blocks&&(e.blocks[o]=r),c&&Q()}if(!(i=t)||"object"!=typeof i&&"function"!=typeof i||"function"!=typeof i.then){if(e.current!==e.then)return o(e.then,1,e.value,t),!0;e.resolved=t}else{const n=H();if(t.then((t=>{T(n),o(e.then,1,e.value,t),T(null)}),(t=>{if(T(n),o(e.catch,2,e.error,t),T(null),!e.hasCatch)throw t})),e.current!==e.pending)return o(e.pending,0),!0}var i}function at(t,e){st(t,1,1,(()=>{e.delete(t.key)}))}function ut(t,e,n,o,s,l,r,c,a,u,d,f){let p=t.length,g=l.length,m=p;const h={};for(;m--;)h[t[m].key]=m;const b=[],$=new Map,v=new Map,y=[];for(m=g;m--;){const t=f(s,l,m),i=n(t);let c=r.get(i);c?o&&y.push((()=>c.p(t,e))):(c=u(i,t),c.c()),$.set(i,b[m]=c),i in h&&v.set(i,Math.abs(m-h[i]))}const w=new Set,k=new Set;function x(t){it(t,1),t.m(c,d),r.set(t.key,t),d=t.first,g--}for(;p&&g;){const e=b[g-1],n=t[p-1],o=e.key,i=n.key;e===n?(d=e.first,p--,g--):$.has(i)?!r.has(o)||w.has(o)?x(e):k.has(i)?p--:v.get(o)>v.get(i)?(k.add(o),x(e)):(w.add(i),p--):(a(n,r),p--)}for(;p--;){const e=t[p];$.has(e.key)||a(e,r)}for(;g;)x(b[g-1]);return i(y),b}function dt(t){t&&t.c()}function ft(t,e,o,l){const{fragment:r,after_update:c}=t.$$;r&&r.m(e,o),l||J((()=>{const e=t.$$.on_mount.map(n).filter(s);t.$$.on_destroy?t.$$.on_destroy.push(...e):i(e),t.$$.on_mount=[]})),c.forEach(J)}function pt(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];q.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),q=e}(n.after_update),i(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function gt(t,e){-1===t.$$.dirty[0]&&(B.push(t),G||(G=!0,F.then(Q)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function mt(e,n,s,l,r,c,a,u=[-1]){const d=R;T(e);const f=e.$$={fragment:null,ctx:[],props:c,update:t,not_equal:r,bound:o(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:o(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};a&&a(f.root);let p=!1;if(f.ctx=s?s(e,n.props||{},((t,n,...o)=>{const i=o.length?o[0]:n;return f.ctx&&r(f.ctx[t],f.ctx[t]=i)&&(!f.skip_bound&&f.bound[t]&&f.bound[t](i),p&&gt(e,t)),n})):[],f.update(),p=!0,i(f.before_update),f.fragment=!!l&&l(f.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);f.fragment&&f.fragment.l(t),t.forEach(w)}else f.fragment&&f.fragment.c();n.intro&&it(e.$$.fragment),ft(e,n.target,n.anchor,n.customElement),Q()}T(d)}class ht{$destroy(){pt(this,1),this.$destroy=t}$on(e,n){if(!s(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function bt(t=null,e="full",n="full"){if(!t)return"https://via.placeholder.com/96x96?text=No+Image";if((t=t.split("_")).length<3)return"https://via.placeholder.com/96x96?text=No+Image";const o=t[t.length-1].includes(",")?t.pop().replace(".jpg",""):e,i=t.join("_").replace(".jpg","");return`${CANTALOUPE_APP_URL??"http://localhost:8182"}/iiif/2/${i}.jpg/${o}/${n}/0/default.jpg`}function $t(t=null,e=1){return`${SAS_APP_URL??"http://localhost:3000"}/index.html?iiif-content=${t}&canvas=${e}`}function vt(t,e=null,n=!1){return new Promise((o=>{if(document.getElementById("msg-modal")){n&&(document.getElementById("modal-footer").hidden=!1),e&&(document.getElementById("modal-title").textContent=e),document.getElementById("modal-body").textContent=t,document.getElementById("hidden-msg-btn").click();const i=document.getElementById("cancel-btn"),s=document.getElementById("ok-btn"),l=document.getElementById("modal-bkg"),r=()=>{i.removeEventListener("click",c),l.removeEventListener("click",c),s.removeEventListener("click",a),document.getElementById("modal-footer").hidden=!0},c=()=>{r(),o(!1)},a=()=>{r(),o(!0)};i.addEventListener("click",c),s.addEventListener("click",a)}else n?o(window.confirm(t)):(window.alert(t),o(void 0))}))}const yt=[];function wt(e,n=t){let o;const i=new Set;function s(t){if(l(e,t)&&(e=t,o)){const t=!yt.length;for(const t of i)t[1](),yt.push(t,e);if(t){for(let t=0;t<yt.length;t+=2)yt[t][0](yt[t+1]);yt.length=0}}}return{set:s,update:function(t){s(t(e))},subscribe:function(l,r=t){const c=[l,r];return i.add(c),1===i.size&&(o=n(s)||t),l(e),()=>{i.delete(c),0===i.size&&o&&(o(),o=null)}}}}function kt(e,n,o){const l=!Array.isArray(e),r=l?[e]:e,c=n.length<2;return u=e=>{let o=!1;const u=[];let d=0,f=t;const p=()=>{if(d)return;f();const o=n(l?u[0]:u,e);c?e(o):f=s(o)?o:t},g=r.map(((t,e)=>a(t,(t=>{u[e]=t,d&=~(1<<e),o&&p()}),(()=>{d|=1<<e}))));return o=!0,p(),function(){i(g),f(),o=!1}},{subscribe:wt(o,u).subscribe};var u}const xt="Regions";const Lt=function(){const t=wt(JSON.parse(localStorage.getItem("documentSet"))||{}),{subscribe:e,get:n,update:o}=t;function i(t){localStorage.setItem("documentSet",JSON.stringify(t))}function s(t,e=!0){return e?t[xt]??{}:Object.entries(t).filter((([t,e])=>t!==xt))}function l(t,e,n){if(t[n]){const{[e]:o,...i}=t[n];t={...t,[n]:i}}return i(t),t}function r(t,e){return t.hasOwnProperty(e.type)||(t[e.type]={}),t[e.type]={...t[e.type],[e.id]:e},i(t),t}return{subscribe:e,save:()=>o((t=>(console.log(t),t))),empty:t=>o((e=>(t?delete e[xt]:Object.keys(e).forEach((t=>{t!==xt&&delete e[t]})),i(e),e))),addAll:t=>o((e=>function(t,e){return e.forEach((e=>{t[e.type]||(t[e.type]={}),t[e.type][e.id]=e})),i(t),t}(e,t))),removeAll:(t,e)=>o((n=>function(t,e,n){return t[n]?(e.forEach((e=>{delete t[n][e]})),i(t),t):t}(n,t,e))),remove:(t,e)=>o((n=>l(n,t,e))),add:t=>o((e=>r(e,t))),toggle:t=>o((e=>e[t.type]?.[t.id]?l(e,t.id,t.type):r(e,t))),toggleAll:(t,e,n)=>o((t=>{})),isSelected:kt(t,(t=>e=>t[e.type]?.hasOwnProperty(e.id)||!1)),selected:kt(t,(t=>e=>s(t,e))),nbSelected:kt(t,(t=>e=>{const n=s(t,e);return e?Object.keys(n).length:n.reduce(((t,[e,n])=>t+Object.keys(n).length),0)}))}}();function Et(t,{delay:n=0,duration:o=400,easing:i=e}={}){const s=+getComputedStyle(t).opacity;return{delay:n,duration:o,easing:i,css:t=>"opacity: "+t*s}}function St(t){let e;return{c(){e=L("path"),P(e,"d","M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"),P(e,"class","svelte-1fqh2ri")},m(t,n){y(t,e,n)},d(t){t&&w(e)}}}function _t(t){let e;return{c(){e=L("path"),P(e,"d","M208 0H332.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H208c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128h80v64H64V448H256V416h64v48c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48z"),P(e,"class","svelte-1fqh2ri")},m(t,n){y(t,e,n)},d(t){t&&w(e)}}}function Ct(t){let e,n="en"===t[2]?"Copy ID":"Copier l'ID";return{c(){e=E(n)},m(t,n){y(t,e,n)},p(t,o){4&o&&n!==(n="en"===t[2]?"Copy ID":"Copier l'ID")&&N(e,n)},d(t){t&&w(e)}}}function Ot(t){let e,n="en"===t[2]?"Copied!":"Copié !";return{c(){e=E(n)},m(t,n){y(t,e,n)},p(t,o){4&o&&n!==(n="en"===t[2]?"Copied!":"Copié !")&&N(e,n)},d(t){t&&w(e)}}}function Pt(t){let e,n,o,s,l,r,a,u,d,f,p,g,m,h,$,v,k,_,O=t[0].title+"";function A(t,e){return t[1]?_t:St}let j=A(t),I=j(t);function R(t,e){return t[1]?Ot:Ct}let V=R(t),z=V(t);return{c(){e=x("div"),n=x("figure"),o=x("img"),l=S(),r=x("div"),a=x("span"),u=E(O),d=S(),f=x("button"),p=L("svg"),I.c(),g=S(),m=x("span"),z.c(),c(o.src,s=bt(t[0].img,t[0].xyhw,"96,"))||P(o,"src",s),P(o,"alt","Extracted region"),P(a,"class","overlay-desc"),P(r,"class","overlay is-center svelte-1fqh2ri"),P(n,"class","image is-96x96 card svelte-1fqh2ri"),P(n,"tabindex","-1"),P(p,"xmlns","http://www.w3.org/2000/svg"),P(p,"viewBox","0 0 384 512"),P(p,"class","svelte-1fqh2ri"),P(m,"class","tooltip svelte-1fqh2ri"),P(f,"class","button region-btn tag svelte-1fqh2ri"),P(e,"class",h="region image is-96x96 is-center "+(t[3](t[0])?"checked":"")+" svelte-1fqh2ri")},m(i,s){y(i,e,s),b(e,n),b(n,o),b(n,l),b(n,r),b(r,a),b(a,u),b(e,d),b(e,f),b(f,p),I.m(p,null),b(f,g),b(f,m),z.m(m,null),v=!0,k||(_=[C(n,"click",t[6]),C(n,"keyup",Nt),C(f,"click",t[7])],k=!0)},p(t,[n]){(!v||1&n&&!c(o.src,s=bt(t[0].img,t[0].xyhw,"96,")))&&P(o,"src",s),(!v||1&n)&&O!==(O=t[0].title+"")&&N(u,O),j!==(j=A(t))&&(I.d(1),I=j(t),I&&(I.c(),I.m(p,null))),V===(V=R(t))&&z?z.p(t,n):(z.d(1),z=V(t),z&&(z.c(),z.m(m,null))),(!v||9&n&&h!==(h="region image is-96x96 is-center "+(t[3](t[0])?"checked":"")+" svelte-1fqh2ri"))&&P(e,"class",h)},i(t){v||(J((()=>{v&&($||($=rt(e,Et,{duration:500},!0)),$.run(1))})),v=!0)},o(t){$||($=rt(e,Et,{duration:500},!1)),$.run(0),v=!1},d(t){t&&w(e),I.d(),z.d(),t&&$&&$.end(),k=!1,i(_)}}}const Nt=()=>null;function At(t,e,n){let o;const{isSelected:i}=Lt;u(t,i,(t=>n(3,o=t)));let{item:s}=e,{isCopied:l=!1}=e,{appLang:r="en"}=e;function c(){dispatch("copyRef",{item:s})}return t.$$set=t=>{"item"in t&&n(0,s=t.item),"isCopied"in t&&n(1,l=t.isCopied),"appLang"in t&&n(2,r=t.appLang)},[s,l,r,o,i,c,()=>Lt.toggle(s),()=>c()]}class jt extends ht{constructor(t){super(),mt(this,t,At,Pt,l,{item:0,isCopied:1,appLang:2})}}function It(e){let n,o,i,s,l,r,c,a,u,d="en"===e[1]?"Selection":"Sélection";return{c(){n=x("div"),o=x("button"),i=x("span"),s=x("i"),l=S(),r=E(d),c=E("\n            ("),a=E(e[0]),u=E(")"),P(s,"class","fa-solid fa-book-bookmark"),P(i,"id","btn-content"),P(o,"id","set-btn"),P(o,"class","button px-5 py-4 is-link js-modal-trigger svelte-hs48f9"),P(o,"data-target","selection-modal"),P(n,"class","set-container svelte-hs48f9")},m(t,e){y(t,n,e),b(n,o),b(o,i),b(i,s),b(i,l),b(i,r),b(i,c),b(i,a),b(i,u)},p(t,[e]){2&e&&d!==(d="en"===t[1]?"Selection":"Sélection")&&N(r,d),1&e&&N(a,t[0])},i:t,o:t,d(t){t&&w(n)}}}function Rt(t,e,n){let{selectionLength:o=0}=e,{appLang:i="en"}=e,s=o;return t.$$set=t=>{"selectionLength"in t&&n(0,o=t.selectionLength),"appLang"in t&&n(1,i=t.appLang)},t.$$.update=()=>{if(5&t.$$.dirty&&o!==s){const t=o>s;n(2,s=o);const e=document.getElementById("btn-content");e&&e.animate([{transform:t?"translateY(-7px)":"translateX(-5px)"},{transform:t?"translateY(7px)":"translateX(5px)"},{transform:"translate(0)"}],{duration:300,easing:"cubic-bezier(0.65, 0, 0.35, 1)"})}},[o,i,s]}class Vt extends ht{constructor(t){super(),mt(this,t,Rt,It,l,{selectionLength:0,appLang:1})}}function zt(e){let n,o,s,l,r,c,a,u,d,f,p,g="en"===e[0]?"Clear selection":"Vider la sélection",m="en"===e[0]?"Save selection":"Sauvegarder la sélection";return{c(){n=x("footer"),o=x("div"),s=x("button"),l=E(g),r=S(),c=x("button"),a=x("i"),u=S(),d=E(m),P(s,"class","button is-link is-light"),P(a,"class","fa-solid fa-floppy-disk"),P(c,"class","button is-link"),P(o,"class","buttons"),P(n,"class","modal-card-foot is-center")},m(t,i){y(t,n,i),b(n,o),b(o,s),b(s,l),b(o,r),b(o,c),b(c,a),b(c,u),b(c,d),f||(p=[C(s,"click",e[2]),C(c,"click",e[3])],f=!0)},p(t,[e]){1&e&&g!==(g="en"===t[0]?"Clear selection":"Vider la sélection")&&N(l,g),1&e&&m!==(m="en"===t[0]?"Save selection":"Sauvegarder la sélection")&&N(d,m)},i:t,o:t,d(t){t&&w(n),f=!1,i(p)}}}function Mt(t,e,n){let{appLang:o="en"}=e,{isRegion:i=!0}=e;return t.$$set=t=>{"appLang"in t&&n(0,o=t.appLang),"isRegion"in t&&n(1,i=t.isRegion)},[o,i,()=>Lt.empty(i),()=>Lt.save()]}class Tt extends ht{constructor(t){super(),mt(this,t,Mt,zt,l,{appLang:0,isRegion:1})}}function Ht(t){let e,n,o,i,s,l,r,a,u,f,p,g,m,h,$,v,k,L;const _=t[4].default,C=function(t,e,n,o){if(t){const i=d(t,e,n,o);return t[0](i)}}(_,t,t[3],null);return{c(){var d,b,y,w;e=x("tr"),n=x("th"),o=x("div"),i=x("img"),r=S(),a=x("div"),u=x("a"),f=x("i"),p=E("\n                    Page "),g=E(t[0]),h=S(),$=x("td"),v=x("div"),k=x("div"),C&&C.c(),c(i.src,s=bt(t[1],"full","250,"))||P(i,"src",s),P(i,"alt",l="Canvas "+t[0]),P(i,"class","mb-3 card"),P(f,"class","fa-solid fa-pen-to-square"),P(u,"class","tag px-2 py-1 is-rounded"),P(u,"href",m=$t(t[2],t[0])),P(u,"target","_blank"),P(a,"class","is-center mb-1"),P(o,"class","content-wrapper py-5"),P(n,"class","is-3 center-flex is-narrow"),d=n,b="width",null==(y="260px")?d.style.removeProperty(b):d.style.setProperty(b,y,w?"important":""),P(k,"class","grid is-gap-2"),P(v,"class","fixed-grid has-6-cols"),P($,"class","p-5 is-fullwidth")},m(t,s){y(t,e,s),b(e,n),b(n,o),b(o,i),b(o,r),b(o,a),b(a,u),b(u,f),b(u,p),b(u,g),b(e,h),b(e,$),b($,v),b(v,k),C&&C.m(k,null),L=!0},p(t,[e]){(!L||2&e&&!c(i.src,s=bt(t[1],"full","250,")))&&P(i,"src",s),(!L||1&e&&l!==(l="Canvas "+t[0]))&&P(i,"alt",l),(!L||1&e)&&N(g,t[0]),(!L||5&e&&m!==(m=$t(t[2],t[0])))&&P(u,"href",m),C&&C.p&&(!L||8&e)&&function(t,e,n,o,i,s){if(i){const l=d(e,n,o,s);t.p(l,i)}}(C,_,t,t[3],L?function(t,e,n,o){if(t[2]&&o){const i=t[2](o(n));if(void 0===e.dirty)return i;if("object"==typeof i){const t=[],n=Math.max(e.dirty.length,i.length);for(let o=0;o<n;o+=1)t[o]=e.dirty[o]|i[o];return t}return e.dirty|i}return e.dirty}(_,t[3],e,null):function(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}(t[3]),null)},i(t){L||(it(C,t),L=!0)},o(t){st(C,t),L=!1},d(t){t&&w(e),C&&C.d(t)}}}function Bt(t,e,n){let{$$slots:o={},$$scope:i}=e,{canvasNb:s}=e,{canvasImg:l}=e,{manifest:r}=e;return t.$$set=t=>{"canvasNb"in t&&n(0,s=t.canvasNb),"canvasImg"in t&&n(1,l=t.canvasImg),"manifest"in t&&n(2,r=t.manifest),"$$scope"in t&&n(3,i=t.$$scope)},[s,l,r,i,o]}class Dt extends ht{constructor(t){super(),mt(this,t,Bt,Ht,l,{canvasNb:0,canvasImg:1,manifest:2})}}function qt(t){let e,n,o,i,s,l,r,c,a,u=t[0]>1&&Ut(t),d=t[0]<t[1]&&Gt(t);return{c(){e=x("nav"),n=x("ul"),u&&u.c(),o=S(),i=x("li"),s=x("a"),l=E(t[0]),r=S(),d&&d.c(),P(s,"class","pagination-link is-current"),P(s,"href",null),P(n,"class","pagination-list"),P(e,"class","pagination is-centered"),P(e,"aria-label","pagination")},m(f,p){y(f,e,p),b(e,n),u&&u.m(n,null),b(n,o),b(n,i),b(i,s),b(s,l),b(n,r),d&&d.m(n,null),c||(a=C(s,"click",O(t[5])),c=!0)},p(t,e){t[0]>1?u?u.p(t,e):(u=Ut(t),u.c(),u.m(n,o)):u&&(u.d(1),u=null),1&e&&N(l,t[0]),t[0]<t[1]?d?d.p(t,e):(d=Gt(t),d.c(),d.m(n,null)):d&&(d.d(1),d=null)},d(t){t&&w(e),u&&u.d(),d&&d.d(),c=!1,a()}}}function Ut(t){let e,n,o,i,s,l,r=t[0]-1>1&&Ft(t);return{c(){e=x("li"),n=x("a"),n.textContent="1",o=S(),r&&r.c(),i=_(),P(n,"class","pagination-link"),P(n,"href",null)},m(c,a){y(c,e,a),b(e,n),y(c,o,a),r&&r.m(c,a),y(c,i,a),s||(l=C(n,"click",O(t[3])),s=!0)},p(t,e){t[0]-1>1?r?r.p(t,e):(r=Ft(t),r.c(),r.m(i.parentNode,i)):r&&(r.d(1),r=null)},d(t){t&&w(e),t&&w(o),r&&r.d(t),t&&w(i),s=!1,l()}}}function Ft(t){let e,n,o,i,s,l,r,c=t[0]-1+"";return{c(){e=x("li"),e.innerHTML='<span class="pagination-ellipsis">…</span>',n=S(),o=x("li"),i=x("a"),s=E(c),P(i,"class","pagination-link"),P(i,"href",null)},m(c,a){y(c,e,a),y(c,n,a),y(c,o,a),b(o,i),b(i,s),l||(r=C(i,"click",O(t[4])),l=!0)},p(t,e){1&e&&c!==(c=t[0]-1+"")&&N(s,c)},d(t){t&&w(e),t&&w(n),t&&w(o),l=!1,r()}}}function Gt(t){let e,n,o,i,s,l,r=t[0]+1<t[1]&&Jt(t);return{c(){r&&r.c(),e=S(),n=x("li"),o=x("a"),i=E(t[1]),P(o,"class","pagination-link"),P(o,"href",null)},m(c,a){r&&r.m(c,a),y(c,e,a),y(c,n,a),b(n,o),b(o,i),s||(l=C(o,"click",O(t[7])),s=!0)},p(t,n){t[0]+1<t[1]?r?r.p(t,n):(r=Jt(t),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),2&n&&N(i,t[1])},d(t){r&&r.d(t),t&&w(e),t&&w(n),s=!1,l()}}}function Jt(t){let e,n,o,i,s,l,r,c=t[0]+1+"";return{c(){e=x("li"),n=x("a"),o=E(c),i=S(),s=x("li"),s.innerHTML='<span class="pagination-ellipsis">…</span>',P(n,"class","pagination-link"),P(n,"href",null)},m(c,a){y(c,e,a),b(e,n),b(n,o),y(c,i,a),y(c,s,a),l||(r=C(n,"click",O(t[6])),l=!0)},p(t,e){1&e&&c!==(c=t[0]+1+"")&&N(o,c)},d(t){t&&w(e),t&&w(i),t&&w(s),l=!1,r()}}}function Xt(e){let n,o=e[1]>1&&qt(e);return{c(){o&&o.c(),n=_()},m(t,e){o&&o.m(t,e),y(t,n,e)},p(t,[e]){t[1]>1?o?o.p(t,e):(o=qt(t),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:t,o:t,d(t){o&&o.d(t),t&&w(n)}}}function Kt(t,e,n){const o=function(){const t=H();return(e,n,{cancelable:o=!1}={})=>{const i=t.$$.callbacks[e];if(i){const s=j(e,n,{cancelable:o});return i.slice().forEach((e=>{e.call(t,s)})),!s.defaultPrevented}return!0}}();let{pageNb:i}=e,{maxPage:s}=e;function l(t){o("pageUpdate",{pageNb:t})}return t.$$set=t=>{"pageNb"in t&&n(0,i=t.pageNb),"maxPage"in t&&n(1,s=t.maxPage)},[i,s,l,()=>l(1),()=>l(i-1),()=>l(i),()=>l(i+1),()=>l(s)]}class Yt extends ht{constructor(t){super(),mt(this,t,Kt,Xt,l,{pageNb:0,maxPage:1})}}function Qt(e){let n,o,i,s,l,r,c,a,u,d,f,p,g,m,h,$,v="en"===e[0]?"Cancel":"Annuler";return{c(){n=x("button"),o=S(),i=x("div"),s=x("div"),l=S(),r=x("div"),c=x("div"),c.innerHTML='<div class="title is-4 mb-0 media-content"><span id="modal-title" class="mb-0"></span></div> \n            <button class="delete media-left" aria-label="close"></button>',a=S(),u=x("section"),d=S(),f=x("footer"),p=x("div"),g=x("button"),m=E(v),h=S(),$=x("button"),$.textContent="OK",P(n,"id","hidden-msg-btn"),P(n,"class","js-modal-trigger"),P(n,"data-target","msg-modal"),n.hidden=!0,P(s,"id","modal-bkg"),P(s,"class","modal-background"),P(c,"class","modal-card-head media mb-0"),P(u,"id","modal-body"),P(u,"class","modal-card-body"),P(g,"id","cancel-btn"),P(g,"class","button is-link is-light"),P($,"id","ok-btn"),P($,"class","button is-link"),P(p,"class","buttons"),P(f,"id","modal-footer"),P(f,"class","modal-card-foot is-center pt-1"),f.hidden=!0,P(r,"class","modal-content"),P(i,"id","msg-modal"),P(i,"class","modal fade"),P(i,"tabindex","-1"),P(i,"aria-labelledby","selection-modal-label"),P(i,"aria-hidden","true")},m(t,e){y(t,n,e),y(t,o,e),y(t,i,e),b(i,s),b(i,l),b(i,r),b(r,c),b(r,a),b(r,u),b(r,d),b(r,f),b(f,p),b(p,g),b(g,m),b(p,h),b(p,$)},p(t,[e]){1&e&&v!==(v="en"===t[0]?"Cancel":"Annuler")&&N(m,v)},i:t,o:t,d(t){t&&w(n),t&&w(o),t&&w(i)}}}function Wt(t,e,n){let{appLang:o="en"}=e;return t.$$set=t=>{"appLang"in t&&n(0,o=t.appLang)},[o]}class Zt extends ht{constructor(t){super(),mt(this,t,Wt,Qt,l,{appLang:0})}}function te(t){let e,n,o="en"===t[0]?"Automatic region extraction":"Extraction automatique des régions";return{c(){e=x("button"),n=E(o),P(e,"class","button is-link is-inverted")},m(t,o){y(t,e,o),b(e,n)},p(t,e){1&e&&o!==(o="en"===t[0]?"Automatic region extraction":"Extraction automatique des régions")&&N(n,o)},d(t){t&&w(e)}}}function ee(e){let n,o,i,s,l,r,c,a,u,d="en"===e[0]?"Manually annotate":"Annoter manuellement",f="en"===e[0]?"Import regions file":"Importer un fichier de région",p=e[1].includes("regions"),g=p&&te(e);return{c(){n=x("div"),o=x("button"),i=E(d),s=S(),l=x("button"),r=E(f),c=S(),g&&g.c(),P(o,"class","button is-link"),P(l,"class","button is-link is-light"),P(n,"class","is-center buttons is-centered pt-5")},m(t,d){y(t,n,d),b(n,o),b(o,i),b(n,s),b(n,l),b(l,r),b(n,c),g&&g.m(n,null),a||(u=C(o,"click",e[2]),a=!0)},p(t,[e]){1&e&&d!==(d="en"===t[0]?"Manually annotate":"Annoter manuellement")&&N(i,d),1&e&&f!==(f="en"===t[0]?"Import regions file":"Importer un fichier de région")&&N(r,f),2&e&&(p=t[1].includes("regions")),p?g?g.p(t,e):(g=te(t),g.c(),g.m(n,null)):g&&(g.d(1),g=null)},i:t,o:t,d(t){t&&w(n),g&&g.d(),a=!1,u()}}}function ne(t,e,n){let{appLang:o="en"}=e,{modules:i=[]}=e,{witness:s={}}=e;const l=`${window.location.origin}`;return t.$$set=t=>{"appLang"in t&&n(0,o=t.appLang),"modules"in t&&n(1,i=t.modules),"witness"in t&&n(3,s=t.witness)},[o,i,async function(){const t=await fetch(`${l}/witness/${s.id}/regions/add`,{method:"POST",headers:{"X-CSRFToken":CSRF_TOKEN}});if(204!==t.status)throw new Error(`Failed to create regions: '${t.statusText}'`);t.json().then((t=>{t.mirador_url&&window.open(t.mirador_url)}))},s]}class oe extends ht{constructor(t){super(),mt(this,t,ne,ee,l,{appLang:0,modules:1,witness:3})}}function ie(t,e,n){const o=t.slice();return o[38]=e[n][0],o[39]=e[n][1],o}function se(t,e,n){const o=t.slice();return o[46]=e[n][0],o[47]=e[n][1],o}function le(t,e,n){const o=t.slice();return o[42]=e[n],o}function re(t,e,n){const o=t.slice();return o[42]=e[n],o}function ce(t,e,n){const o=t.slice();return o[53]=e[n][0],o[39]=e[n][1],o}function ae(t){let e;return{c(){e=L("path"),P(e,"d","M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"),P(e,"class","svelte-16efmtz")},m(t,n){y(t,e,n)},d(t){t&&w(e)}}}function ue(t){let e;return{c(){e=L("path"),P(e,"d","M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"),P(e,"class","svelte-16efmtz")},m(t,n){y(t,e,n)},d(t){t&&w(e)}}}function de(t){let e,n="en"===t[2]?"Edit":"Modifier";return{c(){e=E(n)},m(t,n){y(t,e,n)},p(t,o){4&o[0]&&n!==(n="en"===t[2]?"Edit":"Modifier")&&N(e,n)},d(t){t&&w(e)}}}function fe(t){let e,n="en"===t[2]?"Validate":"Valider";return{c(){e=E(n)},m(t,n){y(t,e,n)},p(t,o){4&o[0]&&n!==(n="en"===t[2]?"Validate":"Valider")&&N(e,n)},d(t){t&&w(e)}}}function pe(t){let e,n,o,s,l,r,c,a,u,d,f,p,g,m,h,$,v,k="en"===t[2]?"Reload":"Recharger",L="en"===t[2]?"Go to editor":"Aller à l'éditeur",_="en"===t[2]?"Delete selected regions":"Supprimer les régions sélectionnées";return{c(){e=x("button"),n=x("i"),o=S(),s=E(k),l=S(),r=x("a"),c=x("i"),a=S(),u=E(L),f=S(),p=x("button"),g=x("i"),m=S(),h=E(_),P(n,"class","fa-solid fa-rotate-right"),P(e,"class","tag is-link is-light is-rounded mr-3"),P(c,"class","fa-solid fa-edit"),P(r,"class","tag is-link is-rounded mr-3"),P(r,"href",d=$t(t[3])),P(r,"target","_blank"),P(g,"class","fa-solid fa-trash"),P(p,"class","tag is-danger is-rounded")},m(i,d){y(i,e,d),b(e,n),b(e,o),b(e,s),y(i,l,d),y(i,r,d),b(r,c),b(r,a),b(r,u),y(i,f,d),y(i,p,d),b(p,g),b(p,m),b(p,h),$||(v=[C(e,"click",t[32]),C(p,"click",t[21])],$=!0)},p(t,e){4&e[0]&&k!==(k="en"===t[2]?"Reload":"Recharger")&&N(s,k),4&e[0]&&L!==(L="en"===t[2]?"Go to editor":"Aller à l'éditeur")&&N(u,L),8&e[0]&&d!==(d=$t(t[3]))&&P(r,"href",d),4&e[0]&&_!==(_="en"===t[2]?"Delete selected regions":"Supprimer les régions sélectionnées")&&N(h,_)},d(t){t&&w(e),t&&w(l),t&&w(r),t&&w(f),t&&w(p),$=!1,i(v)}}}function ge(t){let e,n,o,s,l,r,c=t[39].text+"";function a(){return t[33](t[53])}return{c(){e=x("li"),n=x("a"),o=E(c),s=S(),P(n,"href",null),A(e,"is-active",t[53]===t[13])},m(t,i){y(t,e,i),b(e,n),b(n,o),b(e,s),l||(r=[C(e,"click",a),C(e,"keyup",Re)],l=!0)},p(n,i){t=n,512&i[0]&&c!==(c=t[39].text+"")&&N(o,c),8704&i[0]&&A(e,"is-active",t[53]===t[13])},d(t){t&&w(e),l=!1,i(r)}}}function me(e){let n;return{c(){n=x("div"),n.textContent="tout doux"},m(t,e){y(t,n,e)},p:t,i:t,o:t,d(t){t&&w(n)}}}function he(e){let n;return{c(){n=x("div"),n.textContent="tout doux"},m(t,e){y(t,n,e)},p:t,i:t,o:t,d(t){t&&w(n)}}}function be(t){let e,n,o,i,s,l;e=new Yt({props:{pageNb:t[8],maxPage:10}}),e.$on("pageUpdate",t[19]);let r={ctx:t,current:null,token:null,hasCatch:!0,pending:Se,then:ye,catch:ve,value:45,error:52,blocks:[,,,]};return ct(s=t[12],r),{c(){dt(e.$$.fragment),n=S(),o=x("table"),i=x("tbody"),r.block.c(),P(o,"class","table is-fullwidth")},m(t,s){ft(e,t,s),y(t,n,s),y(t,o,s),b(o,i),r.block.m(i,r.anchor=null),r.mount=()=>i,r.anchor=null,l=!0},p(n,o){t=n;const i={};256&o[0]&&(i.pageNb=t[8]),e.$set(i),r.ctx=t,4096&o[0]&&s!==(s=t[12])&&ct(s,r)||function(t,e,n){const o=e.slice(),{resolved:i}=t;t.current===t.then&&(o[t.value]=i),t.current===t.catch&&(o[t.error]=i),t.block.p(o,n)}(r,t,o)},i(t){l||(it(e.$$.fragment,t),it(r.block),l=!0)},o(t){st(e.$$.fragment,t);for(let t=0;t<3;t+=1){st(r.blocks[t])}l=!1},d(t){pt(e,t),t&&w(n),t&&w(o),r.block.d(),r.token=null,r=null}}}function $e(t){let e,n,o=[],i=new Map,s=Object.values(t[0]);const l=t=>t[42].id;for(let e=0;e<s.length;e+=1){let n=re(t,s,e),r=l(n);i.set(r,o[e]=Ce(r,n))}let r=null;return s.length||(r=_e(t)),{c(){e=x("div");for(let t=0;t<o.length;t+=1)o[t].c();r&&r.c(),P(e,"class","grid is-gap-2")},m(t,i){y(t,e,i);for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(e,null);r&&r.m(e,null),n=!0},p(t,n){16778293&n[0]&&(s=Object.values(t[0]),nt(),o=ut(o,n,l,1,t,s,i,e,at,Ce,null,re),ot(),!s.length&&r?r.p(t,n):s.length?r&&(nt(),st(r,1,1,(()=>{r=null})),ot()):(r=_e(t),r.c(),it(r,1),r.m(e,null)))},i(t){if(!n){for(let t=0;t<s.length;t+=1)it(o[t]);n=!0}},o(t){for(let t=0;t<o.length;t+=1)st(o[t]);n=!1},d(t){t&&w(e);for(let t=0;t<o.length;t+=1)o[t].d();r&&r.d()}}}function ve(e){let n,o,i,s=e[52]+"";return{c(){n=x("tr"),o=E("Error when retrieving paginated regions: "),i=E(s)},m(t,e){y(t,n,e),b(n,o),b(n,i)},p(t,e){4096&e[0]&&s!==(s=t[52]+"")&&N(i,s)},i:t,o:t,d(t){t&&w(n)}}}function ye(t){let e,n,o,i,s;const l=[ke,we],r=[];function c(t,n){return 32768&n[0]&&(e=null),null==e&&(e=!!(Object.values(t[15]).length>0)),e?0:1}return n=c(t,[-1,-1]),o=r[n]=l[n](t),{c(){o.c(),i=_()},m(t,e){r[n].m(t,e),y(t,i,e),s=!0},p(t,e){let s=n;n=c(t,e),n===s?r[n].p(t,e):(nt(),st(r[s],1,1,(()=>{r[s]=null})),ot(),o=r[n],o?o.p(t,e):(o=r[n]=l[n](t),o.c()),it(o,1),o.m(i.parentNode,i))},i(t){s||(it(o),s=!0)},o(t){st(o),s=!1},d(t){r[n].d(t),t&&w(i)}}}function we(t){let e,n,o;return n=new oe({props:{appLang:t[2],modules:t[4],witness:t[5]}}),{c(){e=x("tr"),dt(n.$$.fragment)},m(t,i){y(t,e,i),ft(n,e,null),o=!0},p(t,e){const o={};4&e[0]&&(o.appLang=t[2]),16&e[0]&&(o.modules=t[4]),32&e[0]&&(o.witness=t[5]),n.$set(o)},i(t){o||(it(n.$$.fragment,t),o=!0)},o(t){st(n.$$.fragment,t),o=!1},d(t){t&&w(e),pt(n)}}}function ke(t){let e,n,o=Object.entries(t[15]),i=[];for(let e=0;e<o.length;e+=1)i[e]=Ee(se(t,o,e));const s=t=>st(i[t],1,1,(()=>{i[t]=null}));return{c(){for(let t=0;t<i.length;t+=1)i[t].c();e=_()},m(t,o){for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,o);y(t,e,o),n=!0},p(t,n){if(16942092&n[0]){let l;for(o=Object.entries(t[15]),l=0;l<o.length;l+=1){const s=se(t,o,l);i[l]?(i[l].p(s,n),it(i[l],1)):(i[l]=Ee(s),i[l].c(),it(i[l],1),i[l].m(e.parentNode,e))}for(nt(),l=o.length;l<i.length;l+=1)s(l);ot()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)it(i[t]);n=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)st(i[t]);n=!1},d(t){k(i,t),t&&w(e)}}}function xe(t,e){let n,o,i;return o=new jt({props:{item:e[42],appLang:e[2],isCopied:e[10](e[42])}}),o.$on("copyRef",e[24]),{key:t,first:null,c(){n=_(),dt(o.$$.fragment),this.first=n},m(t,e){y(t,n,e),ft(o,t,e),i=!0},p(t,n){e=t;const i={};32768&n[0]&&(i.item=e[42]),4&n[0]&&(i.appLang=e[2]),33792&n[0]&&(i.isCopied=e[10](e[42])),o.$set(i)},i(t){i||(it(o.$$.fragment,t),i=!0)},o(t){st(o.$$.fragment,t),i=!1},d(t){t&&w(n),pt(o,t)}}}function Le(t){let e,n,o=[],i=new Map,s=Object.values(t[47]);const l=t=>t[42].id;for(let e=0;e<s.length;e+=1){let n=le(t,s,e),r=l(n);i.set(r,o[e]=xe(r,n))}return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=S()},m(t,i){for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,i);y(t,e,i),n=!0},p(t,n){16811012&n[0]&&(s=Object.values(t[47]),nt(),o=ut(o,n,l,1,t,s,i,e.parentNode,at,xe,e,le),ot())},i(t){if(!n){for(let t=0;t<s.length;t+=1)it(o[t]);n=!0}},o(t){for(let t=0;t<o.length;t+=1)st(o[t]);n=!1},d(t){for(let e=0;e<o.length;e+=1)o[e].d(t);t&&w(e)}}}function Ee(t){let e,n;return e=new Dt({props:{canvasImg:t[17](t[46]),canvasNb:t[46],manifest:t[3],$$slots:{default:[Le]},$$scope:{ctx:t}}}),{c(){dt(e.$$.fragment)},m(t,o){ft(e,t,o),n=!0},p(t,n){const o={};32768&n[0]&&(o.canvasImg=t[17](t[46])),32768&n[0]&&(o.canvasNb=t[46]),8&n[0]&&(o.manifest=t[3]),33796&n[0]|33554432&n[1]&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){pt(e,t)}}}function Se(e){let n;return{c(){n=x("tr"),n.textContent="Retrieving paginated regions...",P(n,"class","faded is-center")},m(t,e){y(t,n,e)},p:t,i:t,o:t,d(t){t&&w(n)}}}function _e(t){let e,n;return e=new oe({props:{appLang:t[2],modules:t[4],witness:t[5]}}),{c(){dt(e.$$.fragment)},m(t,o){ft(e,t,o),n=!0},p(t,n){const o={};4&n[0]&&(o.appLang=t[2]),16&n[0]&&(o.modules=t[4]),32&n[0]&&(o.witness=t[5]),e.$set(o)},i(t){n||(it(e.$$.fragment,t),n=!0)},o(t){st(e.$$.fragment,t),n=!1},d(t){pt(e,t)}}}function Ce(t,e){let n,o,i;return o=new jt({props:{item:e[42],appLang:e[2],isCopied:e[10](e[42])}}),o.$on("copyRef",e[24]),{key:t,first:null,c(){n=_(),dt(o.$$.fragment),this.first=n},m(t,e){y(t,n,e),ft(o,t,e),i=!0},p(t,n){e=t;const i={};1&n[0]&&(i.item=e[42]),4&n[0]&&(i.appLang=e[2]),1025&n[0]&&(i.isCopied=e[10](e[42])),o.$set(i)},i(t){i||(it(o.$$.fragment,t),i=!0)},o(t){st(o.$$.fragment,t),i=!1},d(t){t&&w(n),pt(o,t)}}}function Oe(t){let e,n,o="en"===t[2]?"No regions in selection":"Aucune région sélectionnée";return{c(){e=x("div"),n=E(o)},m(t,o){y(t,e,o),b(e,n)},p(t,e){4&e[0]&&o!==(o="en"===t[2]?"No regions in selection":"Aucune région sélectionnée")&&N(n,o)},d(t){t&&w(e)}}}function Pe(t){let e,n,o=Object.entries(t[7]),i=[];for(let e=0;e<o.length;e+=1)i[e]=Ne(ie(t,o,e));return{c(){e=x("div"),n=x("div");for(let t=0;t<i.length;t+=1)i[t].c();P(n,"class","grid is-gap-2"),P(e,"class","fixed-grid has-6-cols")},m(t,o){y(t,e,o),b(e,n);for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(n,null)},p(t,e){if(130&e[0]){let s;for(o=Object.entries(t[7]),s=0;s<o.length;s+=1){const l=ie(t,o,s);i[s]?i[s].p(l,e):(i[s]=Ne(l),i[s].c(),i[s].m(n,null))}for(;s<i.length;s+=1)i[s].d(1);i.length=o.length}},d(t){t&&w(e),k(i,t)}}}function Ne(t){let e,n,o,i,s,l,r,a,u,d,f,p,g,m=t[39].title+"";function h(){return t[34](t[38])}return{c(){e=x("div"),n=x("figure"),o=x("img"),s=S(),l=x("div"),r=x("span"),a=E(m),u=S(),d=x("button"),f=S(),c(o.src,i=bt(t[39].img,t[39].xyhw,"96,"))||P(o,"src",i),P(o,"alt","Extracted region"),P(r,"class","overlay-desc"),P(l,"class","overlay is-center svelte-16efmtz"),P(n,"class","image is-64x64 card"),P(d,"class","delete region-btn"),P(d,"aria-label","remove from selection"),P(e,"class","selection cell svelte-16efmtz")},m(t,i){y(t,e,i),b(e,n),b(n,o),b(n,s),b(n,l),b(l,r),b(r,a),b(e,u),b(e,d),b(e,f),p||(g=C(d,"click",h),p=!0)},p(e,n){t=e,128&n[0]&&!c(o.src,i=bt(t[39].img,t[39].xyhw,"96,"))&&P(o,"src",i),128&n[0]&&m!==(m=t[39].title+"")&&N(a,m)},d(t){t&&w(e),p=!1,g()}}}function Ae(t){let e,n,o,s,l,r,c,a,u,d,f,p,g,m,h,$,v,_,O,A,j,I,R,V,z,M,T,H,B,D,q,U,F,G,J,X,K,Y,Q,W,Z,tt,et,lt,rt,ct,at,ut,gt,mt,ht,bt="en"===t[2]?"Download":"Télécharger",$t="en"===t[2]?"Selected regions":"Regions sélectionnées";function vt(t,e){return t[11]?ue:ae}e=new Zt({props:{appLang:t[2]}}),o=new Vt({props:{selectionLength:t[6],appLang:t[2]}});let yt=vt(t),wt=yt(t);function kt(t,e){return t[11]?fe:de}let xt=kt(t),Lt=xt(t),Et=t[11]&&pe(t),St=Object.entries(t[9]),_t=[];for(let e=0;e<St.length;e+=1)_t[e]=ge(ce(t,St,e));const Ct=[$e,be,he,me],Ot=[];function Pt(t,e){return"all"===t[13]?0:"page"===t[13]?1:"similarity"===t[13]?2:"vectorization"===t[13]?3:-1}function Nt(t,e){return t[14]?Pe:Oe}~(H=Pt(t))&&(B=Ot[H]=Ct[H](t));let At=Nt(t),jt=At(t);return ut=new Tt({props:{appLang:t[2],isRegion:!0}}),{c(){dt(e.$$.fragment),n=S(),dt(o.$$.fragment),s=S(),l=x("div"),r=x("div"),c=x("div"),a=x("button"),u=L("svg"),wt.c(),d=S(),Lt.c(),p=S(),g=x("button"),m=x("i"),h=S(),$=x("span"),$.textContent=`${t[22]()}`,v=S(),_=x("button"),O=x("i"),A=S(),j=E(bt),I=S(),R=x("div"),Et&&Et.c(),V=S(),z=x("div"),M=x("ul");for(let t=0;t<_t.length;t+=1)_t[t].c();T=S(),B&&B.c(),D=S(),q=x("div"),U=x("div"),F=S(),G=x("div"),J=x("div"),X=x("div"),K=x("i"),Y=S(),Q=E($t),W=E("\n                ("),Z=E(t[6]),tt=E(")"),et=S(),lt=x("button"),rt=S(),ct=x("section"),jt.c(),at=S(),dt(ut.$$.fragment),P(u,"xmlns","http://www.w3.org/2000/svg"),P(u,"viewBox","0 0 384 512"),P(u,"class","pr-3"),P(a,"class",f="button "+(t[11]?"is-success":"is-link")+" mr-3"),P(m,"class","fa-solid fa-square-check"),P($,"id","all-selection"),P(g,"class","button is-link is-light mr-3"),P(O,"class","fa-solid fa-download"),P(_,"class","button is-link is-light"),P(c,"class","is-left svelte-16efmtz"),P(R,"class","edit-action svelte-16efmtz"),P(r,"class","center-flex actions svelte-16efmtz"),P(M,"class","panel-tabs"),P(z,"class","tabs is-centered"),P(l,"id","nav-actions"),P(l,"class","mb-5 svelte-16efmtz"),P(U,"class","modal-background"),P(K,"class","fa-solid fa-book-bookmark"),P(X,"class","title is-4 mb-0 media-content"),P(lt,"class","delete media-left"),P(lt,"aria-label","close"),P(J,"class","modal-card-head media mb-0"),P(ct,"class","modal-card-body"),P(G,"class","modal-content"),P(q,"id","selection-modal"),P(q,"class","modal fade"),P(q,"tabindex","-1"),P(q,"aria-labelledby","selection-modal-label"),P(q,"aria-hidden","true")},m(i,f){ft(e,i,f),y(i,n,f),ft(o,i,f),y(i,s,f),y(i,l,f),b(l,r),b(r,c),b(c,a),b(a,u),wt.m(u,null),b(a,d),Lt.m(a,null),b(c,p),b(c,g),b(g,m),b(g,h),b(g,$),b(c,v),b(c,_),b(_,O),b(_,A),b(_,j),b(r,I),b(r,R),Et&&Et.m(R,null),b(l,V),b(l,z),b(z,M);for(let t=0;t<_t.length;t+=1)_t[t]&&_t[t].m(M,null);y(i,T,f),~H&&Ot[H].m(i,f),y(i,D,f),y(i,q,f),b(q,U),b(q,F),b(q,G),b(G,J),b(J,X),b(X,K),b(X,Y),b(X,Q),b(X,W),b(X,Z),b(X,tt),b(J,et),b(J,lt),b(G,rt),b(G,ct),jt.m(ct,null),b(G,at),ft(ut,G,null),gt=!0,mt||(ht=[C(a,"click",t[31]),C(g,"click",t[23]),C(_,"click",Ie)],mt=!0)},p(t,n){const i={};4&n[0]&&(i.appLang=t[2]),e.$set(i);const s={};if(64&n[0]&&(s.selectionLength=t[6]),4&n[0]&&(s.appLang=t[2]),o.$set(s),yt!==(yt=vt(t))&&(wt.d(1),wt=yt(t),wt&&(wt.c(),wt.m(u,null))),xt===(xt=kt(t))&&Lt?Lt.p(t,n):(Lt.d(1),Lt=xt(t),Lt&&(Lt.c(),Lt.m(a,null))),(!gt||2048&n[0]&&f!==(f="button "+(t[11]?"is-success":"is-link")+" mr-3"))&&P(a,"class",f),(!gt||4&n[0])&&bt!==(bt="en"===t[2]?"Download":"Télécharger")&&N(j,bt),t[11]?Et?Et.p(t,n):(Et=pe(t),Et.c(),Et.m(R,null)):Et&&(Et.d(1),Et=null),8704&n[0]){let e;for(St=Object.entries(t[9]),e=0;e<St.length;e+=1){const o=ce(t,St,e);_t[e]?_t[e].p(o,n):(_t[e]=ge(o),_t[e].c(),_t[e].m(M,null))}for(;e<_t.length;e+=1)_t[e].d(1);_t.length=St.length}let l=H;H=Pt(t),H===l?~H&&Ot[H].p(t,n):(B&&(nt(),st(Ot[l],1,1,(()=>{Ot[l]=null})),ot()),~H?(B=Ot[H],B?B.p(t,n):(B=Ot[H]=Ct[H](t),B.c()),it(B,1),B.m(D.parentNode,D)):B=null),(!gt||4&n[0])&&$t!==($t="en"===t[2]?"Selected regions":"Regions sélectionnées")&&N(Q,$t),(!gt||64&n[0])&&N(Z,t[6]),At===(At=Nt(t))&&jt?jt.p(t,n):(jt.d(1),jt=At(t),jt&&(jt.c(),jt.m(ct,null)));const r={};4&n[0]&&(r.appLang=t[2]),ut.$set(r)},i(t){gt||(it(e.$$.fragment,t),it(o.$$.fragment,t),it(B),it(ut.$$.fragment,t),gt=!0)},o(t){st(e.$$.fragment,t),st(o.$$.fragment,t),st(B),st(ut.$$.fragment,t),gt=!1},d(t){pt(e,t),t&&w(n),pt(o,t),t&&w(s),t&&w(l),wt.d(),Lt.d(),Et&&Et.d(),k(_t,t),t&&w(T),~H&&Ot[H].d(t),t&&w(D),t&&w(q),jt.d(),pt(ut),mt=!1,i(ht)}}}async function je(t){const e=SAS_APP_URL.replace("https","http"),n=`${SAS_APP_URL}/annotation/destroy?uri=${e}/annotation/${t}`,o=await fetch(n,{method:"DELETE"});if(204!==o.status)throw new Error(`Failed to delete ${n} due to ${o.status}: '${o.statusText}'`)}const Ie=()=>null,Re=()=>null;function Ve(t,e,n){let o,i,s,l,r,c,a,d,f,p,g,m;const{selected:h,nbSelected:b}=Lt;u(t,h,(t=>n(30,g=t)));const $="Regions";let{regions:v={}}=e,{appLang:y="en"}=e,{manifest:w=""}=e,{isValidated:k=!1}=e,{imgPrefix:x=""}=e,{nbOfPages:L=1}=e,{modules:E=[]}=e,{witness:S={}}=e;const _={all:{text:"en"===y?"All regions":"Toutes les régions"},page:{text:"en"===y?"Per page":"Par page"}};E.includes("similarity")&&(_.similarity={text:"en"===y?"Similarity":"Similarité"}),E.includes("vectorization")&&(_.vectorization={text:"en"===y?"Vectorization":"Vectorisation"});const C=wt({});function O(){n(11,l=!l)}function P(){return i===Object.keys(v).length}u(t,C,(t=>n(15,m=t)));return t.$$set=t=>{"regions"in t&&n(0,v=t.regions),"appLang"in t&&n(2,y=t.appLang),"manifest"in t&&n(3,w=t.manifest),"isValidated"in t&&n(25,k=t.isValidated),"imgPrefix"in t&&n(26,x=t.imgPrefix),"nbOfPages"in t&&n(27,L=t.nbOfPages),"modules"in t&&n(4,E=t.modules),"witness"in t&&n(5,S=t.witness)},t.$$.update=()=>{1073741824&t.$$.dirty[0]&&n(7,o=g(!0)),128&t.$$.dirty[0]&&n(6,i=Object.keys(o).length),64&t.$$.dirty[0]&&n(14,s=i>0),33554432&t.$$.dirty[0]&&n(11,l=!k),536871168&t.$$.dirty[0]&&n(12,d=(async()=>{const t=await fetch(`${c}canvas?p=${a}`),e=await t.json();return C.set(e),e})()),268435456&t.$$.dirty[0]&&n(10,p=t=>f===t.ref)},n(13,r="all"),n(29,c=`${window.location.origin}${window.location.pathname}`),n(8,a=parseInt(new URLSearchParams(window.location.search).get("p")??1)),n(28,f=""),[v,$,y,w,E,S,i,o,a,_,p,l,d,r,s,m,h,function(t){return`${x}_${e=t,n=String(L).length+1,e.toString().padStart(n,"0")}`;var e,n},C,function(t){const{pageNb:e}=t.detail;n(8,a=e);const o=new URL(c);o.searchParams.set("p",a),window.history.pushState({},"",o)},O,async function(){if(await vt("en"===y?"Are you sure you want to delete regions?":"Voulez-vous vraiment supprimer les régions?","en"===y?"Confirm deletion":"Confirmer la suppression",!0))for(const t of Object.keys(o))try{if(!v.hasOwnProperty(t))continue;await je(t),delete v[t],n(0,v={...v}),C.update((e=>{for(const n in e)if(e[n][t]){const{[t]:o,...i}=e[n];return e[n]=i,e}return e})),Lt.remove(t,$)}catch(e){success=!1,await vt(`Failed to delete region ${t}: ${e.message}`,"Error")}},function(t=null){return null===t&&(t=P()),t?"en"===y?"Unselect all":"Tout désélectionner":"en"===y?"Select all":"Tout sélectionner"},function(){P()?Lt.removeAll(Object.keys(v),"Regions"):Lt.addAll(Object.values(v))},function(t){const{item:e}=t.detail,o=p(e)?"":e.ref;navigator.clipboard.writeText(o),n(28,f=o)},k,x,L,f,c,g,()=>O(),()=>location.reload(),t=>n(13,r=t),t=>Lt.remove(t,$)]}var ze;return new class extends ht{constructor(t){super(),mt(this,t,Ve,Ae,l,{regionsType:1,regions:0,appLang:2,manifest:3,isValidated:25,imgPrefix:26,nbOfPages:27,modules:4,witness:5},null,[-1,-1])}get regionsType(){return this.$$.ctx[1]}}({target:document.getElementById("region-list"),props:{witness:witness,regions:(ze="regions-data",document.getElementById(ze)?JSON.parse(document.getElementById(ze).textContent):[]),regionsType:"Regions",appLang:APP_LANG,modules:ADDITIONAL_MODULES,manifest:manifest,isValidated:isValidated,imgPrefix:imgPrefix,nbOfPages:nbOfPages}})}();
//# sourceMappingURL=regionList.js.map
