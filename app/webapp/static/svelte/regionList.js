var regionList=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function r(){return Object.create(null)}function i(e){e.forEach(n)}function s(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let l;function c(e,t){return l||(l=document.createElement("a")),l.href=t,e===l.href}function a(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function u(e){let t;return a(e,(e=>t=e))(),t}function d(e,t,n){e.$$.on_destroy.push(a(t,n))}function p(e,t,n,r){if(e){const i=g(e,t,n,r);return e[0](i)}}function g(e,t,n,r){return e[1]&&r?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](r(t))):n.ctx}function f(e,t,n,r){if(e[2]&&r){const i=e[2](r(n));if(void 0===t.dirty)return i;if("object"==typeof i){const e=[],n=Math.max(t.dirty.length,i.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|i[r];return e}return t.dirty|i}return t.dirty}function m(e,t,n,r,i,s){if(i){const o=g(t,n,r,s);e.p(o,i)}}function h(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}const $="undefined"!=typeof window;let b=$?()=>window.performance.now():()=>Date.now(),w=$?e=>requestAnimationFrame(e):e;const v=new Set;function y(e){v.forEach((t=>{t.c(e)||(v.delete(t),t.f())})),0!==v.size&&w(y)}function k(e,t){e.appendChild(t)}function x(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function L(e){const t=R("style");return function(e,t){k(e.head||e,t),t.sheet}(x(e),t),t.sheet}function C(e,t,n){e.insertBefore(t,n||null)}function S(e){e.parentNode&&e.parentNode.removeChild(e)}function I(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function R(e){return document.createElement(e)}function P(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function E(e){return document.createTextNode(e)}function O(){return E(" ")}function j(){return E("")}function N(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function _(e){return function(t){return t.preventDefault(),e.call(this,t)}}function T(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function M(e,t){t=""+t,e.data!==t&&(e.data=t)}function A(e,t,n,r){null==n?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}function V(e,t,n){e.classList[n?"add":"remove"](t)}function z(e,t,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(e,n,r,t),i}const q=new Map;let U,B=0;function H(e,t,n,r,i,s,o,l=0){const c=16.666/r;let a="{\n";for(let e=0;e<=1;e+=c){const r=t+(n-t)*s(e);a+=100*e+`%{${o(r,1-r)}}\n`}const u=a+`100% {${o(n,1-n)}}\n}`,d=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${l}`,p=x(e),{stylesheet:g,rules:f}=q.get(p)||function(e,t){const n={stylesheet:L(t),rules:{}};return q.set(e,n),n}(p,e);f[d]||(f[d]=!0,g.insertRule(`@keyframes ${d} ${u}`,g.cssRules.length));const m=e.style.animation||"";return e.style.animation=`${m?`${m}, `:""}${d} ${r}ms linear ${i}ms 1 both`,B+=1,d}function D(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),i=n.length-r.length;i&&(e.style.animation=r.join(", "),B-=i,B||w((()=>{B||(q.forEach((e=>{const{ownerNode:t}=e.stylesheet;t&&S(t)})),q.clear())})))}function F(e){U=e}function J(){if(!U)throw new Error("Function called outside component initialization");return U}const X=[],K=[];let Q=[];const G=[],Z=Promise.resolve();let W=!1;function Y(e){Q.push(e)}const ee=new Set;let te,ne=0;function re(){if(0!==ne)return;const e=U;do{try{for(;ne<X.length;){const e=X[ne];ne++,F(e),ie(e.$$)}}catch(e){throw X.length=0,ne=0,e}for(F(null),X.length=0,ne=0;K.length;)K.pop()();for(let e=0;e<Q.length;e+=1){const t=Q[e];ee.has(t)||(ee.add(t),t())}Q.length=0}while(X.length);for(;G.length;)G.pop()();W=!1,ee.clear(),F(e)}function ie(e){if(null!==e.fragment){e.update(),i(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Y)}}function se(e,t,n){e.dispatchEvent(z(`${t?"intro":"outro"}${n}`))}const oe=new Set;let le;function ce(){le={r:0,c:[],p:le}}function ae(){le.r||i(le.c),le=le.p}function ue(e,t){e&&e.i&&(oe.delete(e),e.i(t))}function de(e,t,n,r){if(e&&e.o){if(oe.has(e))return;oe.add(e),le.c.push((()=>{oe.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}else r&&r()}const pe={duration:0};function ge(n,r,o,l){const c={direction:"both"};let a=r(n,o,c),u=l?0:1,d=null,p=null,g=null;function f(){g&&D(n,g)}function m(e,t){const n=e.b-u;return t*=Math.abs(n),{a:u,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function h(r){const{delay:s=0,duration:o=300,easing:l=t,tick:c=e,css:h}=a||pe,$={start:b()+s,b:r};r||($.group=le,le.r+=1),d||p?p=$:(h&&(f(),g=H(n,u,r,o,s,l,h)),r&&c(0,1),d=m($,o),Y((()=>se(n,r,"start"))),function(e){let t;0===v.size&&w(y),new Promise((n=>{v.add(t={c:e,f:n})}))}((e=>{if(p&&e>p.start&&(d=m(p,o),p=null,se(n,d.b,"start"),h&&(f(),g=H(n,u,d.b,d.duration,0,l,a.css))),d)if(e>=d.end)c(u=d.b,1-u),se(n,d.b,"end"),p||(d.b?f():--d.group.r||i(d.group.c)),d=null;else if(e>=d.start){const t=e-d.start;u=d.a+d.d*l(t/d.duration),c(u,1-u)}return!(!d&&!p)})))}return{run(e){s(a)?(te||(te=Promise.resolve(),te.then((()=>{te=null}))),te).then((()=>{a=a(c),h(e)})):h(e)},end(){f(),d=p=null}}}function fe(e,t){const n=t.token={};function r(e,r,i,s){if(t.token!==n)return;t.resolved=s;let o=t.ctx;void 0!==i&&(o=o.slice(),o[i]=s);const l=e&&(t.current=e)(o);let c=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==r&&e&&(ce(),de(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),ae())})):t.block.d(1),l.c(),ue(l,1),l.m(t.mount(),t.anchor),c=!0),t.block=l,t.blocks&&(t.blocks[r]=l),c&&re()}if(!(i=e)||"object"!=typeof i&&"function"!=typeof i||"function"!=typeof i.then){if(t.current!==t.then)return r(t.then,1,t.value,e),!0;t.resolved=e}else{const n=J();if(e.then((e=>{F(n),r(t.then,1,t.value,e),F(null)}),(e=>{if(F(n),r(t.catch,2,t.error,e),F(null),!t.hasCatch)throw e})),t.current!==t.pending)return r(t.pending,0),!0}var i}function me(e,t,n){const r=t.slice(),{resolved:i}=e;e.current===e.then&&(r[e.value]=i),e.current===e.catch&&(r[e.error]=i),e.block.p(r,n)}function he(e,t){de(e,1,1,(()=>{t.delete(e.key)}))}function $e(e,t,n,r,s,o,l,c,a,u,d,p){let g=e.length,f=o.length,m=g;const h={};for(;m--;)h[e[m].key]=m;const $=[],b=new Map,w=new Map,v=[];for(m=f;m--;){const e=p(s,o,m),i=n(e);let c=l.get(i);c?r&&v.push((()=>c.p(e,t))):(c=u(i,e),c.c()),b.set(i,$[m]=c),i in h&&w.set(i,Math.abs(m-h[i]))}const y=new Set,k=new Set;function x(e){ue(e,1),e.m(c,d),l.set(e.key,e),d=e.first,f--}for(;g&&f;){const t=$[f-1],n=e[g-1],r=t.key,i=n.key;t===n?(d=t.first,g--,f--):b.has(i)?!l.has(r)||y.has(r)?x(t):k.has(i)?g--:w.get(r)>w.get(i)?(k.add(r),x(t)):(y.add(i),g--):(a(n,l),g--)}for(;g--;){const t=e[g];b.has(t.key)||a(t,l)}for(;f;)x($[f-1]);return i(v),$}function be(e){e&&e.c()}function we(e,t,r,o){const{fragment:l,after_update:c}=e.$$;l&&l.m(t,r),o||Y((()=>{const t=e.$$.on_mount.map(n).filter(s);e.$$.on_destroy?e.$$.on_destroy.push(...t):i(t),e.$$.on_mount=[]})),c.forEach(Y)}function ve(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];Q.forEach((r=>-1===e.indexOf(r)?t.push(r):n.push(r))),n.forEach((e=>e())),Q=t}(n.after_update),i(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ye(e,t){-1===e.$$.dirty[0]&&(X.push(e),W||(W=!0,Z.then(re)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ke(t,n,s,o,l,c,a,u=[-1]){const d=U;F(t);const p=t.$$={fragment:null,ctx:[],props:c,update:e,not_equal:l,bound:r(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:r(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};a&&a(p.root);let g=!1;if(p.ctx=s?s(t,n.props||{},((e,n,...r)=>{const i=r.length?r[0]:n;return p.ctx&&l(p.ctx[e],p.ctx[e]=i)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](i),g&&ye(t,e)),n})):[],p.update(),g=!0,i(p.before_update),p.fragment=!!o&&o(p.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);p.fragment&&p.fragment.l(e),e.forEach(S)}else p.fragment&&p.fragment.c();n.intro&&ue(t.$$.fragment),we(t,n.target,n.anchor,n.customElement),re()}F(d)}class xe{$destroy(){ve(this,1),this.$destroy=e}$on(t,n){if(!s(n))return e;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const e=r.indexOf(n);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Le=[];function Ce(t,n=e){let r;const i=new Set;function s(e){if(o(t,e)&&(t=e,r)){const e=!Le.length;for(const e of i)e[1](),Le.push(e,t);if(e){for(let e=0;e<Le.length;e+=2)Le[e][0](Le[e+1]);Le.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(o,l=e){const c=[o,l];return i.add(c),1===i.size&&(r=n(s)||e),o(t),()=>{i.delete(c),0===i.size&&r&&(r(),r=null)}}}}function Se(t,n,r){const o=!Array.isArray(t),l=o?[t]:t,c=n.length<2;return u=t=>{let r=!1;const u=[];let d=0,p=e;const g=()=>{if(d)return;p();const r=n(o?u[0]:u,t);c?t(r):p=s(r)?r:e},f=l.map(((e,t)=>a(e,(e=>{u[t]=e,d&=~(1<<t),r&&g()}),(()=>{d|=1<<t}))));return r=!0,g(),function(){i(f),p(),r=!1}},{subscribe:Ce(r,u).subscribe};var u}const Ie=Ce(!1);async function Re(e){Ie.set(!0);try{return await e()}finally{Ie.set(!1)}}function Pe(e=null,t="full",n="full"){if(!e)return"https://via.placeholder.com/96x96?text=No+Image";if((e=e.split("_")).length<3)return"https://via.placeholder.com/96x96?text=No+Image";const r=e[e.length-1].includes(",")?e.pop().replace(".jpg",""):t,i=e.join("_").replace(".jpg","");return`${CANTALOUPE_APP_URL??"http://localhost:8182"}/iiif/2/${i}.jpg/${r}/${n}/0/default.jpg`}function Ee(e=null,t=1){return`${SAS_APP_URL??"http://localhost:3000"}/index.html?iiif-content=${e}&canvas=${t}`}function Oe(e,t=null,n=!1){return new Promise((r=>{if(document.getElementById("msg-modal")){n?document.getElementById("modal-footer").hidden=!1:r(void 0),t&&(document.getElementById("modal-title").textContent=t),document.getElementById("modal-body").textContent=e,document.getElementById("hidden-msg-btn").click();const i=document.getElementById("cancel-btn"),s=document.getElementById("ok-btn"),o=document.getElementById("modal-bkg"),l=()=>{i.removeEventListener("click",c),o.removeEventListener("click",c),s.removeEventListener("click",a),document.getElementById("modal-footer").hidden=!0},c=()=>{l(),r(!1)},a=()=>{l(),r(!0)};i.addEventListener("click",c),s.addEventListener("click",a)}else n?r(window.confirm(e)):(window.alert(e),r(void 0))}))}const je="Regions";const Ne=function(){const e=Ce(JSON.parse(localStorage.getItem("documentSet"))||{}),{subscribe:t,get:n,update:r}=e;function i(e){localStorage.setItem("documentSet",JSON.stringify(e))}function s(e,t=!0){return t?e[je]??{}:Object.entries(e).filter((([e,t])=>e!==je))}function o(e,t,n){if(e[n]){const{[t]:r,...i}=e[n];e={...e,[n]:i}}return i(e),e}function l(e,t){return e.hasOwnProperty(t.type)||(e[t.type]={}),e[t.type]={...e[t.type],[t.id]:t},i(e),e}return{subscribe:t,save:()=>r((e=>(console.log(e),e))),empty:e=>r((t=>(e?delete t[je]:Object.keys(t).forEach((e=>{e!==je&&delete t[e]})),i(t),t))),addAll:e=>r((t=>function(e,t){return t.forEach((t=>{e[t.type]||(e[t.type]={}),e[t.type][t.id]=t})),i(e),e}(t,e))),removeAll:(e,t)=>r((n=>function(e,t,n){return e[n]?(t.forEach((t=>{delete e[n][t]})),i(e),e):e}(n,e,t))),remove:(e,t)=>r((n=>o(n,e,t))),add:e=>r((t=>l(t,e))),toggle:e=>r((t=>t[e.type]?.[e.id]?o(t,e.id,e.type):l(t,e))),toggleAll:(e,t,n)=>r((e=>{})),isSelected:Se(e,(e=>t=>e[t.type]?.hasOwnProperty(t.id)||!1)),selected:Se(e,(e=>t=>s(e,t))),nbSelected:Se(e,(e=>t=>{const n=s(e,t);return t?Object.keys(n).length:n.reduce(((e,[t,n])=>e+Object.keys(n).length),0)}))}}();const _e=function(){const e=Ce(1),t=Ce({}),n=Ce({}),r=`${window.location.origin}${window.location.pathname}`;if("undefined"!=typeof window){const t=new URLSearchParams(window.location.search).get("p");t&&e.set(parseInt(t))}const i=(async()=>{const e=await fetch(`${r}canvas`),n=await e.json();let i={};return Object.values(n).forEach((e=>{Object.entries(e).forEach((([e,t])=>{i[e]=t}))})),t.set(i),n})(),s=Se(e,(e=>(async()=>{const t=await fetch(`${r}canvas?p=${e}`),i=await t.json();return n.set(i),i})()));return{currentPage:e,pageRegions:n,allRegions:t,fetchPages:s,fetchAll:i,handlePageUpdate:function(t){if(e.set(t),"undefined"!=typeof window){const e=new URL(window.location.href);e.searchParams.set("p",t),window.history.pushState({},"",e)}},remove:function(e){t.update((t=>(delete t[e],{...t}))),n.update((t=>{for(const n in t)if(t[n][e]){const{[e]:r,...i}=t[n];return t[n]=i,t}return t}))}}}();function Te(e,{delay:n=0,duration:r=400,easing:i=t}={}){const s=+getComputedStyle(e).opacity;return{delay:n,duration:r,easing:i,css:e=>"opacity: "+e*s}}function Me(e){let t,n,r;return{c(){t=R("div"),t.innerHTML='<div class="loader svelte-vizlcg"></div>',T(t,"class","bkg-shade svelte-vizlcg")},m(e,n){C(e,t,n),r=!0},i(e){r||(Y((()=>{r&&(n||(n=ge(t,Te,{duration:150},!0)),n.run(1))})),r=!0)},o(e){n||(n=ge(t,Te,{duration:150},!1)),n.run(0),r=!1},d(e){e&&S(t),e&&n&&n.end()}}}function Ae(e){let t,n,r=e[0]&&Me();return{c(){r&&r.c(),t=j()},m(e,i){r&&r.m(e,i),C(e,t,i),n=!0},p(e,[n]){e[0]?r?1&n&&ue(r,1):(r=Me(),r.c(),ue(r,1),r.m(t.parentNode,t)):r&&(ce(),de(r,1,1,(()=>{r=null})),ae())},i(e){n||(ue(r),n=!0)},o(e){de(r),n=!1},d(e){r&&r.d(e),e&&S(t)}}}function Ve(e,t,n){let{visible:r=!1}=t;return e.$$set=e=>{"visible"in e&&n(0,r=e.visible)},[r]}class ze extends xe{constructor(e){super(),ke(this,e,Ve,Ae,o,{visible:0})}}function qe(e){let t;return{c(){t=P("path"),T(t,"d","M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"),T(t,"class","svelte-ip25jb")},m(e,n){C(e,t,n)},d(e){e&&S(t)}}}function Ue(e){let t;return{c(){t=P("path"),T(t,"d","M208 0H332.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H208c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128h80v64H64V448H256V416h64v48c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48z"),T(t,"class","svelte-ip25jb")},m(e,n){C(e,t,n)},d(e){e&&S(t)}}}function Be(e){let t,n="en"===e[2]?"Copy ID":"Copier l'ID";return{c(){t=E(n)},m(e,n){C(e,t,n)},p(e,r){4&r&&n!==(n="en"===e[2]?"Copy ID":"Copier l'ID")&&M(t,n)},d(e){e&&S(t)}}}function He(e){let t,n="en"===e[2]?"Copied!":"Copié !";return{c(){t=E(n)},m(e,n){C(e,t,n)},p(e,r){4&r&&n!==(n="en"===e[2]?"Copied!":"Copié !")&&M(t,n)},d(e){e&&S(t)}}}function De(e){let t,n,r,s,o,l,a,u,d,p,g,f,m,h,$,b,w,v,y,x=e[0].title+"";function L(e,t){return e[1]?Ue:qe}let I=L(e),j=I(e);function _(e,t){return e[1]?He:Be}let A=_(e),V=A(e);return{c(){t=R("div"),n=R("figure"),r=R("img"),o=O(),l=R("div"),a=R("span"),u=E(x),p=O(),g=R("button"),f=P("svg"),j.c(),m=O(),h=R("span"),V.c(),c(r.src,s=Pe(e[0].img,e[0].xyhw,e[3]?"96,":"140,"))||T(r,"src",s),T(r,"alt","Extracted region"),T(a,"class","overlay-desc"),T(l,"class","overlay is-center svelte-ip25jb"),T(n,"class",d="image card "+(e[3]?"is-96x96":"")+" svelte-ip25jb"),T(n,"tabindex","-1"),T(f,"xmlns","http://www.w3.org/2000/svg"),T(f,"viewBox","0 0 384 512"),T(f,"class","svelte-ip25jb"),T(h,"class","tooltip svelte-ip25jb"),T(g,"class","button region-btn tag svelte-ip25jb"),T(t,"class",$="region image is-center "+(e[4](e[0])?"checked":"")+" svelte-ip25jb")},m(i,s){C(i,t,s),k(t,n),k(n,r),k(n,o),k(n,l),k(l,a),k(a,u),k(t,p),k(t,g),k(g,f),j.m(f,null),k(g,m),k(g,h),V.m(h,null),w=!0,v||(y=[N(n,"click",e[7]),N(n,"keyup",Fe),N(g,"click",e[8])],v=!0)},p(e,[i]){(!w||9&i&&!c(r.src,s=Pe(e[0].img,e[0].xyhw,e[3]?"96,":"140,")))&&T(r,"src",s),(!w||1&i)&&x!==(x=e[0].title+"")&&M(u,x),(!w||8&i&&d!==(d="image card "+(e[3]?"is-96x96":"")+" svelte-ip25jb"))&&T(n,"class",d),I!==(I=L(e))&&(j.d(1),j=I(e),j&&(j.c(),j.m(f,null))),A===(A=_(e))&&V?V.p(e,i):(V.d(1),V=A(e),V&&(V.c(),V.m(h,null))),(!w||17&i&&$!==($="region image is-center "+(e[4](e[0])?"checked":"")+" svelte-ip25jb"))&&T(t,"class",$)},i(e){w||(Y((()=>{w&&(b||(b=ge(t,Te,{duration:500},!0)),b.run(1))})),w=!0)},o(e){b||(b=ge(t,Te,{duration:500},!1)),b.run(0),w=!1},d(e){e&&S(t),j.d(),V.d(),e&&b&&b.end(),v=!1,i(y)}}}const Fe=()=>null;function Je(e,t,n){let r;const{isSelected:i}=Ne;d(e,i,(e=>n(4,r=e)));const s=function(){const e=J();return(t,n,{cancelable:r=!1}={})=>{const i=e.$$.callbacks[t];if(i){const s=z(t,n,{cancelable:r});return i.slice().forEach((t=>{t.call(e,s)})),!s.defaultPrevented}return!0}}();let{item:o}=t,{isCopied:l=!1}=t,{appLang:c="en"}=t,{isSquare:a=!0}=t;function u(){s("copyRef",{item:o})}return e.$$set=e=>{"item"in e&&n(0,o=e.item),"isCopied"in e&&n(1,l=e.isCopied),"appLang"in e&&n(2,c=e.appLang),"isSquare"in e&&n(3,a=e.isSquare)},[o,l,c,a,r,i,u,()=>Ne.toggle(o),()=>u()]}class Xe extends xe{constructor(e){super(),ke(this,e,Je,De,o,{item:0,isCopied:1,appLang:2,isSquare:3})}}function Ke(t){let n,r,i,s,o,l,c,a,u,d="en"===t[1]?"Selection":"Sélection";return{c(){n=R("div"),r=R("button"),i=R("span"),s=R("i"),o=O(),l=E(d),c=E("\n            ("),a=E(t[0]),u=E(")"),T(s,"class","fa-solid fa-book-bookmark"),T(i,"id","btn-content"),T(r,"id","set-btn"),T(r,"class","button px-5 py-4 is-link js-modal-trigger svelte-hs48f9"),T(r,"data-target","selection-modal"),T(n,"class","set-container svelte-hs48f9")},m(e,t){C(e,n,t),k(n,r),k(r,i),k(i,s),k(i,o),k(i,l),k(i,c),k(i,a),k(i,u)},p(e,[t]){2&t&&d!==(d="en"===e[1]?"Selection":"Sélection")&&M(l,d),1&t&&M(a,e[0])},i:e,o:e,d(e){e&&S(n)}}}function Qe(e,t,n){let{selectionLength:r=0}=t,{appLang:i="en"}=t,s=r;return e.$$set=e=>{"selectionLength"in e&&n(0,r=e.selectionLength),"appLang"in e&&n(1,i=e.appLang)},e.$$.update=()=>{if(5&e.$$.dirty&&r!==s){const e=r>s;n(2,s=r);const t=document.getElementById("btn-content");t&&t.animate([{transform:e?"translateY(-7px)":"translateX(-5px)"},{transform:e?"translateY(7px)":"translateX(5px)"},{transform:"translate(0)"}],{duration:300,easing:"cubic-bezier(0.65, 0, 0.35, 1)"})}},[r,i,s]}class Ge extends xe{constructor(e){super(),ke(this,e,Qe,Ke,o,{selectionLength:0,appLang:1})}}function Ze(t){let n,r,s,o,l,c,a,u,d,p,g,f="en"===t[0]?"Clear selection":"Vider la sélection",m="en"===t[0]?"Save selection":"Sauvegarder la sélection";return{c(){n=R("footer"),r=R("div"),s=R("button"),o=E(f),l=O(),c=R("button"),a=R("i"),u=O(),d=E(m),T(s,"class","button is-link is-light"),T(a,"class","fa-solid fa-floppy-disk"),T(c,"class","button is-link"),T(r,"class","buttons"),T(n,"class","modal-card-foot is-center")},m(e,i){C(e,n,i),k(n,r),k(r,s),k(s,o),k(r,l),k(r,c),k(c,a),k(c,u),k(c,d),p||(g=[N(s,"click",t[2]),N(c,"click",t[3])],p=!0)},p(e,[t]){1&t&&f!==(f="en"===e[0]?"Clear selection":"Vider la sélection")&&M(o,f),1&t&&m!==(m="en"===e[0]?"Save selection":"Sauvegarder la sélection")&&M(d,m)},i:e,o:e,d(e){e&&S(n),p=!1,i(g)}}}function We(e,t,n){let{appLang:r="en"}=t,{isRegion:i=!0}=t;return e.$$set=e=>{"appLang"in e&&n(0,r=e.appLang),"isRegion"in e&&n(1,i=e.isRegion)},[r,i,()=>Ne.empty(i),()=>Ne.save()]}class Ye extends xe{constructor(e){super(),ke(this,e,We,Ze,o,{appLang:0,isRegion:1})}}function et(e){let t,n,r,i,s,o,l,a,u,d,g,$,b,w,v,y,x,L;const I=e[4].default,P=p(I,e,e[3],null);return{c(){t=R("tr"),n=R("th"),r=R("div"),i=R("img"),l=O(),a=R("div"),u=R("a"),d=R("i"),g=E("\n                    Page "),$=E(e[0]),w=O(),v=R("td"),y=R("div"),x=R("div"),P&&P.c(),c(i.src,s=Pe(e[1],"full","250,"))||T(i,"src",s),T(i,"alt",o="Canvas "+e[0]),T(i,"class","mb-3 card"),T(d,"class","fa-solid fa-pen-to-square"),T(u,"class","tag px-2 py-1 is-rounded"),T(u,"href",b=Ee(e[2],e[0])),T(u,"target","_blank"),T(a,"class","is-center mb-1"),T(r,"class","content-wrapper py-5"),T(n,"class","is-3 center-flex is-narrow"),A(n,"width","260px"),T(x,"class","grid is-gap-2"),T(y,"class","fixed-grid has-6-cols"),T(v,"class","p-5 is-fullwidth")},m(e,s){C(e,t,s),k(t,n),k(n,r),k(r,i),k(r,l),k(r,a),k(a,u),k(u,d),k(u,g),k(u,$),k(t,w),k(t,v),k(v,y),k(y,x),P&&P.m(x,null),L=!0},p(e,[t]){(!L||2&t&&!c(i.src,s=Pe(e[1],"full","250,")))&&T(i,"src",s),(!L||1&t&&o!==(o="Canvas "+e[0]))&&T(i,"alt",o),(!L||1&t)&&M($,e[0]),(!L||5&t&&b!==(b=Ee(e[2],e[0])))&&T(u,"href",b),P&&P.p&&(!L||8&t)&&m(P,I,e,e[3],L?f(I,e[3],t,null):h(e[3]),null)},i(e){L||(ue(P,e),L=!0)},o(e){de(P,e),L=!1},d(e){e&&S(t),P&&P.d(e)}}}function tt(e,t,n){let{$$slots:r={},$$scope:i}=t,{canvasNb:s}=t,{canvasImg:o}=t,{manifest:l}=t;return e.$$set=e=>{"canvasNb"in e&&n(0,s=e.canvasNb),"canvasImg"in e&&n(1,o=e.canvasImg),"manifest"in e&&n(2,l=e.manifest),"$$scope"in e&&n(3,i=e.$$scope)},[s,o,l,i,r]}class nt extends xe{constructor(e){super(),ke(this,e,tt,et,o,{canvasNb:0,canvasImg:1,manifest:2})}}function rt(e){let t,n,r,i,s,o,l=e[1]-1>1&&it(e);return{c(){t=R("li"),n=R("a"),n.textContent="1",r=O(),l&&l.c(),i=j(),T(n,"class","pagination-link"),T(n,"href",null)},m(c,a){C(c,t,a),k(t,n),C(c,r,a),l&&l.m(c,a),C(c,i,a),s||(o=N(n,"click",_(e[6])),s=!0)},p(e,t){e[1]-1>1?l?l.p(e,t):(l=it(e),l.c(),l.m(i.parentNode,i)):l&&(l.d(1),l=null)},d(e){e&&S(t),e&&S(r),l&&l.d(e),e&&S(i),s=!1,o()}}}function it(e){let t,n,r,i,s,o,l,c=e[1]-1+"";return{c(){t=R("li"),t.innerHTML='<span class="pagination-ellipsis">…</span>',n=O(),r=R("li"),i=R("a"),s=E(c),T(i,"class","pagination-link"),T(i,"href",null)},m(c,a){C(c,t,a),C(c,n,a),C(c,r,a),k(r,i),k(i,s),o||(l=N(i,"click",_(e[7])),o=!0)},p(e,t){2&t&&c!==(c=e[1]-1+"")&&M(s,c)},d(e){e&&S(t),e&&S(n),e&&S(r),o=!1,l()}}}function st(e){let t,n,r,i,s,o=e[1]+1<e[3]&&ot(e);return{c(){o&&o.c(),t=O(),n=R("li"),r=R("a"),r.textContent=`${e[3]}`,T(r,"class","pagination-link"),T(r,"href",null)},m(l,c){o&&o.m(l,c),C(l,t,c),C(l,n,c),k(n,r),i||(s=N(r,"click",_(e[10])),i=!0)},p(e,n){e[1]+1<e[3]?o?o.p(e,n):(o=ot(e),o.c(),o.m(t.parentNode,t)):o&&(o.d(1),o=null)},d(e){o&&o.d(e),e&&S(t),e&&S(n),i=!1,s()}}}function ot(e){let t,n,r,i,s,o,l,c=e[1]+1+"";return{c(){t=R("li"),n=R("a"),r=E(c),i=O(),s=R("li"),s.innerHTML='<span class="pagination-ellipsis">…</span>',T(n,"class","pagination-link"),T(n,"href",null)},m(c,a){C(c,t,a),k(t,n),k(n,r),C(c,i,a),C(c,s,a),o||(l=N(n,"click",_(e[9])),o=!0)},p(e,t){2&t&&c!==(c=e[1]+1+"")&&M(r,c)},d(e){e&&S(t),e&&S(i),e&&S(s),o=!1,l()}}}function lt(t){let n,r=t[3]>1&&function(e){let t,n,r,i,s,o,l,c,a,u=e[1]>1&&rt(e),d=e[1]<e[3]&&st(e);return{c(){t=R("nav"),n=R("ul"),u&&u.c(),r=O(),i=R("li"),s=R("a"),o=E(e[1]),l=O(),d&&d.c(),T(s,"class","pagination-link is-current"),T(s,"href",null),T(n,"class","pagination-list"),T(t,"class","pagination is-centered"),T(t,"aria-label","pagination")},m(p,g){C(p,t,g),k(t,n),u&&u.m(n,null),k(n,r),k(n,i),k(i,s),k(s,o),k(n,l),d&&d.m(n,null),c||(a=N(s,"click",_(e[8])),c=!0)},p(e,t){e[1]>1?u?u.p(e,t):(u=rt(e),u.c(),u.m(n,r)):u&&(u.d(1),u=null),2&t&&M(o,e[1]),e[1]<e[3]?d?d.p(e,t):(d=st(e),d.c(),d.m(n,null)):d&&(d.d(1),d=null)},d(e){e&&S(t),u&&u.d(),d&&d.d(),c=!1,a()}}}(t);return{c(){r&&r.c(),n=j()},m(e,t){r&&r.m(e,t),C(e,n,t)},p(e,[t]){e[3]>1&&r.p(e,t)},i:e,o:e,d(e){r&&r.d(e),e&&S(n)}}}function ct(e,t,n){let r,{store:i}=t;const{currentPage:s}=i;d(e,s,(e=>n(1,r=e)));let{nbOfItems:o}=t,{pageLength:l=50}=t;const c=Math.ceil(o/l);return e.$$set=e=>{"store"in e&&n(0,i=e.store),"nbOfItems"in e&&n(4,o=e.nbOfItems),"pageLength"in e&&n(5,l=e.pageLength)},[i,r,s,c,o,l,()=>i.handlePageUpdate(1),()=>i.handlePageUpdate(r-1),()=>i.handlePageUpdate(r),()=>i.handlePageUpdate(r+1),()=>i.handlePageUpdate(c)]}class at extends xe{constructor(e){super(),ke(this,e,ct,lt,o,{store:0,nbOfItems:4,pageLength:5})}}function ut(t){let n,r,i,s,o,l,c,a,u,d,p,g,f,m,h,$,b="en"===t[0]?"Cancel":"Annuler";return{c(){n=R("button"),r=O(),i=R("div"),s=R("div"),o=O(),l=R("div"),c=R("div"),c.innerHTML='<div class="title is-4 mb-0 media-content"><span id="modal-title" class="mb-0"></span></div> \n            <button class="delete media-left" aria-label="close"></button>',a=O(),u=R("section"),d=O(),p=R("footer"),g=R("div"),f=R("button"),m=E(b),h=O(),$=R("button"),$.textContent="OK",T(n,"id","hidden-msg-btn"),T(n,"class","js-modal-trigger"),T(n,"data-target","msg-modal"),n.hidden=!0,T(s,"id","modal-bkg"),T(s,"class","modal-background"),T(c,"class","modal-card-head media mb-0"),T(u,"id","modal-body"),T(u,"class","modal-card-body"),T(f,"id","cancel-btn"),T(f,"class","button is-link is-light"),T($,"id","ok-btn"),T($,"class","button is-link"),T(g,"class","buttons"),T(p,"id","modal-footer"),T(p,"class","modal-card-foot is-center pt-3"),p.hidden=!0,T(l,"class","modal-content"),T(i,"id","msg-modal"),T(i,"class","modal fade"),T(i,"tabindex","-1"),T(i,"aria-labelledby","selection-modal-label"),T(i,"aria-hidden","true")},m(e,t){C(e,n,t),C(e,r,t),C(e,i,t),k(i,s),k(i,o),k(i,l),k(l,c),k(l,a),k(l,u),k(l,d),k(l,p),k(p,g),k(g,f),k(f,m),k(g,h),k(g,$)},p(e,[t]){1&t&&b!==(b="en"===e[0]?"Cancel":"Annuler")&&M(m,b)},i:e,o:e,d(e){e&&S(n),e&&S(r),e&&S(i)}}}function dt(e,t,n){let{appLang:r="en"}=t;return e.$$set=e=>{"appLang"in e&&n(0,r=e.appLang)},[r]}class pt extends xe{constructor(e){super(),ke(this,e,dt,ut,o,{appLang:0})}}function gt(e){let t,n,r="en"===e[0]?"Automatic region extraction":"Extraction automatique des régions";return{c(){t=R("button"),n=E(r),T(t,"class","button is-link is-inverted")},m(e,r){C(e,t,r),k(t,n)},p(e,t){1&t&&r!==(r="en"===e[0]?"Automatic region extraction":"Extraction automatique des régions")&&M(n,r)},d(e){e&&S(t)}}}function ft(t){let n,r,i,s,o,l,c,a,u,d="en"===t[0]?"Manually annotate":"Annoter manuellement",p="en"===t[0]?"Import regions file":"Importer un fichier de région",g=t[1].includes("regions"),f=g&&gt(t);return{c(){n=R("div"),r=R("button"),i=E(d),s=O(),o=R("button"),l=E(p),c=O(),f&&f.c(),T(r,"class","button is-link"),T(o,"class","button is-link is-light"),T(n,"class","is-center buttons is-centered pt-5")},m(e,d){C(e,n,d),k(n,r),k(r,i),k(n,s),k(n,o),k(o,l),k(n,c),f&&f.m(n,null),a||(u=N(r,"click",t[2]),a=!0)},p(e,[t]){1&t&&d!==(d="en"===e[0]?"Manually annotate":"Annoter manuellement")&&M(i,d),1&t&&p!==(p="en"===e[0]?"Import regions file":"Importer un fichier de région")&&M(l,p),2&t&&(g=e[1].includes("regions")),g?f?f.p(e,t):(f=gt(e),f.c(),f.m(n,null)):f&&(f.d(1),f=null)},i:e,o:e,d(e){e&&S(n),f&&f.d(),a=!1,u()}}}function mt(e,t,n){let{appLang:r="en"}=t,{modules:i=[]}=t,{witness:s={}}=t,{currentRegionId:o}=t,{baseUrl:l}=t;return e.$$set=e=>{"appLang"in e&&n(0,r=e.appLang),"modules"in e&&n(1,i=e.modules),"witness"in e&&n(3,s=e.witness),"currentRegionId"in e&&n(4,o=e.currentRegionId),"baseUrl"in e&&n(5,l=e.baseUrl)},[r,i,async function(){const e=window.location.origin;let t=`${e}/witness/${s.id}/regions/add`;if(1===s.regions.length||o){const n=o||s.regions[0];t=`${e}/witness/${s.id}/regions/${n}/add`}const n=await Re((()=>fetch(t,{method:"POST",headers:{"X-CSRFToken":CSRF_TOKEN}})));if(!n.ok)throw await Oe(`Failed to create regions: '${n.statusText}'`,"Error"),new Error(`Failed to create regions: '${n.statusText}'`);let r;try{r=await n.json()}catch(e){throw await Oe(`Failed to parse JSON response: '${e}'`,"Error"),new Error(`Failed to parse JSON response: '${e}'`)}console.log(r),r.hasOwnProperty("mirador_url")&&window.open(r.mirador_url),r.hasOwnProperty("regions_id")&&(window.location.href=`${l.split("regions/")[0]}regions/${r.regions_id}`)},s,o,l]}class ht extends xe{constructor(e){super(),ke(this,e,mt,ft,o,{appLang:0,modules:1,witness:3,currentRegionId:4,baseUrl:5})}}function $t(e,t,n){const r=e.slice();return r[5]=t[n],r}function bt(e){let t,n=e[0].regions,r=[];for(let t=0;t<n.length;t+=1)r[t]=vt($t(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=j()},m(e,n){for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,n);C(e,t,n)},p(e,i){if(5&i){let s;for(n=e[0].regions,s=0;s<n.length;s+=1){const o=$t(e,n,s);r[s]?r[s].p(o,i):(r[s]=vt(o),r[s].c(),r[s].m(t.parentNode,t))}for(;s<r.length;s+=1)r[s].d(1);r.length=n.length}},d(e){I(r,e),e&&S(t)}}}function wt(e){let t,n,r,i,s="en"===e[1]?"Delete regions record":"Supprimer l'intégralité des régions";return{c(){t=R("button"),n=E(s),T(t,"class","tag is-danger")},m(s,o){C(s,t,o),k(t,n),r||(i=N(t,"click",e[4]),r=!0)},p(e,t){2&t&&s!==(s="en"===e[1]?"Delete regions record":"Supprimer l'intégralité des régions")&&M(n,s)},d(e){e&&S(t),r=!1,i()}}}function vt(e){let t,n,r,i,s=e[5]+"";return{c(){t=R("a"),n=E("Regions #"),r=E(s),T(t,"href",i=""+(e[2]+e[5])),T(t,"class","tag is-dark mr-3 is-rounded")},m(e,i){C(e,t,i),k(t,n),k(t,r)},p(e,n){1&n&&s!==(s=e[5]+"")&&M(r,s),5&n&&i!==(i=""+(e[2]+e[5]))&&T(t,"href",i)},d(e){e&&S(t)}}}function yt(t){let n;function r(e,t){return e[3]?wt:bt}let i=r(t),s=i(t);return{c(){n=R("div"),s.c(),T(n,"class","is-right")},m(e,t){C(e,n,t),s.m(n,null)},p(e,[t]){i===(i=r(e))&&s?s.p(e,t):(s.d(1),s=i(e),s&&(s.c(),s.m(n,null)))},i:e,o:e,d(e){e&&S(n),s.d()}}}function kt(e,t,n){let{witness:r}=t,{appLang:i="en"}=t,{baseUrl:s=`${window.location.origin}${window.location.pathname}`}=t,{currentRegionId:o}=t;return e.$$set=e=>{"witness"in e&&n(0,r=e.witness),"appLang"in e&&n(1,i=e.appLang),"baseUrl"in e&&n(2,s=e.baseUrl),"currentRegionId"in e&&n(3,o=e.currentRegionId)},[r,i,s,o,async function(){if(!await Oe("en"===i?"Are you sure you want to delete this record?":"Voulez-vous vraiment supprimer cet enregistrement?","en"===i?"Confirm deletion":"Confirmer la suppression",!0))return;if("number"!=typeof o)throw new Error("Invalid region ID");const e=`${window.location.origin}/regions/${o}/delete`;try{const t=await Re((()=>fetch(e,{method:"DELETE",headers:{"X-CSRFToken":CSRF_TOKEN}})));if(204!==t.status)throw new Error(`Failed to delete regions: '${t.statusText}'`);window.location.href=`${s.split("regions/")[0]}regions/`}catch(e){console.error(e)}}]}class xt extends xe{constructor(e){super(),ke(this,e,kt,yt,o,{witness:0,appLang:1,baseUrl:2,currentRegionId:3})}}function Lt(e){let t;return{c(){t=P("path"),T(t,"d","M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"),T(t,"class","svelte-h0t5l9")},m(e,n){C(e,t,n)},d(e){e&&S(t)}}}function Ct(e){let t;return{c(){t=P("path"),T(t,"d","M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"),T(t,"class","svelte-h0t5l9")},m(e,n){C(e,t,n)},d(e){e&&S(t)}}}function St(e){let t,n="en"===e[0]?"Edit":"Modifier";return{c(){t=E(n)},m(e,n){C(e,t,n)},p(e,r){1&r&&n!==(n="en"===e[0]?"Edit":"Modifier")&&M(t,n)},d(e){e&&S(t)}}}function It(e){let t,n="en"===e[0]?"Validate":"Valider";return{c(){t=E(n)},m(e,n){C(e,t,n)},p(e,r){1&r&&n!==(n="en"===e[0]?"Validate":"Valider")&&M(t,n)},d(e){e&&S(t)}}}function Rt(e){let t;return{c(){t=P("path"),T(t,"d","m10.6 16.2l7.05-7.05l-1.4-1.4l-5.65 5.65l-2.85-2.85l-1.4 1.4zM5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21z"),T(t,"class","svelte-h0t5l9")},m(e,n){C(e,t,n)},d(e){e&&S(t)}}}function Pt(e){let t;return{c(){t=P("path"),T(t,"d","m10.6 16.2l7.05-7.05l-1.4-1.4l-5.65 5.65l-2.85-2.85l-1.4 1.4zM5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h14q.825 0 1.413.588T21 5v14q0 .825-.587 1.413T19 21zm0-2h14V5H5zM5 5v14z"),T(t,"class","svelte-h0t5l9")},m(e,n){C(e,t,n)},d(e){e&&S(t)}}}function Et(e){let t,n,r,s,o,l,c,a,u,d,p,g,f,m,h,$,b,w="en"===e[0]?"Reload":"Recharger",v="en"===e[0]?"Go to editor":"Aller à l'éditeur",y="en"===e[0]?"Delete selected regions":"Supprimer les régions sélectionnées";return{c(){t=R("button"),n=R("i"),r=O(),s=E(w),o=O(),l=R("a"),c=R("i"),a=O(),u=E(v),p=O(),g=R("button"),f=R("i"),m=O(),h=E(y),T(n,"class","fa-solid fa-rotate-right"),T(t,"class","tag is-link is-light is-rounded mr-3"),T(c,"class","fa-solid fa-edit"),T(l,"class","tag is-link is-rounded mr-3"),T(l,"href",d=Ee(e[1])),T(l,"target","_blank"),T(f,"class","fa-solid fa-trash"),T(g,"class","tag is-danger is-rounded")},m(i,d){C(i,t,d),k(t,n),k(t,r),k(t,s),C(i,o,d),C(i,l,d),k(l,c),k(l,a),k(l,u),C(i,p,d),C(i,g,d),k(g,f),k(g,m),k(g,h),$||(b=[N(t,"click",e[18]),N(g,"click",e[8])],$=!0)},p(e,t){1&t&&w!==(w="en"===e[0]?"Reload":"Recharger")&&M(s,w),1&t&&v!==(v="en"===e[0]?"Go to editor":"Aller à l'éditeur")&&M(u,v),2&t&&d!==(d=Ee(e[1]))&&T(l,"href",d),1&t&&y!==(y="en"===e[0]?"Delete selected regions":"Supprimer les régions sélectionnées")&&M(h,y)},d(e){e&&S(t),e&&S(o),e&&S(l),e&&S(p),e&&S(g),$=!1,i(b)}}}function Ot(t){let n,r,s,o,l,c,a,u,d,p,g,f,m,h,$,b,w,v,y,x,L,I,j="en"===t[0]?"Select all":"Tout sélectionner",_="en"===t[0]?"Download":"Télécharger";function A(e,t){return e[3]?Ct:Lt}let V=A(t),z=V(t);function q(e,t){return e[3]?It:St}let U=q(t),B=U(t);function H(e,t){return e[2]?Pt:Rt}let D=H(t),F=D(t),J=t[3]&&Et(t);return{c(){n=R("div"),r=R("button"),s=P("svg"),z.c(),o=O(),B.c(),c=O(),a=R("button"),u=P("svg"),F.c(),d=O(),p=R("i"),g=O(),f=R("span"),m=E(j),h=O(),$=R("button"),b=R("i"),w=O(),v=E(_),y=O(),x=R("div"),J&&J.c(),T(s,"xmlns","http://www.w3.org/2000/svg"),T(s,"viewBox","0 0 384 512"),T(s,"class","pr-3 svelte-h0t5l9"),T(r,"class",l="button "+(t[3]?"is-success":"is-link")+" mr-3"),T(u,"xmlns","http://www.w3.org/2000/svg"),T(u,"viewBox","0 0 448 512"),T(u,"class","svelte-h0t5l9"),T(p,"class","fa-solid fa-square-check"),T(f,"id","all-selection"),T(a,"class","button is-link is-light mr-3"),T(b,"class","fa-solid fa-download"),T($,"class","button is-link is-light"),T(n,"class","is-left mb-3"),T(x,"class","edit-action is-left svelte-h0t5l9")},m(e,i){C(e,n,i),k(n,r),k(r,s),z.m(s,null),k(r,o),B.m(r,null),k(n,c),k(n,a),k(a,u),F.m(u,null),k(a,d),k(a,p),k(a,g),k(a,f),k(f,m),k(n,h),k(n,$),k($,b),k($,w),k($,v),C(e,y,i),C(e,x,i),J&&J.m(x,null),L||(I=[N(r,"click",t[17]),N(a,"click",t[9]),N($,"click",t[10])],L=!0)},p(e,[t]){V!==(V=A(e))&&(z.d(1),z=V(e),z&&(z.c(),z.m(s,null))),U===(U=q(e))&&B?B.p(e,t):(B.d(1),B=U(e),B&&(B.c(),B.m(r,null))),8&t&&l!==(l="button "+(e[3]?"is-success":"is-link")+" mr-3")&&T(r,"class",l),D!==(D=H(e))&&(F.d(1),F=D(e),F&&(F.c(),F.m(u,null))),1&t&&j!==(j="en"===e[0]?"Select all":"Tout sélectionner")&&M(m,j),1&t&&_!==(_="en"===e[0]?"Download":"Télécharger")&&M(v,_),e[3]?J?J.p(e,t):(J=Et(e),J.c(),J.m(x,null)):J&&(J.d(1),J=null)},i:e,o:e,d(e){e&&S(n),z.d(),B.d(),F.d(),e&&S(y),e&&S(x),J&&J.d(),L=!1,i(I)}}}async function jt(e){const t=SAS_APP_URL.replace("https","http"),n=`${SAS_APP_URL}/annotation/destroy?uri=${t}/annotation/${e}`,r=await fetch(n,{method:"DELETE"});if(204!==r.status)throw new Error(`Failed to delete ${n} due to ${r.status}: '${r.statusText}'`)}function Nt(e,t,n){let r,i,s,o,l,c,a;const{selected:u,nbSelected:p}=Ne;d(e,u,(e=>n(14,l=e))),d(e,p,(e=>n(16,a=e)));const{allRegions:g}=_e;d(e,g,(e=>n(15,c=e)));let{appLang:f}=t,{manifest:m}=t,{isValidated:h}=t,{regionsType:$}=t;function b(){n(3,i=!i)}return e.$$set=e=>{"appLang"in e&&n(0,f=e.appLang),"manifest"in e&&n(1,m=e.manifest),"isValidated"in e&&n(11,h=e.isValidated),"regionsType"in e&&n(12,$=e.regionsType)},e.$$.update=()=>{65536&e.$$.dirty&&n(13,r=a(!0)),2048&e.$$.dirty&&n(3,i=!h),16384&e.$$.dirty&&(s=l(!0)),40960&e.$$.dirty&&n(2,o=r>=Object.keys(c).length)},[f,m,o,i,u,p,g,b,async function(){if(await Oe("en"===f?"Are you sure you want to delete regions?":"Voulez-vous vraiment supprimer les régions?","en"===f?"Confirm deletion":"Confirmer la suppression",!0))for(const e of Object.keys(s))try{if(!c.hasOwnProperty(e))continue;await jt(e),_e.remove(e),Ne.remove(e,$)}catch(t){await Oe(`Failed to delete region ${e}: ${t.message}`,"Error")}},function(){o?Ne.removeAll(Object.keys(c),$):Ne.addAll(Object.values(c))},async function(){const e=Object.values(l(!0)).map((e=>e.ref)),t=await Re((()=>fetch(`${window.location.origin}/regions/export`,{method:"POST",headers:{"X-CSRFToken":CSRF_TOKEN},body:JSON.stringify({regionsRef:e})})));!function(e,t){const n=window.URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=`${t}`,document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(n),document.body.removeChild(r)}(await t.blob(),"regions.zip")},h,$,r,l,c,a,()=>b(),()=>location.reload()]}class _t extends xe{constructor(e){super(),ke(this,e,Nt,Ot,o,{appLang:0,manifest:1,isValidated:11,regionsType:12})}}const Tt=function(){const e=`${window.location.origin}${window.location.pathname}`,t=Ce(1),n=Ce({}),r=Ce([]),i=Ce([]),s=Ce({}),o=Ce(JSON.parse(localStorage.getItem("selectedRegions"))||{}),l=(async()=>{const t=await fetch(`${e}similar-regions`).then((e=>e.json())).then((e=>(n.set(e),e))).catch((e=>console.error("Error:",e))),i=await fetch(`${e}query-images`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":CSRF_TOKEN},body:JSON.stringify({regionsRefs:Object.keys(t)})}).then((e=>e.json())).then((e=>0!==e.length&&e?(r.set(e),e):null)).catch((e=>console.error("Error:",e)));return g(c()),i})(),c=()=>{if("undefined"!=typeof window){const e=parseInt(new URLSearchParams(window.location.search).get("sp"));if(!isNaN(e))return t.set(e),e}return t.set(1),1},a=Se(t,(e=>(async()=>function(e){const t=50*(e-1),n=t+50,s=u(r).slice(t,n);return i.set(s),s}(e))())),d=Se(o,(e=>(async()=>await p(e))())),p=async t=>{const n=await fetch(`${e}similarity-page`,{method:"POST",body:JSON.stringify({regionsIds:Object.values(t).map((e=>e.id)),pageImgs:u(i)}),headers:{"Content-Type":"application/json","X-CSRFToken":CSRF_TOKEN}}),r=await n.json();return s.set(r),r};function g(e){if(t.set(e),"undefined"!=typeof window){const t=new URL(window.location.href);t.searchParams.set("sp",e),window.history.pushState({},"",t)}}function f(e){localStorage.setItem("selectedRegions",JSON.stringify(e))}const m=Se(o,(e=>t=>e.hasOwnProperty(t)));return{currentPage:t,comparedRegions:n,qImgs:r,pageQImgs:i,pageSImgs:s,selectedRegions:o,fetchSimilarity:l,setPageQImgs:a,setPageSImgs:d,getSimilarImgs:function(e){const t=u(s);return t.hasOwnProperty(e)?t[e]:[]},getRegionsInfo:function(e){const t=u(n),r=Object.keys(t).filter((t=>t.startsWith(e)));return 1!==r.length?{title:"Error"}:t[r[0]]},handlePageUpdate:g,unselect:function(e){o.update((t=>{const n={...t};return delete n[e],f(n),n}))},select:function(e){o.update((t=>{const n={...t,[e.ref]:e};return f(n),n}))},isSelected:m,addCategory:function(e,t){}}}();function Mt(e){let t,n,r;const i=e[1].default,s=p(i,e,e[0],null);return{c(){t=R("table"),n=R("tbody"),s&&s.c(),T(t,"class","table is-fullwidth")},m(e,i){C(e,t,i),k(t,n),s&&s.m(n,null),r=!0},p(e,[t]){s&&s.p&&(!r||1&t)&&m(s,i,e,e[0],r?f(i,e[0],t,null):h(e[0]),null)},i(e){r||(ue(s,e),r=!0)},o(e){de(s,e),r=!1},d(e){e&&S(t),s&&s.d(e)}}}function At(e,t,n){let{$$slots:r={},$$scope:i}=t;return e.$$set=e=>{"$$scope"in e&&n(0,i=e.$$scope)},[i,r]}class Vt extends xe{constructor(e){super(),ke(this,e,At,Mt,o,{})}}function zt(e){let t,n,r,i,s,o,l,a,u,d;const g=e[2].default,$=p(g,e,e[1],null);return{c(){t=R("tr"),n=R("th"),r=R("div"),i=R("img"),o=O(),l=R("td"),a=R("div"),u=R("div"),$&&$.c(),c(i.src,s=Pe(e[0],"full","250,"))||T(i,"src",s),T(i,"alt","Query region"),T(i,"class","mb-3 card"),T(r,"class","content-wrapper py-5"),T(n,"class","is-3 center-flex is-narrow"),A(n,"width","260px"),T(u,"class","grid is-gap-2"),T(a,"class","fixed-grid has-5-cols"),T(l,"class","p-5 is-fullwidth")},m(e,s){C(e,t,s),k(t,n),k(n,r),k(r,i),k(t,o),k(t,l),k(l,a),k(a,u),$&&$.m(u,null),d=!0},p(e,[t]){(!d||1&t&&!c(i.src,s=Pe(e[0],"full","250,")))&&T(i,"src",s),$&&$.p&&(!d||2&t)&&m($,g,e,e[1],d?f(g,e[1],t,null):h(e[1]),null)},i(e){d||(ue($,e),d=!0)},o(e){de($,e),d=!1},d(e){e&&S(t),$&&$.d(e)}}}function qt(e,t,n){let{$$slots:r={},$$scope:i}=t,{qImg:s}=t;return e.$$set=e=>{"qImg"in e&&n(0,s=e.qImg),"$$scope"in e&&n(1,i=e.$$scope)},[s,i,r]}class Ut extends xe{constructor(e){super(),ke(this,e,qt,zt,o,{qImg:0})}}function Bt(e){let t,n,r,s,o,l,a,u,d,p,g,f,m,h,$,b,w,v,y,x,L,I,E,j,_,M,A,V,z,q,U,B,H,D,F,J,X,K,Q,G,Z,W,ee,te,ne,re,ie,se,oe,le,ce,ae,ue;return{c(){t=R("div"),n=R("figure"),r=R("img"),o=O(),l=R("div"),a=R("span"),a.textContent=`${Tt.getRegionsInfo(`${e[1]}_${e[2]}`).title}`,u=O(),d=R("div"),p=R("span"),g=P("svg"),f=P("rect"),m=P("rect"),h=P("rect"),b=O(),w=R("span"),v=P("svg"),y=P("rect"),x=P("rect"),L=P("path"),I=P("path"),E=P("path"),j=P("path"),_=P("path"),M=P("path"),A=P("path"),V=P("path"),z=P("path"),U=O(),B=R("span"),H=P("svg"),D=P("rect"),F=P("rect"),X=O(),K=R("span"),Q=P("svg"),G=P("rect"),Z=P("path"),W=P("path"),te=O(),ne=R("span"),re=P("svg"),ie=P("rect"),se=P("path"),c(r.src,s=Pe(e[4],e[3],",256"))||T(r,"src",s),T(r,"alt","Similar region"),T(r,"class","svelte-yzaev0"),T(a,"class","overlay-desc"),T(l,"class","overlay is-center svelte-yzaev0"),T(n,"class","image region-image card svelte-yzaev0"),T(n,"tabindex","-1"),T(f,"x","30"),T(f,"y","30.62"),T(f,"width","55.71"),T(f,"height","55.71"),T(f,"rx","5.01"),T(f,"ry","5.01"),T(f,"fill","none"),T(f,"stroke","currentColor"),T(f,"stroke-width","3"),T(m,"x","21"),T(m,"y","21"),T(m,"width","55.71"),T(m,"height","55.71"),T(m,"rx","5.01"),T(m,"ry","5.01"),T(m,"fill","none"),T(m,"stroke","currentColor"),T(m,"stroke-width","3"),T(h,"x","30"),T(h,"y","30.62"),T(h,"width","46"),T(h,"height","45.71"),T(h,"rx","4.11"),T(h,"ry","4.11"),T(h,"fill","currentColor"),T(h,"stroke","none"),T(g,"xmlns","http://www.w3.org/2000/svg"),T(g,"viewBox","0 0 54 54.5"),T(g,"class","svelte-yzaev0"),T(p,"class","tag is-hoverable pl-5 pr-4 py-4"),T(p,"title",$="en"===e[0]?"Exact match":"Correspondance exacte"),T(y,"x","32"),T(y,"y","32.43"),T(y,"width","55.71"),T(y,"height","55.71"),T(y,"rx","5.01"),T(y,"ry","5.01"),T(y,"fill","none"),T(y,"stroke","currentColor"),T(y,"stroke-width","3"),T(y,"pointer-events","all"),T(x,"x","21"),T(x,"y","20.81"),T(x,"width","55.71"),T(x,"height","55.71"),T(x,"rx","5.01"),T(x,"ry","5.01"),T(x,"fill","none"),T(x,"stroke","currentColor"),T(x,"stroke-width","3"),T(x,"pointer-events","all"),T(L,"d","M 32 41.43 L 41 32.43"),T(L,"fill","none"),T(L,"stroke","currentColor"),T(L,"stroke-width","3"),T(L,"stroke-miterlimit","10"),T(I,"d","M 32 50 L 50 32.43"),T(I,"fill","none"),T(I,"stroke","currentColor"),T(I,"stroke-width","3"),T(I,"stroke-miterlimit","10"),T(E,"d","M 60 76 L 77 58"),T(E,"fill","none"),T(E,"stroke","currentColor"),T(E,"stroke-width","3"),T(E,"stroke-miterlimit","10"),T(j,"d","M 68.3 76.29 L 77 67"),T(j,"fill","none"),T(j,"stroke","currentColor"),T(j,"stroke-width","3"),T(j,"stroke-miterlimit","10"),T(_,"d","M 32 59 L 59 32"),T(_,"fill","none"),T(_,"stroke","currentColor"),T(_,"stroke-width","3"),T(_,"stroke-miterlimit","10"),T(M,"d","M 32 68 L 68 32"),T(M,"fill","none"),T(M,"stroke","currentColor"),T(M,"stroke-width","3"),T(M,"stroke-miterlimit","10"),T(A,"d","M 33 76 L 77 32"),T(A,"fill","none"),T(A,"stroke","currentColor"),T(A,"stroke-width","3"),T(A,"stroke-miterlimit","10"),T(V,"d","M 51 76 L 77 49"),T(V,"fill","none"),T(V,"stroke","currentColor"),T(V,"stroke-width","3"),T(V,"stroke-miterlimit","10"),T(z,"d","M 41 77 L 77 41"),T(z,"fill","none"),T(z,"stroke","currentColor"),T(z,"stroke-width","3"),T(z,"stroke-miterlimit","10"),T(v,"xmlns","http://www.w3.org/2000/svg"),T(v,"viewBox","0 0 55 55.5"),T(v,"class","svelte-yzaev0"),T(w,"class","tag is-hoverable px-4 py-4"),T(w,"title",q="en"===e[0]?"Partial match":"Correspondance partielle"),T(D,"x","34"),T(D,"y","34.43"),T(D,"width","55.71"),T(D,"height","55.71"),T(D,"rx","5.01"),T(D,"ry","5.01"),T(D,"fill","none"),T(D,"stroke","currentColor"),T(D,"stroke-width","3"),T(D,"stroke-dasharray","9 9"),T(F,"x","21"),T(F,"y","20.81"),T(F,"width","55.71"),T(F,"height","55.71"),T(F,"rx","5.01"),T(F,"ry","5.01"),T(F,"fill","none"),T(F,"stroke","currentColor"),T(F,"stroke-width","3"),T(H,"xmlns","http://www.w3.org/2000/svg"),T(H,"viewBox","0 0 56 56.5"),T(H,"class","svelte-yzaev0"),T(B,"class","tag is-hoverable px-4 py-4"),T(B,"title",J="en"===e[0]?"Semantic match":"Correspondance sémantique"),T(G,"x","21"),T(G,"y","20.62"),T(G,"width","55.71"),T(G,"height","55.71"),T(G,"rx","5.01"),T(G,"ry","5.01"),T(G,"fill","none"),T(G,"stroke","currentColor"),T(G,"stroke-width","3"),T(Z,"d","M 22.67 74.55 L 75 22"),T(Z,"fill","none"),T(Z,"stroke","currentColor"),T(Z,"stroke-width","3"),T(Z,"stroke-miterlimit","10"),T(W,"d","M 74.37 74.05 L 22.72 22.24"),T(W,"fill","none"),T(W,"stroke","currentColor"),T(W,"stroke-width","3"),T(W,"stroke-miterlimit","10"),T(Q,"xmlns","http://www.w3.org/2000/svg"),T(Q,"viewBox","0 0 49.5 49.5"),T(Q,"class","svelte-yzaev0"),T(K,"class","tag is-hoverable px-4 py-4"),T(K,"title",ee="en"===e[0]?"No match":"Aucune correspondance"),T(ie,"x","21"),T(ie,"y","20.81"),T(ie,"width","55.71"),T(ie,"height","55.71"),T(ie,"rx","5.01"),T(ie,"ry","5.01"),T(ie,"fill","none"),T(ie,"stroke","currentColor"),T(ie,"stroke-width","3"),T(se,"d","M 28.69 75.28 C 29.25 64.15 38.08 55.28 48.86 55.28 C 52.5 55.28 56.07 56.3 59.18 58.25 C 64.96 61.85 68.66 68.3 69.02 75.28 Z M 37.85 41.48 C 37.85 35.37 42.79 30.39 48.86 30.39 C 54.92 30.39 59.86 35.37 59.86 41.48 C 59.86 47.59 54.92 52.56 48.86 52.56 C 42.79 52.56 37.85 47.59 37.85 41.48 Z M 60.37 56.34 C 58.43 55.13 56.32 54.25 54.13 53.7 C 58.82 51.64 62.1 46.94 62.1 41.48 C 62.1 34.13 56.16 28.15 48.86 28.15 C 41.55 28.15 35.61 34.13 35.61 41.48 C 35.61 46.95 38.9 51.66 43.6 53.71 C 33.76 56.18 26.41 65.4 26.41 76.4 C 26.41 77.02 26.92 77.52 27.54 77.52 L 70.17 77.52 C 70.79 77.52 71.3 77.02 71.3 76.4 C 71.3 68.23 67.11 60.54 60.37 56.34 Z"),T(se,"fill","currentColor"),T(se,"stroke","none"),T(re,"xmlns","http://www.w3.org/2000/svg"),T(re,"viewBox","0 0 49.5 49.5"),T(re,"class","svelte-yzaev0"),T(ne,"class","tag is-hoverable pl-4 pr-5 py-4"),T(ne,"title",oe="en"===e[0]?"User match":"Correspondance utilisateur"),T(d,"class","tags has-addons is-dark is-center"),T(t,"class","region is-center svelte-yzaev0")},m(i,s){C(i,t,s),k(t,n),k(n,r),k(n,o),k(n,l),k(l,a),k(t,u),k(t,d),k(d,p),k(p,g),k(g,f),k(g,m),k(g,h),k(d,b),k(d,w),k(w,v),k(v,y),k(v,x),k(v,L),k(v,I),k(v,E),k(v,j),k(v,_),k(v,M),k(v,A),k(v,V),k(v,z),k(d,U),k(d,B),k(B,H),k(H,D),k(H,F),k(d,X),k(d,K),k(K,Q),k(Q,G),k(Q,Z),k(Q,W),k(d,te),k(d,ne),k(ne,re),k(re,ie),k(re,se),ce=!0,ae||(ue=[N(p,"click",e[6]),N(p,"keyup",null),N(w,"click",e[7]),N(w,"keyup",null),N(B,"click",e[8]),N(B,"keyup",null),N(K,"click",e[9]),N(K,"keyup",null),N(ne,"click",e[10]),N(ne,"keyup",null)],ae=!0)},p(e,[t]){(!ce||1&t&&$!==($="en"===e[0]?"Exact match":"Correspondance exacte"))&&T(p,"title",$),(!ce||1&t&&q!==(q="en"===e[0]?"Partial match":"Correspondance partielle"))&&T(w,"title",q),(!ce||1&t&&J!==(J="en"===e[0]?"Semantic match":"Correspondance sémantique"))&&T(B,"title",J),(!ce||1&t&&ee!==(ee="en"===e[0]?"No match":"Aucune correspondance"))&&T(K,"title",ee),(!ce||1&t&&oe!==(oe="en"===e[0]?"User match":"Correspondance utilisateur"))&&T(ne,"title",oe)},i(e){ce||(Y((()=>{ce&&(le||(le=ge(t,Te,{duration:500},!0)),le.run(1))})),ce=!0)},o(e){le||(le=ge(t,Te,{duration:500},!1)),le.run(0),ce=!1},d(e){e&&S(t),e&&le&&le.end(),ae=!1,i(ue)}}}function Ht(e,t,n){let{appLang:r="en"}=t,{sImg:i}=t;const[s,o,l,c]=i.split(".")[0].split("_"),a=`${s}_${o}_${l}`;return e.$$set=e=>{"appLang"in e&&n(0,r=e.appLang),"sImg"in e&&n(5,i=e.sImg)},[r,s,o,c,a,i,()=>Tt.addCategory(1),()=>Tt.addCategory(2),()=>Tt.addCategory(3),()=>Tt.addCategory(4),()=>Tt.addCategory(5)]}class Dt extends xe{constructor(e){super(),ke(this,e,Ht,Bt,o,{appLang:0,sImg:5})}}function Ft(e,t,n){const r=e.slice();return r[5]=t[n][0],r[6]=t[n][1],r}function Jt(t){let n,r,i,s=t[9]+"";return{c(){n=R("div"),r=E("Error when retrieving similar regions: "),i=E(s),T(n,"class","faded is-center")},m(e,t){C(e,n,t),k(n,r),k(n,i)},p(e,t){4&t&&s!==(s=e[9]+"")&&M(i,s)},i:e,o:e,d(e){e&&S(n)}}}function Xt(e){let t,n,r=Tt.getSimilarImgs(e[1]),i=[];for(let t=0;t<r.length;t+=1)i[t]=Kt(Ft(e,r,t));const s=e=>de(i[e],1,1,(()=>{i[e]=null}));return{c(){for(let e=0;e<i.length;e+=1)i[e].c();t=j()},m(e,r){for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(e,r);C(e,t,r),n=!0},p(e,n){if(3&n){let o;for(r=Tt.getSimilarImgs(e[1]),o=0;o<r.length;o+=1){const s=Ft(e,r,o);i[o]?(i[o].p(s,n),ue(i[o],1)):(i[o]=Kt(s),i[o].c(),ue(i[o],1),i[o].m(t.parentNode,t))}for(ce(),o=r.length;o<i.length;o+=1)s(o);ae()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)ue(i[e]);n=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)de(i[e]);n=!1},d(e){I(i,e),e&&S(t)}}}function Kt(e){let t,n;return t=new Dt({props:{sImg:e[5],score:e[6],appLang:e[0]}}),{c(){be(t.$$.fragment)},m(e,r){we(t,e,r),n=!0},p(e,n){const r={};2&n&&(r.sImg=e[5]),2&n&&(r.score=e[6]),1&n&&(r.appLang=e[0]),t.$set(r)},i(e){n||(ue(t.$$.fragment,e),n=!0)},o(e){de(t.$$.fragment,e),n=!1},d(e){ve(t,e)}}}function Qt(t){let n,r,i="en"===t[0]?"Retrieving similar regions...":"Récupération des régions similaires...";return{c(){n=R("div"),r=E(i),T(n,"class","faded is-center")},m(e,t){C(e,n,t),k(n,r)},p(e,t){1&t&&i!==(i="en"===e[0]?"Retrieving similar regions...":"Récupération des régions similaires...")&&M(r,i)},i:e,o:e,d(e){e&&S(n)}}}function Gt(e){let t,n,r,i={ctx:e,current:null,token:null,hasCatch:!0,pending:Qt,then:Xt,catch:Jt,value:4,error:9,blocks:[,,,]};return fe(n=e[2],i),{c(){t=j(),i.block.c()},m(e,n){C(e,t,n),i.block.m(e,i.anchor=n),i.mount=()=>t.parentNode,i.anchor=t,r=!0},p(t,[r]){e=t,i.ctx=e,4&r&&n!==(n=e[2])&&fe(n,i)||me(i,e,r)},i(e){r||(ue(i.block),r=!0)},o(e){for(let e=0;e<3;e+=1){de(i.blocks[e])}r=!1},d(e){e&&S(t),i.block.d(e),i.token=null,i=null}}}function Zt(e,t,n){let r;const{setPageSImgs:i}=Tt;d(e,i,(e=>n(2,r=e)));let{appLang:s="en"}=t,{qImg:o}=t;return e.$$set=e=>{"appLang"in e&&n(0,s=e.appLang),"qImg"in e&&n(1,o=e.qImg)},[s,o,r,i]}class Wt extends xe{constructor(e){super(),ke(this,e,Zt,Gt,o,{appLang:0,qImg:1})}}function Yt(e,t,n){const r=e.slice();return r[8]=t[n],r}function en(t){let n,r,i,s=t[11]+"";return{c(){n=R("tr"),r=E("Error when retrieving similar regions: "),i=E(s)},m(e,t){C(e,n,t),k(n,r),k(n,i)},p(e,t){4&t&&s!==(s=e[11]+"")&&M(i,s)},i:e,o:e,d(e){e&&S(n)}}}function tn(e){let t,n,r=[],i=new Map,s=e[3];const o=e=>e[8].id;for(let t=0;t<s.length;t+=1){let n=Yt(e,s,t),l=o(n);i.set(l,r[t]=sn(l,n))}let l=null;return s.length||(l=nn(e)),{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=j(),l&&l.c()},m(e,i){for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,i);C(e,t,i),l&&l.m(e,i),n=!0},p(e,n){9&n&&(s=e[3],ce(),r=$e(r,n,o,1,e,s,i,t.parentNode,he,sn,t,Yt),ae(),!s.length&&l?l.p(e,n):s.length?l&&(l.d(1),l=null):(l=nn(e),l.c(),l.m(t.parentNode,t)))},i(e){if(!n){for(let e=0;e<s.length;e+=1)ue(r[e]);n=!0}},o(e){for(let e=0;e<r.length;e+=1)de(r[e]);n=!1},d(e){for(let t=0;t<r.length;t+=1)r[t].d(e);e&&S(t),l&&l.d(e)}}}function nn(e){let t,n,r,i="en"===e[0]?"No similarity":"Pas de similarités";return{c(){t=R("tr"),n=E(i),r=O(),T(t,"class","faded is-center")},m(e,i){C(e,t,i),k(t,n),C(e,r,i)},p(e,t){1&t&&i!==(i="en"===e[0]?"No similarity":"Pas de similarités")&&M(n,i)},d(e){e&&S(t),e&&S(r)}}}function rn(e){let t,n,r;return t=new Wt({props:{qImg:e[8],appLang:e[0]}}),{c(){be(t.$$.fragment),n=O()},m(e,i){we(t,e,i),C(e,n,i),r=!0},p(e,n){const r={};8&n&&(r.qImg=e[8]),1&n&&(r.appLang=e[0]),t.$set(r)},i(e){r||(ue(t.$$.fragment,e),r=!0)},o(e){de(t.$$.fragment,e),r=!1},d(e){ve(t,e),e&&S(n)}}}function sn(e,t){let n,r,i;return r=new Ut({props:{qImg:t[8],appLang:t[0],$$slots:{default:[rn]},$$scope:{ctx:t}}}),{key:e,first:null,c(){n=j(),be(r.$$.fragment),this.first=n},m(e,t){C(e,n,t),we(r,e,t),i=!0},p(e,n){t=e;const i={};8&n&&(i.qImg=t[8]),1&n&&(i.appLang=t[0]),4105&n&&(i.$$scope={dirty:n,ctx:t}),r.$set(i)},i(e){i||(ue(r.$$.fragment,e),i=!0)},o(e){de(r.$$.fragment,e),i=!1},d(e){e&&S(n),ve(r,e)}}}function on(t){let n,r,i="en"===t[0]?"Retrieving similarity page...":"Récupération la page de similarité...";return{c(){n=R("tr"),r=E(i),T(n,"class","faded is-center")},m(e,t){C(e,n,t),k(n,r)},p(e,t){1&t&&i!==(i="en"===e[0]?"Retrieving similarity page...":"Récupération la page de similarité...")&&M(r,i)},i:e,o:e,d(e){e&&S(n)}}}function ln(e){let t,n,r,i={ctx:e,current:null,token:null,hasCatch:!0,pending:on,then:tn,catch:en,value:7,error:11,blocks:[,,,]};return fe(n=e[2],i),{c(){t=j(),i.block.c()},m(e,n){C(e,t,n),i.block.m(e,i.anchor=n),i.mount=()=>t.parentNode,i.anchor=t,r=!0},p(t,r){e=t,i.ctx=e,4&r&&n!==(n=e[2])&&fe(n,i)||me(i,e,r)},i(e){r||(ue(i.block),r=!0)},o(e){for(let e=0;e<3;e+=1){de(i.blocks[e])}r=!1},d(e){e&&S(t),i.block.d(e),i.token=null,i=null}}}function cn(e){let t,n,r,i;return t=new at({props:{store:Tt,nbOfItems:e[1].length}}),r=new Vt({props:{$$slots:{default:[ln]},$$scope:{ctx:e}}}),{c(){be(t.$$.fragment),n=O(),be(r.$$.fragment)},m(e,s){we(t,e,s),C(e,n,s),we(r,e,s),i=!0},p(e,[n]){const i={};2&n&&(i.nbOfItems=e[1].length),t.$set(i);const s={};4109&n&&(s.$$scope={dirty:n,ctx:e}),r.$set(s)},i(e){i||(ue(t.$$.fragment,e),ue(r.$$.fragment,e),i=!0)},o(e){de(t.$$.fragment,e),de(r.$$.fragment,e),i=!1},d(e){ve(t,e),e&&S(n),ve(r,e)}}}function an(e,t,n){let r,i,s;const{qImgs:o,pageQImgs:l,setPageQImgs:c}=Tt;d(e,o,(e=>n(1,r=e))),d(e,l,(e=>n(3,s=e))),d(e,c,(e=>n(2,i=e)));let{appLang:a="en"}=t;return e.$$set=e=>{"appLang"in e&&n(0,a=e.appLang)},[a,r,i,s,o,l,c]}class un extends xe{constructor(e){super(),ke(this,e,an,cn,o,{appLang:0})}}function dn(e,t,n){const r=e.slice();return r[8]=t[n][0],r[9]=t[n][1],r}function pn(e){let t;return{c(){t=R("span"),t.textContent="current",T(t,"class","tag is-dark svelte-503e8j")},m(e,n){C(e,t,n)},d(e){e&&S(t)}}}function gn(e){let t,n,r,s,o,l,c,a,u=e[5](e[8]),d=e[9].title+"",p=u&&pn();function g(){return e[7](e[9])}return{c(){t=R("div"),p&&p.c(),n=O(),r=R("span"),s=E(d),l=O(),T(r,"class",o="tag is-small "+(e[0](e[8])?"is-link":"is-contrasted")+" svelte-503e8j"),T(t,"class","tags has-addons mb-0 is-hoverable")},m(e,i){C(e,t,i),p&&p.m(t,null),k(t,n),k(t,r),k(r,s),k(t,l),c||(a=[N(t,"click",g),N(t,"keyup",null)],c=!0)},p(i,l){e=i,2&l&&(u=e[5](e[8])),u?p||(p=pn(),p.c(),p.m(t,n)):p&&(p.d(1),p=null),2&l&&d!==(d=e[9].title+"")&&M(s,d),3&l&&o!==(o="tag is-small "+(e[0](e[8])?"is-link":"is-contrasted")+" svelte-503e8j")&&T(r,"class",o)},d(e){e&&S(t),p&&p.d(),c=!1,i(a)}}}function fn(t){let n,r=Object.entries(t[1]),i=[];for(let e=0;e<r.length;e+=1)i[e]=gn(dn(t,r,e));return{c(){n=R("div");for(let e=0;e<i.length;e+=1)i[e].c();T(n,"class","field is-grouped is-grouped-multiline")},m(e,t){C(e,n,t);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(n,null)},p(e,[t]){if(51&t){let s;for(r=Object.entries(e[1]),s=0;s<r.length;s+=1){const o=dn(e,r,s);i[s]?i[s].p(o,t):(i[s]=gn(o),i[s].c(),i[s].m(n,null))}for(;s<i.length;s+=1)i[s].d(1);i.length=r.length}},i:e,o:e,d(e){e&&S(n),I(i,e)}}}function mn(e,t,n){let r,i;const{comparedRegions:s,isSelected:o}=Tt;d(e,s,(e=>n(1,i=e))),d(e,o,(e=>n(0,r=e)));let{imgPrefix:l=""}=t;function c(e){r(e.ref)?Tt.unselect(e.ref):Tt.select(e)}return e.$$set=e=>{"imgPrefix"in e&&n(6,l=e.imgPrefix)},[r,i,s,o,c,function(e){return e.startsWith(l)},l,e=>c(e)]}class hn extends xe{constructor(e){super(),ke(this,e,mn,fn,o,{imgPrefix:6})}}function $n(e){let t,n;return t=new Vt({props:{$$slots:{default:[bn]},$$scope:{ctx:e}}}),{c(){be(t.$$.fragment)},m(e,r){we(t,e,r),n=!0},p(e,n){const r={};32&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(ue(t.$$.fragment,e),n=!0)},o(e){de(t.$$.fragment,e),n=!1},d(e){ve(t,e)}}}function bn(t){let n,r,i,s=t[4]+"";return{c(){n=R("tr"),r=E("Error when retrieving similarities: "),i=E(s),T(n,"class","faded is-center")},m(e,t){C(e,n,t),k(n,r),k(n,i)},p:e,d(e){e&&S(n)}}}function wn(e){let t,n,r,i;return t=new hn({props:{appLang:e[0],imgPrefix:e[1]}}),r=new un({props:{appLang:e[0]}}),{c(){be(t.$$.fragment),n=O(),be(r.$$.fragment)},m(e,s){we(t,e,s),C(e,n,s),we(r,e,s),i=!0},p(e,n){const i={};1&n&&(i.appLang=e[0]),2&n&&(i.imgPrefix=e[1]),t.$set(i);const s={};1&n&&(s.appLang=e[0]),r.$set(s)},i(e){i||(ue(t.$$.fragment,e),ue(r.$$.fragment,e),i=!0)},o(e){de(t.$$.fragment,e),de(r.$$.fragment,e),i=!1},d(e){ve(t,e),e&&S(n),ve(r,e)}}}function vn(e){let t,n;return t=new Vt({props:{$$slots:{default:[yn]},$$scope:{ctx:e}}}),{c(){be(t.$$.fragment)},m(e,r){we(t,e,r),n=!0},p(e,n){const r={};33&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(ue(t.$$.fragment,e),n=!0)},o(e){de(t.$$.fragment,e),n=!1},d(e){ve(t,e)}}}function yn(e){let t,n,r="en"===e[0]?"Retrieving similarities...":"Récupération des similarités...";return{c(){t=R("tr"),n=E(r),T(t,"class","faded is-center")},m(e,r){C(e,t,r),k(t,n)},p(e,t){1&t&&r!==(r="en"===e[0]?"Retrieving similarities...":"Récupération des similarités...")&&M(n,r)},d(e){e&&S(t)}}}function kn(e){let t,n,r={ctx:e,current:null,token:null,hasCatch:!0,pending:vn,then:wn,catch:$n,value:3,error:4,blocks:[,,,]};return fe(e[2],r),{c(){t=j(),r.block.c()},m(e,i){C(e,t,i),r.block.m(e,r.anchor=i),r.mount=()=>t.parentNode,r.anchor=t,n=!0},p(t,[n]){me(r,e=t,n)},i(e){n||(ue(r.block),n=!0)},o(e){for(let e=0;e<3;e+=1){de(r.blocks[e])}n=!1},d(e){e&&S(t),r.block.d(e),r.token=null,r=null}}}function xn(e,t,n){const{fetchSimilarity:r}=Tt;let{appLang:i="en"}=t,{imgPrefix:s=""}=t;return e.$$set=e=>{"appLang"in e&&n(0,i=e.appLang),"imgPrefix"in e&&n(1,s=e.imgPrefix)},[i,s,r]}class Ln extends xe{constructor(e){super(),ke(this,e,xn,kn,o,{appLang:0,imgPrefix:1})}}function Cn(e,t,n){const r=e.slice();return r[33]=t[n][0],r[34]=t[n][1],r}function Sn(e,t,n){const r=e.slice();return r[42]=t[n][0],r[43]=t[n][1],r}function In(e,t,n){const r=e.slice();return r[38]=t[n],r}function Rn(e,t,n){const r=e.slice();return r[38]=t[n],r}function Pn(e,t,n){const r=e.slice();return r[48]=t[n][0],r[34]=t[n][1],r}function En(e){let t,n,r,s,o,l,c=e[34].text+"";function a(){return e[30](e[48])}return{c(){t=R("li"),n=R("a"),r=E(c),s=O(),T(n,"href",null),V(t,"is-active",e[48]===e[12])},m(e,i){C(e,t,i),k(t,n),k(n,r),k(t,s),o||(l=[N(t,"click",a),N(t,"keyup",Yn)],o=!0)},p(n,i){e=n,1024&i[0]&&c!==(c=e[34].text+"")&&M(r,c),5120&i[0]&&V(t,"is-active",e[48]===e[12])},d(e){e&&S(t),o=!1,i(l)}}}function On(t){let n;return{c(){n=R("div"),n.textContent="tout doux"},m(e,t){C(e,n,t)},p:e,i:e,o:e,d(e){e&&S(n)}}}function jn(e){let t,n;return t=new Ln({props:{appLang:e[1],imgPrefix:e[4]}}),{c(){be(t.$$.fragment)},m(e,r){we(t,e,r),n=!0},p(e,n){const r={};2&n[0]&&(r.appLang=e[1]),16&n[0]&&(r.imgPrefix=e[4]),t.$set(r)},i(e){n||(ue(t.$$.fragment,e),n=!0)},o(e){de(t.$$.fragment,e),n=!1},d(e){ve(t,e)}}}function Nn(e){let t,n,r,i;return t=new at({props:{store:_e,nbOfItems:e[5]}}),r=new Vt({props:{$$slots:{default:[Hn]},$$scope:{ctx:e}}}),{c(){be(t.$$.fragment),n=O(),be(r.$$.fragment)},m(e,s){we(t,e,s),C(e,n,s),we(r,e,s),i=!0},p(e,n){const i={};32&n[0]&&(i.nbOfItems=e[5]),t.$set(i);const s={};198854&n[0]|1048576&n[1]&&(s.$$scope={dirty:n,ctx:e}),r.$set(s)},i(e){i||(ue(t.$$.fragment,e),ue(r.$$.fragment,e),i=!0)},o(e){de(t.$$.fragment,e),de(r.$$.fragment,e),i=!1},d(e){ve(t,e),e&&S(n),ve(r,e)}}}function _n(e){let t,n,r={ctx:e,current:null,token:null,hasCatch:!0,pending:Kn,then:Fn,catch:Dn,value:37,error:41,blocks:[,,,]};return fe(e[20],r),{c(){t=R("div"),r.block.c(),T(t,"class","grid is-gap-2")},m(e,i){C(e,t,i),r.block.m(t,r.anchor=null),r.mount=()=>t,r.anchor=null,n=!0},p(t,n){me(r,e=t,n)},i(e){n||(ue(r.block),n=!0)},o(e){for(let e=0;e<3;e+=1){de(r.blocks[e])}n=!1},d(e){e&&S(t),r.block.d(),r.token=null,r=null}}}function Tn(t){let n,r,i,s=t[41]+"";return{c(){n=R("tr"),r=E("Error when retrieving paginated regions: "),i=E(s)},m(e,t){C(e,n,t),k(n,r),k(n,i)},p(e,t){65536&t[0]&&s!==(s=e[41]+"")&&M(i,s)},i:e,o:e,d(e){e&&S(n)}}}function Mn(e){let t,n,r,i,s;const o=[Vn,An],l=[];function c(e,n){return 131072&n[0]&&(t=null),null==t&&(t=!!(Object.values(e[17]).length>0)),t?0:1}return n=c(e,[-1,-1]),r=l[n]=o[n](e),{c(){r.c(),i=j()},m(e,t){l[n].m(e,t),C(e,i,t),s=!0},p(e,t){let s=n;n=c(e,t),n===s?l[n].p(e,t):(ce(),de(l[s],1,1,(()=>{l[s]=null})),ae(),r=l[n],r?r.p(e,t):(r=l[n]=o[n](e),r.c()),ue(r,1),r.m(i.parentNode,i))},i(e){s||(ue(r),s=!0)},o(e){de(r),s=!1},d(e){l[n].d(e),e&&S(i)}}}function An(e){let t,n,r;return n=new ht({props:{appLang:e[1],modules:e[6],witness:e[7]}}),{c(){t=R("tr"),be(n.$$.fragment)},m(e,i){C(e,t,i),we(n,t,null),r=!0},p(e,t){const r={};2&t[0]&&(r.appLang=e[1]),64&t[0]&&(r.modules=e[6]),128&t[0]&&(r.witness=e[7]),n.$set(r)},i(e){r||(ue(n.$$.fragment,e),r=!0)},o(e){de(n.$$.fragment,e),r=!1},d(e){e&&S(t),ve(n)}}}function Vn(e){let t,n,r=Object.entries(e[17]),i=[];for(let t=0;t<r.length;t+=1)i[t]=Un(Sn(e,r,t));const s=e=>de(i[e],1,1,(()=>{i[e]=null}));return{c(){for(let e=0;e<i.length;e+=1)i[e].c();t=j()},m(e,r){for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(e,r);C(e,t,r),n=!0},p(e,n){if(167905286&n[0]){let o;for(r=Object.entries(e[17]),o=0;o<r.length;o+=1){const s=Sn(e,r,o);i[o]?(i[o].p(s,n),ue(i[o],1)):(i[o]=Un(s),i[o].c(),ue(i[o],1),i[o].m(t.parentNode,t))}for(ce(),o=r.length;o<i.length;o+=1)s(o);ae()}},i(e){if(!n){for(let e=0;e<r.length;e+=1)ue(i[e]);n=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)de(i[e]);n=!1},d(e){I(i,e),e&&S(t)}}}function zn(e,t){let n,r,i;return r=new Xe({props:{item:t[38],appLang:t[1],isSquare:!1,isCopied:t[11](t[38])}}),r.$on("copyRef",t[27]),{key:e,first:null,c(){n=j(),be(r.$$.fragment),this.first=n},m(e,t){C(e,n,t),we(r,e,t),i=!0},p(e,n){t=e;const i={};131072&n[0]&&(i.item=t[38]),2&n[0]&&(i.appLang=t[1]),133120&n[0]&&(i.isCopied=t[11](t[38])),r.$set(i)},i(e){i||(ue(r.$$.fragment,e),i=!0)},o(e){de(r.$$.fragment,e),i=!1},d(e){e&&S(n),ve(r,e)}}}function qn(e){let t,n,r=[],i=new Map,s=Object.values(e[43]);const o=e=>e[38].id;for(let t=0;t<s.length;t+=1){let n=In(e,s,t),l=o(n);i.set(l,r[t]=zn(l,n))}return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=O()},m(e,i){for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,i);C(e,t,i),n=!0},p(e,n){134350850&n[0]&&(s=Object.values(e[43]),ce(),r=$e(r,n,o,1,e,s,i,t.parentNode,he,zn,t,In),ae())},i(e){if(!n){for(let e=0;e<s.length;e+=1)ue(r[e]);n=!0}},o(e){for(let e=0;e<r.length;e+=1)de(r[e]);n=!1},d(e){for(let t=0;t<r.length;t+=1)r[t].d(e);e&&S(t)}}}function Un(e){let t,n;return t=new nt({props:{canvasImg:e[25](e[42]),canvasNb:e[42],manifest:e[2],$$slots:{default:[qn]},$$scope:{ctx:e}}}),{c(){be(t.$$.fragment)},m(e,r){we(t,e,r),n=!0},p(e,n){const r={};131072&n[0]&&(r.canvasImg=e[25](e[42])),131072&n[0]&&(r.canvasNb=e[42]),4&n[0]&&(r.manifest=e[2]),133122&n[0]|1048576&n[1]&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(ue(t.$$.fragment,e),n=!0)},o(e){de(t.$$.fragment,e),n=!1},d(e){ve(t,e)}}}function Bn(t){let n,r,i="en"===t[1]?"Retrieving paginated regions...":"Récupération des pages...";return{c(){n=R("tr"),r=E(i),T(n,"class","faded is-center")},m(e,t){C(e,n,t),k(n,r)},p(e,t){2&t[0]&&i!==(i="en"===e[1]?"Retrieving paginated regions...":"Récupération des pages...")&&M(r,i)},i:e,o:e,d(e){e&&S(n)}}}function Hn(e){let t,n,r,i={ctx:e,current:null,token:null,hasCatch:!0,pending:Bn,then:Mn,catch:Tn,value:37,error:41,blocks:[,,,]};return fe(n=e[16],i),{c(){t=j(),i.block.c()},m(e,n){C(e,t,n),i.block.m(e,i.anchor=n),i.mount=()=>t.parentNode,i.anchor=t,r=!0},p(t,r){e=t,i.ctx=e,65536&r[0]&&n!==(n=e[16])&&fe(n,i)||me(i,e,r)},i(e){r||(ue(i.block),r=!0)},o(e){for(let e=0;e<3;e+=1){de(i.blocks[e])}r=!1},d(e){e&&S(t),i.block.d(e),i.token=null,i=null}}}function Dn(t){let n,r,i,s=t[41]+"";return{c(){n=R("div"),r=E("Error when retrieving regions: "),i=E(s)},m(e,t){C(e,n,t),k(n,r),k(n,i)},p:e,i:e,o:e,d(e){e&&S(n)}}}function Fn(e){let t,n,r=[],i=new Map,s=Object.values(e[15]);const o=e=>e[38].id;for(let t=0;t<s.length;t+=1){let n=Rn(e,s,t),l=o(n);i.set(l,r[t]=Xn(l,n))}let l=null;return s.length||(l=Jn(e)),{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=j(),l&&l.c()},m(e,i){for(let t=0;t<r.length;t+=1)r[t]&&r[t].m(e,i);C(e,t,i),l&&l.m(e,i),n=!0},p(e,n){159418562&n[0]&&(s=Object.values(e[15]),ce(),r=$e(r,n,o,1,e,s,i,t.parentNode,he,Xn,t,Rn),ae(),!s.length&&l?l.p(e,n):s.length?l&&(ce(),de(l,1,1,(()=>{l=null})),ae()):(l=Jn(e),l.c(),ue(l,1),l.m(t.parentNode,t)))},i(e){if(!n){for(let e=0;e<s.length;e+=1)ue(r[e]);n=!0}},o(e){for(let e=0;e<r.length;e+=1)de(r[e]);n=!1},d(e){for(let t=0;t<r.length;t+=1)r[t].d(e);e&&S(t),l&&l.d(e)}}}function Jn(e){let t,n;return t=new ht({props:{appLang:e[1],modules:e[6],witness:e[7],currentRegionId:e[24],baseUrl:e[23]}}),{c(){be(t.$$.fragment)},m(e,r){we(t,e,r),n=!0},p(e,n){const r={};2&n[0]&&(r.appLang=e[1]),64&n[0]&&(r.modules=e[6]),128&n[0]&&(r.witness=e[7]),t.$set(r)},i(e){n||(ue(t.$$.fragment,e),n=!0)},o(e){de(t.$$.fragment,e),n=!1},d(e){ve(t,e)}}}function Xn(e,t){let n,r,i;return r=new Xe({props:{item:t[38],appLang:t[1],isCopied:t[11](t[38])}}),r.$on("copyRef",t[27]),{key:e,first:null,c(){n=j(),be(r.$$.fragment),this.first=n},m(e,t){C(e,n,t),we(r,e,t),i=!0},p(e,n){t=e;const i={};32768&n[0]&&(i.item=t[38]),2&n[0]&&(i.appLang=t[1]),34816&n[0]&&(i.isCopied=t[11](t[38])),r.$set(i)},i(e){i||(ue(r.$$.fragment,e),i=!0)},o(e){de(r.$$.fragment,e),i=!1},d(e){e&&S(n),ve(r,e)}}}function Kn(t){let n,r,i="en"===t[1]?"Retrieving regions...":"Récupération des régions...";return{c(){n=R("div"),r=E(i),T(n,"class","faded is-center")},m(e,t){C(e,n,t),k(n,r)},p(e,t){2&t[0]&&i!==(i="en"===e[1]?"Retrieving regions...":"Récupération des régions...")&&M(r,i)},i:e,o:e,d(e){e&&S(n)}}}function Qn(e){let t,n,r="en"===e[1]?"No regions in selection":"Aucune région sélectionnée";return{c(){t=R("div"),n=E(r)},m(e,r){C(e,t,r),k(t,n)},p(e,t){2&t[0]&&r!==(r="en"===e[1]?"No regions in selection":"Aucune région sélectionnée")&&M(n,r)},d(e){e&&S(t)}}}function Gn(e){let t,n,r=Object.entries(e[9]),i=[];for(let t=0;t<r.length;t+=1)i[t]=Zn(Cn(e,r,t));return{c(){t=R("div"),n=R("div");for(let e=0;e<i.length;e+=1)i[e].c();T(n,"class","grid is-gap-2"),T(t,"class","fixed-grid has-6-cols")},m(e,r){C(e,t,r),k(t,n);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(n,null)},p(e,t){if(513&t[0]){let s;for(r=Object.entries(e[9]),s=0;s<r.length;s+=1){const o=Cn(e,r,s);i[s]?i[s].p(o,t):(i[s]=Zn(o),i[s].c(),i[s].m(n,null))}for(;s<i.length;s+=1)i[s].d(1);i.length=r.length}},d(e){e&&S(t),I(i,e)}}}function Zn(e){let t,n,r,i,s,o,l,a,u,d,p,g,f,m=e[34].title+"";function h(){return e[31](e[33])}return{c(){t=R("div"),n=R("figure"),r=R("img"),s=O(),o=R("div"),l=R("span"),a=E(m),u=O(),d=R("button"),p=O(),c(r.src,i=Pe(e[34].img,e[34].xyhw,"96,"))||T(r,"src",i),T(r,"alt","Extracted region"),T(l,"class","overlay-desc"),T(o,"class","overlay is-center svelte-403wty"),T(n,"class","image is-64x64 card"),T(d,"class","delete region-btn"),T(d,"aria-label","remove from selection"),T(t,"class","selection cell svelte-403wty")},m(e,i){C(e,t,i),k(t,n),k(n,r),k(n,s),k(n,o),k(o,l),k(l,a),k(t,u),k(t,d),k(t,p),g||(f=N(d,"click",h),g=!0)},p(t,n){e=t,512&n[0]&&!c(r.src,i=Pe(e[34].img,e[34].xyhw,"96,"))&&T(r,"src",i),512&n[0]&&m!==(m=e[34].title+"")&&M(a,m)},d(e){e&&S(t),g=!1,f()}}}function Wn(e){let t,n,r,i,s,o,l,c,a,u,d,p,g,f,m,h,$,b,w,v,y,x,L,P,j,N,_,A,V,z,q,U,B,H,D,F,J,X,K,Q="en"===e[1]?"Selected regions":"Regions sélectionnées";t=new ze({props:{visible:e[14]}}),r=new pt({props:{appLang:e[1]}}),s=new Ge({props:{selectionLength:e[8],appLang:e[1]}}),u=new xt({props:{appLang:e[1],witness:e[7],baseUrl:e[23],currentRegionId:e[24]}}),g=new _t({props:{appLang:e[1],manifest:e[2],isValidated:e[3],regionsType:e[0]}});let G=Object.entries(e[10]),Z=[];for(let t=0;t<G.length;t+=1)Z[t]=En(Pn(e,G,t));const W=[_n,Nn,jn,On],Y=[];function ee(e,t){return"all"===e[12]?0:"page"===e[12]?1:"similarity"===e[12]?2:"vectorization"===e[12]?3:-1}function te(e,t){return e[13]?Gn:Qn}~(b=ee(e))&&(w=Y[b]=W[b](e));let ne=te(e),re=ne(e);return X=new Ye({props:{appLang:e[1],isRegion:!0}}),{c(){be(t.$$.fragment),n=O(),be(r.$$.fragment),i=O(),be(s.$$.fragment),o=O(),l=R("div"),c=R("div"),a=R("div"),be(u.$$.fragment),d=O(),p=R("div"),be(g.$$.fragment),f=O(),m=R("div"),h=R("ul");for(let e=0;e<Z.length;e+=1)Z[e].c();$=O(),w&&w.c(),v=O(),y=R("div"),x=R("div"),L=O(),P=R("div"),j=R("div"),N=R("div"),_=R("i"),A=O(),V=E(Q),z=E("\n                ("),q=E(e[8]),U=E(")"),B=O(),H=R("button"),D=O(),F=R("section"),re.c(),J=O(),be(X.$$.fragment),T(a,"class","cell is-right is-middle"),T(p,"class","cell"),T(c,"class","actions grid"),T(h,"class","panel-tabs"),T(m,"class","tabs is-centered"),T(l,"id","nav-actions"),T(l,"class","mb-5 svelte-403wty"),T(x,"class","modal-background"),T(_,"class","fa-solid fa-book-bookmark"),T(N,"class","title is-4 mb-0 media-content"),T(H,"class","delete media-left"),T(H,"aria-label","close"),T(j,"class","modal-card-head media mb-0"),T(F,"class","modal-card-body"),T(P,"class","modal-content"),T(y,"id","selection-modal"),T(y,"class","modal fade"),T(y,"tabindex","-1"),T(y,"aria-labelledby","selection-modal-label"),T(y,"aria-hidden","true")},m(e,w){we(t,e,w),C(e,n,w),we(r,e,w),C(e,i,w),we(s,e,w),C(e,o,w),C(e,l,w),k(l,c),k(c,a),we(u,a,null),k(c,d),k(c,p),we(g,p,null),k(l,f),k(l,m),k(m,h);for(let e=0;e<Z.length;e+=1)Z[e]&&Z[e].m(h,null);C(e,$,w),~b&&Y[b].m(e,w),C(e,v,w),C(e,y,w),k(y,x),k(y,L),k(y,P),k(P,j),k(j,N),k(N,_),k(N,A),k(N,V),k(N,z),k(N,q),k(N,U),k(j,B),k(j,H),k(P,D),k(P,F),re.m(F,null),k(P,J),we(X,P,null),K=!0},p(e,n){const i={};16384&n[0]&&(i.visible=e[14]),t.$set(i);const o={};2&n[0]&&(o.appLang=e[1]),r.$set(o);const l={};256&n[0]&&(l.selectionLength=e[8]),2&n[0]&&(l.appLang=e[1]),s.$set(l);const c={};2&n[0]&&(c.appLang=e[1]),128&n[0]&&(c.witness=e[7]),u.$set(c);const a={};if(2&n[0]&&(a.appLang=e[1]),4&n[0]&&(a.manifest=e[2]),8&n[0]&&(a.isValidated=e[3]),g.$set(a),67113984&n[0]){let t;for(G=Object.entries(e[10]),t=0;t<G.length;t+=1){const r=Pn(e,G,t);Z[t]?Z[t].p(r,n):(Z[t]=En(r),Z[t].c(),Z[t].m(h,null))}for(;t<Z.length;t+=1)Z[t].d(1);Z.length=G.length}let d=b;b=ee(e),b===d?~b&&Y[b].p(e,n):(w&&(ce(),de(Y[d],1,1,(()=>{Y[d]=null})),ae()),~b?(w=Y[b],w?w.p(e,n):(w=Y[b]=W[b](e),w.c()),ue(w,1),w.m(v.parentNode,v)):w=null),(!K||2&n[0])&&Q!==(Q="en"===e[1]?"Selected regions":"Regions sélectionnées")&&M(V,Q),(!K||256&n[0])&&M(q,e[8]),ne===(ne=te(e))&&re?re.p(e,n):(re.d(1),re=ne(e),re&&(re.c(),re.m(F,null)));const p={};2&n[0]&&(p.appLang=e[1]),X.$set(p)},i(e){K||(ue(t.$$.fragment,e),ue(r.$$.fragment,e),ue(s.$$.fragment,e),ue(u.$$.fragment,e),ue(g.$$.fragment,e),ue(w),ue(X.$$.fragment,e),K=!0)},o(e){de(t.$$.fragment,e),de(r.$$.fragment,e),de(s.$$.fragment,e),de(u.$$.fragment,e),de(g.$$.fragment,e),de(w),de(X.$$.fragment,e),K=!1},d(e){ve(t,e),e&&S(n),ve(r,e),e&&S(i),ve(s,e),e&&S(o),e&&S(l),ve(u),ve(g),I(Z,e),e&&S($),~b&&Y[b].d(e),e&&S(v),e&&S(y),re.d(),ve(X)}}}const Yn=()=>null;function er(e,t,n){let r,i,s,o,l,c,a,u,p,g,f;d(e,Ie,(e=>n(14,u=e)));const{selected:m}=Ne;d(e,m,(e=>n(29,a=e)));const{allRegions:h,fetchAll:$,pageRegions:b,fetchPages:w}=_e;d(e,h,(e=>n(15,p=e))),d(e,b,(e=>n(17,f=e))),d(e,w,(e=>n(16,g=e)));const v="Regions";let{appLang:y="en"}=t,{manifest:k=""}=t,{isValidated:x=!1}=t,{imgPrefix:L=""}=t,{nbOfPages:C=1}=t,{modules:S=[]}=t,{witness:I={}}=t;const R=`${window.location.origin}${window.location.pathname}`,P=parseInt(R.split("regions/")[1].replace("/",""));const E={all:{text:"en"===y?"All regions":"Toutes les régions"},page:{text:"en"===y?"Per page":"Par page"}};function O(e){n(12,o=e);const t=new URL(window.location);t.searchParams.set("tab",e),window.history.pushState({},"",t)}S.includes("similarity")&&(E.similarity={text:"en"===y?"Similarity":"Similarité"}),S.includes("vectorization")&&(E.vectorization={text:"en"===y?"Vectorization":"Vectorisation"});return e.$$set=e=>{"appLang"in e&&n(1,y=e.appLang),"manifest"in e&&n(2,k=e.manifest),"isValidated"in e&&n(3,x=e.isValidated),"imgPrefix"in e&&n(4,L=e.imgPrefix),"nbOfPages"in e&&n(5,C=e.nbOfPages),"modules"in e&&n(6,S=e.modules),"witness"in e&&n(7,I=e.witness)},e.$$.update=()=>{536870912&e.$$.dirty[0]&&n(9,r=a(!0)),512&e.$$.dirty[0]&&n(8,i=Object.keys(r).length),256&e.$$.dirty[0]&&n(13,s=i>0),268435456&e.$$.dirty[0]&&n(11,c=e=>l===e.ref)},n(12,o=new URLSearchParams(window.location.search).get("tab")??"all"),n(28,l=""),[v,y,k,x,L,C,S,I,i,r,E,c,o,s,u,p,g,f,m,h,$,b,w,R,P,function(e){return`${L}_${t=e,n=String(C).length+1,t.toString().padStart(n,"0")}`;var t,n},O,function(e){const{item:t}=e.detail,r=c(t)?"":t.ref;navigator.clipboard.writeText(r),n(28,l=r)},l,a,e=>O(e),e=>Ne.remove(e,v)]}return new class extends xe{constructor(e){super(),ke(this,e,er,Wn,o,{regionsType:0,appLang:1,manifest:2,isValidated:3,imgPrefix:4,nbOfPages:5,modules:6,witness:7},null,[-1,-1])}get regionsType(){return this.$$.ctx[0]}}({target:document.getElementById("region-list"),props:{witness:witness,regionsType:"Regions",appLang:APP_LANG,modules:ADDITIONAL_MODULES,manifest:manifest,isValidated:isValidated,imgPrefix:imgPrefix,nbOfPages:nbOfPages}})}();
//# sourceMappingURL=regionList.js.map
