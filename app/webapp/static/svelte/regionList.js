var regionList=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function i(){return Object.create(null)}function o(e){e.forEach(n)}function s(e){return"function"==typeof e}function l(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let r;function c(e,t){return r||(r=document.createElement("a")),r.href=t,e===r.href}function a(t,...n){if(null==t)return e;const i=t.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}function u(e,t,n){e.$$.on_destroy.push(a(t,n))}function d(e,t,n,i){return e[1]&&i?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](i(t))):n.ctx}const f="undefined"!=typeof window;let p=f?()=>window.performance.now():()=>Date.now(),g=f?e=>requestAnimationFrame(e):e;const m=new Set;function h(e){m.forEach((t=>{t.c(e)||(m.delete(t),t.f())})),0!==m.size&&g(h)}function $(e,t){e.appendChild(t)}function b(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function v(e){const t=x("style");return function(e,t){$(e.head||e,t),t.sheet}(b(e),t),t.sheet}function y(e,t,n){e.insertBefore(t,n||null)}function w(e){e.parentNode&&e.parentNode.removeChild(e)}function k(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function x(e){return document.createElement(e)}function L(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function E(e){return document.createTextNode(e)}function P(){return E(" ")}function S(){return E("")}function O(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function C(e){return function(t){return t.preventDefault(),e.call(this,t)}}function _(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function j(e,t){t=""+t,e.data!==t&&(e.data=t)}function A(e,t,n){e.classList[n?"add":"remove"](t)}const V=new Map;let R,I=0;function N(e,t,n,i,o,s,l,r=0){const c=16.666/i;let a="{\n";for(let e=0;e<=1;e+=c){const i=t+(n-t)*s(e);a+=100*e+`%{${l(i,1-i)}}\n`}const u=a+`100% {${l(n,1-n)}}\n}`,d=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${r}`,f=b(e),{stylesheet:p,rules:g}=V.get(f)||function(e,t){const n={stylesheet:v(t),rules:{}};return V.set(e,n),n}(f,e);g[d]||(g[d]=!0,p.insertRule(`@keyframes ${d} ${u}`,p.cssRules.length));const m=e.style.animation||"";return e.style.animation=`${m?`${m}, `:""}${d} ${i}ms linear ${o}ms 1 both`,I+=1,d}function M(e,t){const n=(e.style.animation||"").split(", "),i=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),o=n.length-i.length;o&&(e.style.animation=i.join(", "),I-=o,I||g((()=>{I||(V.forEach((e=>{const{ownerNode:t}=e.stylesheet;t&&w(t)})),V.clear())})))}function T(e){R=e}function U(){if(!R)throw new Error("Function called outside component initialization");return R}const z=[],H=[];let D=[];const B=[],q=Promise.resolve();let F=!1;function G(e){D.push(e)}const J=new Set;let X,K=0;function Y(){if(0!==K)return;const e=R;do{try{for(;K<z.length;){const e=z[K];K++,T(e),Q(e.$$)}}catch(e){throw z.length=0,K=0,e}for(T(null),z.length=0,K=0;H.length;)H.pop()();for(let e=0;e<D.length;e+=1){const t=D[e];J.has(t)||(J.add(t),t())}D.length=0}while(z.length);for(;B.length;)B.pop()();F=!1,J.clear(),T(e)}function Q(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(G)}}function W(e,t,n){e.dispatchEvent(function(e,t,{bubbles:n=!1,cancelable:i=!1}={}){const o=document.createEvent("CustomEvent");return o.initCustomEvent(e,n,i,t),o}(`${t?"intro":"outro"}${n}`))}const Z=new Set;let ee;function te(){ee={r:0,c:[],p:ee}}function ne(){ee.r||o(ee.c),ee=ee.p}function ie(e,t){e&&e.i&&(Z.delete(e),e.i(t))}function oe(e,t,n,i){if(e&&e.o){if(Z.has(e))return;Z.add(e),ee.c.push((()=>{Z.delete(e),i&&(n&&e.d(1),i())})),e.o(t)}else i&&i()}const se={duration:0};function le(n,i,l,r){const c={direction:"both"};let a=i(n,l,c),u=r?0:1,d=null,f=null,$=null;function b(){$&&M(n,$)}function v(e,t){const n=e.b-u;return t*=Math.abs(n),{a:u,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function y(i){const{delay:s=0,duration:l=300,easing:r=t,tick:c=e,css:y}=a||se,w={start:p()+s,b:i};i||(w.group=ee,ee.r+=1),d||f?f=w:(y&&(b(),$=N(n,u,i,l,s,r,y)),i&&c(0,1),d=v(w,l),G((()=>W(n,i,"start"))),function(e){let t;0===m.size&&g(h),new Promise((n=>{m.add(t={c:e,f:n})}))}((e=>{if(f&&e>f.start&&(d=v(f,l),f=null,W(n,d.b,"start"),y&&(b(),$=N(n,u,d.b,d.duration,0,r,a.css))),d)if(e>=d.end)c(u=d.b,1-u),W(n,d.b,"end"),f||(d.b?b():--d.group.r||o(d.group.c)),d=null;else if(e>=d.start){const t=e-d.start;u=d.a+d.d*r(t/d.duration),c(u,1-u)}return!(!d&&!f)})))}return{run(e){s(a)?(X||(X=Promise.resolve(),X.then((()=>{X=null}))),X).then((()=>{a=a(c),y(e)})):y(e)},end(){b(),d=f=null}}}function re(e,t){const n=t.token={};function i(e,i,o,s){if(t.token!==n)return;t.resolved=s;let l=t.ctx;void 0!==o&&(l=l.slice(),l[o]=s);const r=e&&(t.current=e)(l);let c=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==i&&e&&(te(),oe(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),ne())})):t.block.d(1),r.c(),ie(r,1),r.m(t.mount(),t.anchor),c=!0),t.block=r,t.blocks&&(t.blocks[i]=r),c&&Y()}if(!(o=e)||"object"!=typeof o&&"function"!=typeof o||"function"!=typeof o.then){if(t.current!==t.then)return i(t.then,1,t.value,e),!0;t.resolved=e}else{const n=U();if(e.then((e=>{T(n),i(t.then,1,t.value,e),T(null)}),(e=>{if(T(n),i(t.catch,2,t.error,e),T(null),!t.hasCatch)throw e})),t.current!==t.pending)return i(t.pending,0),!0}var o}function ce(e,t){oe(e,1,1,(()=>{t.delete(e.key)}))}function ae(e,t,n,i,s,l,r,c,a,u,d,f){let p=e.length,g=l.length,m=p;const h={};for(;m--;)h[e[m].key]=m;const $=[],b=new Map,v=new Map,y=[];for(m=g;m--;){const e=f(s,l,m),o=n(e);let c=r.get(o);c?i&&y.push((()=>c.p(e,t))):(c=u(o,e),c.c()),b.set(o,$[m]=c),o in h&&v.set(o,Math.abs(m-h[o]))}const w=new Set,k=new Set;function x(e){ie(e,1),e.m(c,d),r.set(e.key,e),d=e.first,g--}for(;p&&g;){const t=$[g-1],n=e[p-1],i=t.key,o=n.key;t===n?(d=t.first,p--,g--):b.has(o)?!r.has(i)||w.has(i)?x(t):k.has(o)?p--:v.get(i)>v.get(o)?(k.add(i),x(t)):(w.add(o),p--):(a(n,r),p--)}for(;p--;){const t=e[p];b.has(t.key)||a(t,r)}for(;g;)x($[g-1]);return o(y),$}function ue(e){e&&e.c()}function de(e,t,i,l){const{fragment:r,after_update:c}=e.$$;r&&r.m(t,i),l||G((()=>{const t=e.$$.on_mount.map(n).filter(s);e.$$.on_destroy?e.$$.on_destroy.push(...t):o(t),e.$$.on_mount=[]})),c.forEach(G)}function fe(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];D.forEach((i=>-1===e.indexOf(i)?t.push(i):n.push(i))),n.forEach((e=>e())),D=t}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function pe(e,t){-1===e.$$.dirty[0]&&(z.push(e),F||(F=!0,q.then(Y)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ge(t,n,s,l,r,c,a,u=[-1]){const d=R;T(t);const f=t.$$={fragment:null,ctx:[],props:c,update:e,not_equal:r,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:i(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};a&&a(f.root);let p=!1;if(f.ctx=s?s(t,n.props||{},((e,n,...i)=>{const o=i.length?i[0]:n;return f.ctx&&r(f.ctx[e],f.ctx[e]=o)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](o),p&&pe(t,e)),n})):[],f.update(),p=!0,o(f.before_update),f.fragment=!!l&&l(f.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);f.fragment&&f.fragment.l(e),e.forEach(w)}else f.fragment&&f.fragment.c();n.intro&&ie(t.$$.fragment),de(t,n.target,n.anchor,n.customElement),Y()}T(d)}class me{$destroy(){fe(this,1),this.$destroy=e}$on(t,n){if(!s(n))return e;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const e=i.indexOf(n);-1!==e&&i.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function he(e=null,t="full",n="full"){if(!e)return"https://via.placeholder.com/96x96?text=No+Image";if((e=e.split("_")).length<3)return"https://via.placeholder.com/96x96?text=No+Image";const i=e[e.length-1].includes(",")?e.pop().replace(".jpg",""):t,o=e.join("_").replace(".jpg","");return`${CANTALOUPE_APP_URL??"http://localhost:8182"}/iiif/2/${o}.jpg/${i}/${n}/0/default.jpg`}function $e(e=null,t=1){return`${SAS_APP_URL??"http://localhost:3000"}/index.html?iiif-content=${e}&canvas=${t}`}function be(e,t=null,n=!1){return new Promise((i=>{if(document.getElementById("msg-modal")){n&&(document.getElementById("modal-footer").hidden=!1),t&&(document.getElementById("modal-title").textContent=t),document.getElementById("modal-body").textContent=e,document.getElementById("hidden-msg-btn").click();const o=document.getElementById("cancel-btn"),s=document.getElementById("ok-btn"),l=document.getElementById("modal-bkg"),r=()=>{o.removeEventListener("click",c),l.removeEventListener("click",c),s.removeEventListener("click",a),document.getElementById("modal-footer").hidden=!0},c=()=>{r(),i(!1)},a=()=>{r(),i(!0)};o.addEventListener("click",c),s.addEventListener("click",a)}else n?i(window.confirm(e)):(window.alert(e),i(void 0))}))}const ve=[];function ye(t,n=e){let i;const o=new Set;function s(e){if(l(t,e)&&(t=e,i)){const e=!ve.length;for(const e of o)e[1](),ve.push(e,t);if(e){for(let e=0;e<ve.length;e+=2)ve[e][0](ve[e+1]);ve.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(l,r=e){const c=[l,r];return o.add(c),1===o.size&&(i=n(s)||e),l(t),()=>{o.delete(c),0===o.size&&i&&(i(),i=null)}}}}function we(t,n,i){const l=!Array.isArray(t),r=l?[t]:t,c=n.length<2;return u=t=>{let i=!1;const u=[];let d=0,f=e;const p=()=>{if(d)return;f();const i=n(l?u[0]:u,t);c?t(i):f=s(i)?i:e},g=r.map(((e,t)=>a(e,(e=>{u[t]=e,d&=~(1<<t),i&&p()}),(()=>{d|=1<<t}))));return i=!0,p(),function(){o(g),f(),i=!1}},{subscribe:ye(i,u).subscribe};var u}const ke="Regions";const xe=function(){const e=ye(JSON.parse(localStorage.getItem("documentSet"))||{}),{subscribe:t,get:n,update:i}=e;function o(e){localStorage.setItem("documentSet",JSON.stringify(e))}function s(e,t=!0){return t?e[ke]??{}:Object.entries(e).filter((([e,t])=>e!==ke))}function l(e,t,n){if(e[n]){const{[t]:i,...o}=e[n];e={...e,[n]:o}}return o(e),e}function r(e,t){return e.hasOwnProperty(t.type)||(e[t.type]={}),e[t.type]={...e[t.type],[t.id]:t},o(e),e}return{subscribe:t,save:()=>i((e=>(console.log(e),e))),empty:e=>i((t=>(e?delete t[ke]:Object.keys(t).forEach((e=>{e!==ke&&delete t[e]})),o(t),t))),addAll:e=>i((t=>function(e,t){return t.forEach((t=>{e[t.type]||(e[t.type]={}),e[t.type][t.id]=t})),o(e),e}(t,e))),removeAll:(e,t)=>i((n=>function(e,t,n){return e[n]?(t.forEach((t=>{delete e[n][t]})),o(e),e):e}(n,e,t))),remove:(e,t)=>i((n=>l(n,e,t))),add:e=>i((t=>r(t,e))),toggle:e=>i((t=>t[e.type]?.[e.id]?l(t,e.id,e.type):r(t,e))),toggleAll:(e,t,n)=>i((e=>{})),isSelected:we(e,(e=>t=>e[t.type]?.hasOwnProperty(t.id)||!1)),selected:we(e,(e=>t=>s(e,t))),nbSelected:we(e,(e=>t=>{const n=s(e,t);return t?Object.keys(n).length:n.reduce(((e,[t,n])=>e+Object.keys(n).length),0)}))}}();const Le=function(){const e=ye(1),t=ye({}),n=`${window.location.origin}${window.location.pathname}`;if("undefined"!=typeof window){const t=new URLSearchParams(window.location.search).get("p");t&&e.set(parseInt(t))}const i=we(e,((e,i)=>(async()=>{const i=await fetch(`${n}canvas?p=${e}`),o=await i.json();return t.set(o),o})()));return{currentPage:e,pageRegions:t,fetchPages:i,handlePageUpdate:function(t){if(e.set(t),"undefined"!=typeof window){const e=new URL(window.location.href);e.searchParams.set("p",t),window.history.pushState({},"",e)}},updatePageRegions:function(e){t.update(e)}}}();function Ee(e,{delay:n=0,duration:i=400,easing:o=t}={}){const s=+getComputedStyle(e).opacity;return{delay:n,duration:i,easing:o,css:e=>"opacity: "+e*s}}function Pe(e){let t;return{c(){t=L("path"),_(t,"d","M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"),_(t,"class","svelte-1fqh2ri")},m(e,n){y(e,t,n)},d(e){e&&w(t)}}}function Se(e){let t;return{c(){t=L("path"),_(t,"d","M208 0H332.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H208c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128h80v64H64V448H256V416h64v48c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48z"),_(t,"class","svelte-1fqh2ri")},m(e,n){y(e,t,n)},d(e){e&&w(t)}}}function Oe(e){let t,n="en"===e[2]?"Copy ID":"Copier l'ID";return{c(){t=E(n)},m(e,n){y(e,t,n)},p(e,i){4&i&&n!==(n="en"===e[2]?"Copy ID":"Copier l'ID")&&j(t,n)},d(e){e&&w(t)}}}function Ce(e){let t,n="en"===e[2]?"Copied!":"Copié !";return{c(){t=E(n)},m(e,n){y(e,t,n)},p(e,i){4&i&&n!==(n="en"===e[2]?"Copied!":"Copié !")&&j(t,n)},d(e){e&&w(t)}}}function _e(e){let t,n,i,s,l,r,a,u,d,f,p,g,m,h,b,v,k,S,C=e[0].title+"";function A(e,t){return e[1]?Se:Pe}let V=A(e),R=V(e);function I(e,t){return e[1]?Ce:Oe}let N=I(e),M=N(e);return{c(){t=x("div"),n=x("figure"),i=x("img"),l=P(),r=x("div"),a=x("span"),u=E(C),d=P(),f=x("button"),p=L("svg"),R.c(),g=P(),m=x("span"),M.c(),c(i.src,s=he(e[0].img,e[0].xyhw,"96,"))||_(i,"src",s),_(i,"alt","Extracted region"),_(a,"class","overlay-desc"),_(r,"class","overlay is-center svelte-1fqh2ri"),_(n,"class","image is-96x96 card svelte-1fqh2ri"),_(n,"tabindex","-1"),_(p,"xmlns","http://www.w3.org/2000/svg"),_(p,"viewBox","0 0 384 512"),_(p,"class","svelte-1fqh2ri"),_(m,"class","tooltip svelte-1fqh2ri"),_(f,"class","button region-btn tag svelte-1fqh2ri"),_(t,"class",h="region image is-96x96 is-center "+(e[3](e[0])?"checked":"")+" svelte-1fqh2ri")},m(o,s){y(o,t,s),$(t,n),$(n,i),$(n,l),$(n,r),$(r,a),$(a,u),$(t,d),$(t,f),$(f,p),R.m(p,null),$(f,g),$(f,m),M.m(m,null),v=!0,k||(S=[O(n,"click",e[6]),O(n,"keyup",je),O(f,"click",e[7])],k=!0)},p(e,[n]){(!v||1&n&&!c(i.src,s=he(e[0].img,e[0].xyhw,"96,")))&&_(i,"src",s),(!v||1&n)&&C!==(C=e[0].title+"")&&j(u,C),V!==(V=A(e))&&(R.d(1),R=V(e),R&&(R.c(),R.m(p,null))),N===(N=I(e))&&M?M.p(e,n):(M.d(1),M=N(e),M&&(M.c(),M.m(m,null))),(!v||9&n&&h!==(h="region image is-96x96 is-center "+(e[3](e[0])?"checked":"")+" svelte-1fqh2ri"))&&_(t,"class",h)},i(e){v||(G((()=>{v&&(b||(b=le(t,Ee,{duration:500},!0)),b.run(1))})),v=!0)},o(e){b||(b=le(t,Ee,{duration:500},!1)),b.run(0),v=!1},d(e){e&&w(t),R.d(),M.d(),e&&b&&b.end(),k=!1,o(S)}}}const je=()=>null;function Ae(e,t,n){let i;const{isSelected:o}=xe;u(e,o,(e=>n(3,i=e)));let{item:s}=t,{isCopied:l=!1}=t,{appLang:r="en"}=t;function c(){dispatch("copyRef",{item:s})}return e.$$set=e=>{"item"in e&&n(0,s=e.item),"isCopied"in e&&n(1,l=e.isCopied),"appLang"in e&&n(2,r=e.appLang)},[s,l,r,i,o,c,()=>xe.toggle(s),()=>c()]}class Ve extends me{constructor(e){super(),ge(this,e,Ae,_e,l,{item:0,isCopied:1,appLang:2})}}function Re(t){let n,i,o,s,l,r,c,a,u,d="en"===t[1]?"Selection":"Sélection";return{c(){n=x("div"),i=x("button"),o=x("span"),s=x("i"),l=P(),r=E(d),c=E("\n            ("),a=E(t[0]),u=E(")"),_(s,"class","fa-solid fa-book-bookmark"),_(o,"id","btn-content"),_(i,"id","set-btn"),_(i,"class","button px-5 py-4 is-link js-modal-trigger svelte-hs48f9"),_(i,"data-target","selection-modal"),_(n,"class","set-container svelte-hs48f9")},m(e,t){y(e,n,t),$(n,i),$(i,o),$(o,s),$(o,l),$(o,r),$(o,c),$(o,a),$(o,u)},p(e,[t]){2&t&&d!==(d="en"===e[1]?"Selection":"Sélection")&&j(r,d),1&t&&j(a,e[0])},i:e,o:e,d(e){e&&w(n)}}}function Ie(e,t,n){let{selectionLength:i=0}=t,{appLang:o="en"}=t,s=i;return e.$$set=e=>{"selectionLength"in e&&n(0,i=e.selectionLength),"appLang"in e&&n(1,o=e.appLang)},e.$$.update=()=>{if(5&e.$$.dirty&&i!==s){const e=i>s;n(2,s=i);const t=document.getElementById("btn-content");t&&t.animate([{transform:e?"translateY(-7px)":"translateX(-5px)"},{transform:e?"translateY(7px)":"translateX(5px)"},{transform:"translate(0)"}],{duration:300,easing:"cubic-bezier(0.65, 0, 0.35, 1)"})}},[i,o,s]}class Ne extends me{constructor(e){super(),ge(this,e,Ie,Re,l,{selectionLength:0,appLang:1})}}function Me(t){let n,i,s,l,r,c,a,u,d,f,p,g="en"===t[0]?"Clear selection":"Vider la sélection",m="en"===t[0]?"Save selection":"Sauvegarder la sélection";return{c(){n=x("footer"),i=x("div"),s=x("button"),l=E(g),r=P(),c=x("button"),a=x("i"),u=P(),d=E(m),_(s,"class","button is-link is-light"),_(a,"class","fa-solid fa-floppy-disk"),_(c,"class","button is-link"),_(i,"class","buttons"),_(n,"class","modal-card-foot is-center")},m(e,o){y(e,n,o),$(n,i),$(i,s),$(s,l),$(i,r),$(i,c),$(c,a),$(c,u),$(c,d),f||(p=[O(s,"click",t[2]),O(c,"click",t[3])],f=!0)},p(e,[t]){1&t&&g!==(g="en"===e[0]?"Clear selection":"Vider la sélection")&&j(l,g),1&t&&m!==(m="en"===e[0]?"Save selection":"Sauvegarder la sélection")&&j(d,m)},i:e,o:e,d(e){e&&w(n),f=!1,o(p)}}}function Te(e,t,n){let{appLang:i="en"}=t,{isRegion:o=!0}=t;return e.$$set=e=>{"appLang"in e&&n(0,i=e.appLang),"isRegion"in e&&n(1,o=e.isRegion)},[i,o,()=>xe.empty(o),()=>xe.save()]}class Ue extends me{constructor(e){super(),ge(this,e,Te,Me,l,{appLang:0,isRegion:1})}}function ze(e){let t,n,i,o,s,l,r,a,u,f,p,g,m,h,b,v,k,L;const S=e[4].default,O=function(e,t,n,i){if(e){const o=d(e,t,n,i);return e[0](o)}}(S,e,e[3],null);return{c(){var d,$,y,w;t=x("tr"),n=x("th"),i=x("div"),o=x("img"),r=P(),a=x("div"),u=x("a"),f=x("i"),p=E("\n                    Page "),g=E(e[0]),h=P(),b=x("td"),v=x("div"),k=x("div"),O&&O.c(),c(o.src,s=he(e[1],"full","250,"))||_(o,"src",s),_(o,"alt",l="Canvas "+e[0]),_(o,"class","mb-3 card"),_(f,"class","fa-solid fa-pen-to-square"),_(u,"class","tag px-2 py-1 is-rounded"),_(u,"href",m=$e(e[2],e[0])),_(u,"target","_blank"),_(a,"class","is-center mb-1"),_(i,"class","content-wrapper py-5"),_(n,"class","is-3 center-flex is-narrow"),d=n,$="width",null==(y="260px")?d.style.removeProperty($):d.style.setProperty($,y,w?"important":""),_(k,"class","grid is-gap-2"),_(v,"class","fixed-grid has-6-cols"),_(b,"class","p-5 is-fullwidth")},m(e,s){y(e,t,s),$(t,n),$(n,i),$(i,o),$(i,r),$(i,a),$(a,u),$(u,f),$(u,p),$(u,g),$(t,h),$(t,b),$(b,v),$(v,k),O&&O.m(k,null),L=!0},p(e,[t]){(!L||2&t&&!c(o.src,s=he(e[1],"full","250,")))&&_(o,"src",s),(!L||1&t&&l!==(l="Canvas "+e[0]))&&_(o,"alt",l),(!L||1&t)&&j(g,e[0]),(!L||5&t&&m!==(m=$e(e[2],e[0])))&&_(u,"href",m),O&&O.p&&(!L||8&t)&&function(e,t,n,i,o,s){if(o){const l=d(t,n,i,s);e.p(l,o)}}(O,S,e,e[3],L?function(e,t,n,i){if(e[2]&&i){const o=e[2](i(n));if(void 0===t.dirty)return o;if("object"==typeof o){const e=[],n=Math.max(t.dirty.length,o.length);for(let i=0;i<n;i+=1)e[i]=t.dirty[i]|o[i];return e}return t.dirty|o}return t.dirty}(S,e[3],t,null):function(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}(e[3]),null)},i(e){L||(ie(O,e),L=!0)},o(e){oe(O,e),L=!1},d(e){e&&w(t),O&&O.d(e)}}}function He(e,t,n){let{$$slots:i={},$$scope:o}=t,{canvasNb:s}=t,{canvasImg:l}=t,{manifest:r}=t;return e.$$set=e=>{"canvasNb"in e&&n(0,s=e.canvasNb),"canvasImg"in e&&n(1,l=e.canvasImg),"manifest"in e&&n(2,r=e.manifest),"$$scope"in e&&n(3,o=e.$$scope)},[s,l,r,o,i]}class De extends me{constructor(e){super(),ge(this,e,He,ze,l,{canvasNb:0,canvasImg:1,manifest:2})}}function Be(e){let t,n,i,o,s,l,r=e[0]-1>1&&qe(e);return{c(){t=x("li"),n=x("a"),n.textContent="1",i=P(),r&&r.c(),o=S(),_(n,"class","pagination-link"),_(n,"href",null)},m(c,a){y(c,t,a),$(t,n),y(c,i,a),r&&r.m(c,a),y(c,o,a),s||(l=O(n,"click",C(e[4])),s=!0)},p(e,t){e[0]-1>1?r?r.p(e,t):(r=qe(e),r.c(),r.m(o.parentNode,o)):r&&(r.d(1),r=null)},d(e){e&&w(t),e&&w(i),r&&r.d(e),e&&w(o),s=!1,l()}}}function qe(e){let t,n,i,o,s,l,r,c=e[0]-1+"";return{c(){t=x("li"),t.innerHTML='<span class="pagination-ellipsis">…</span>',n=P(),i=x("li"),o=x("a"),s=E(c),_(o,"class","pagination-link"),_(o,"href",null)},m(c,a){y(c,t,a),y(c,n,a),y(c,i,a),$(i,o),$(o,s),l||(r=O(o,"click",C(e[5])),l=!0)},p(e,t){1&t&&c!==(c=e[0]-1+"")&&j(s,c)},d(e){e&&w(t),e&&w(n),e&&w(i),l=!1,r()}}}function Fe(e){let t,n,i,o,s,l=e[0]+1<e[2]&&Ge(e);return{c(){l&&l.c(),t=P(),n=x("li"),i=x("a"),i.textContent=`${e[2]}`,_(i,"class","pagination-link"),_(i,"href",null)},m(r,c){l&&l.m(r,c),y(r,t,c),y(r,n,c),$(n,i),o||(s=O(i,"click",C(e[8])),o=!0)},p(e,n){e[0]+1<e[2]?l?l.p(e,n):(l=Ge(e),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(e){l&&l.d(e),e&&w(t),e&&w(n),o=!1,s()}}}function Ge(e){let t,n,i,o,s,l,r,c=e[0]+1+"";return{c(){t=x("li"),n=x("a"),i=E(c),o=P(),s=x("li"),s.innerHTML='<span class="pagination-ellipsis">…</span>',_(n,"class","pagination-link"),_(n,"href",null)},m(c,a){y(c,t,a),$(t,n),$(n,i),y(c,o,a),y(c,s,a),l||(r=O(n,"click",C(e[7])),l=!0)},p(e,t){1&t&&c!==(c=e[0]+1+"")&&j(i,c)},d(e){e&&w(t),e&&w(o),e&&w(s),l=!1,r()}}}function Je(t){let n,i=t[2]>1&&function(e){let t,n,i,o,s,l,r,c,a,u=e[0]>1&&Be(e),d=e[0]<e[2]&&Fe(e);return{c(){t=x("nav"),n=x("ul"),u&&u.c(),i=P(),o=x("li"),s=x("a"),l=E(e[0]),r=P(),d&&d.c(),_(s,"class","pagination-link is-current"),_(s,"href",null),_(n,"class","pagination-list"),_(t,"class","pagination is-centered"),_(t,"aria-label","pagination")},m(f,p){y(f,t,p),$(t,n),u&&u.m(n,null),$(n,i),$(n,o),$(o,s),$(s,l),$(n,r),d&&d.m(n,null),c||(a=O(s,"click",C(e[6])),c=!0)},p(e,t){e[0]>1?u?u.p(e,t):(u=Be(e),u.c(),u.m(n,i)):u&&(u.d(1),u=null),1&t&&j(l,e[0]),e[0]<e[2]?d?d.p(e,t):(d=Fe(e),d.c(),d.m(n,null)):d&&(d.d(1),d=null)},d(e){e&&w(t),u&&u.d(),d&&d.d(),c=!1,a()}}}(t);return{c(){i&&i.c(),n=S()},m(e,t){i&&i.m(e,t),y(e,n,t)},p(e,[t]){e[2]>1&&i.p(e,t)},i:e,o:e,d(e){i&&i.d(e),e&&w(n)}}}function Xe(e,t,n){let i;const{currentPage:o}=Le;u(e,o,(e=>n(0,i=e)));let{nbOfPages:s}=t;const l=Math.ceil(s/50);return e.$$set=e=>{"nbOfPages"in e&&n(3,s=e.nbOfPages)},[i,o,l,s,()=>Le.handlePageUpdate(1),()=>Le.handlePageUpdate(i-1),()=>Le.handlePageUpdate(i),()=>Le.handlePageUpdate(i+1),()=>Le.handlePageUpdate(l)]}class Ke extends me{constructor(e){super(),ge(this,e,Xe,Je,l,{nbOfPages:3})}}function Ye(t){let n,i,o,s,l,r,c,a,u,d,f,p,g,m,h,b,v="en"===t[0]?"Cancel":"Annuler";return{c(){n=x("button"),i=P(),o=x("div"),s=x("div"),l=P(),r=x("div"),c=x("div"),c.innerHTML='<div class="title is-4 mb-0 media-content"><span id="modal-title" class="mb-0"></span></div> \n            <button class="delete media-left" aria-label="close"></button>',a=P(),u=x("section"),d=P(),f=x("footer"),p=x("div"),g=x("button"),m=E(v),h=P(),b=x("button"),b.textContent="OK",_(n,"id","hidden-msg-btn"),_(n,"class","js-modal-trigger"),_(n,"data-target","msg-modal"),n.hidden=!0,_(s,"id","modal-bkg"),_(s,"class","modal-background"),_(c,"class","modal-card-head media mb-0"),_(u,"id","modal-body"),_(u,"class","modal-card-body"),_(g,"id","cancel-btn"),_(g,"class","button is-link is-light"),_(b,"id","ok-btn"),_(b,"class","button is-link"),_(p,"class","buttons"),_(f,"id","modal-footer"),_(f,"class","modal-card-foot is-center pt-1"),f.hidden=!0,_(r,"class","modal-content"),_(o,"id","msg-modal"),_(o,"class","modal fade"),_(o,"tabindex","-1"),_(o,"aria-labelledby","selection-modal-label"),_(o,"aria-hidden","true")},m(e,t){y(e,n,t),y(e,i,t),y(e,o,t),$(o,s),$(o,l),$(o,r),$(r,c),$(r,a),$(r,u),$(r,d),$(r,f),$(f,p),$(p,g),$(g,m),$(p,h),$(p,b)},p(e,[t]){1&t&&v!==(v="en"===e[0]?"Cancel":"Annuler")&&j(m,v)},i:e,o:e,d(e){e&&w(n),e&&w(i),e&&w(o)}}}function Qe(e,t,n){let{appLang:i="en"}=t;return e.$$set=e=>{"appLang"in e&&n(0,i=e.appLang)},[i]}class We extends me{constructor(e){super(),ge(this,e,Qe,Ye,l,{appLang:0})}}function Ze(e){let t,n,i="en"===e[0]?"Automatic region extraction":"Extraction automatique des régions";return{c(){t=x("button"),n=E(i),_(t,"class","button is-link is-inverted")},m(e,i){y(e,t,i),$(t,n)},p(e,t){1&t&&i!==(i="en"===e[0]?"Automatic region extraction":"Extraction automatique des régions")&&j(n,i)},d(e){e&&w(t)}}}function et(t){let n,i,o,s,l,r,c,a,u,d="en"===t[0]?"Manually annotate":"Annoter manuellement",f="en"===t[0]?"Import regions file":"Importer un fichier de région",p=t[1].includes("regions"),g=p&&Ze(t);return{c(){n=x("div"),i=x("button"),o=E(d),s=P(),l=x("button"),r=E(f),c=P(),g&&g.c(),_(i,"class","button is-link"),_(l,"class","button is-link is-light"),_(n,"class","is-center buttons is-centered pt-5")},m(e,d){y(e,n,d),$(n,i),$(i,o),$(n,s),$(n,l),$(l,r),$(n,c),g&&g.m(n,null),a||(u=O(i,"click",t[2]),a=!0)},p(e,[t]){1&t&&d!==(d="en"===e[0]?"Manually annotate":"Annoter manuellement")&&j(o,d),1&t&&f!==(f="en"===e[0]?"Import regions file":"Importer un fichier de région")&&j(r,f),2&t&&(p=e[1].includes("regions")),p?g?g.p(e,t):(g=Ze(e),g.c(),g.m(n,null)):g&&(g.d(1),g=null)},i:e,o:e,d(e){e&&w(n),g&&g.d(),a=!1,u()}}}function tt(e,t,n){let{appLang:i="en"}=t,{modules:o=[]}=t,{witness:s={}}=t;const l=`${window.location.origin}`;return e.$$set=e=>{"appLang"in e&&n(0,i=e.appLang),"modules"in e&&n(1,o=e.modules),"witness"in e&&n(3,s=e.witness)},[i,o,async function(){s.regions.length;const e=await fetch(`${l}/witness/${s.id}/regions/add`,{method:"POST",headers:{"X-CSRFToken":CSRF_TOKEN}});if(204!==e.status)throw new Error(`Failed to create regions: '${e.statusText}'`);e.json().then((e=>{e.mirador_url&&window.open(e.mirador_url)}))},s]}class nt extends me{constructor(e){super(),ge(this,e,tt,et,l,{appLang:0,modules:1,witness:3})}}function it(e,t,n){const i=e.slice();return i[4]=t[n],i}function ot(e){let t,n=e[0].regions,i=[];for(let t=0;t<n.length;t+=1)i[t]=lt(it(e,n,t));return{c(){for(let e=0;e<i.length;e+=1)i[e].c();t=S()},m(e,n){for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(e,n);y(e,t,n)},p(e,o){if(3&o){let s;for(n=e[0].regions,s=0;s<n.length;s+=1){const l=it(e,n,s);i[s]?i[s].p(l,o):(i[s]=lt(l),i[s].c(),i[s].m(t.parentNode,t))}for(;s<i.length;s+=1)i[s].d(1);i.length=n.length}},d(e){k(i,e),e&&w(t)}}}function st(e){let t,n,i,o,s="en"===e[2]?"Delete regions record":"Supprimer l'intégralité des régions";return{c(){t=x("button"),n=E(s),_(t,"class","tag is-danger")},m(e,s){y(e,t,s),$(t,n),i||(o=O(t,"click",ct),i=!0)},p(e,t){4&t&&s!==(s="en"===e[2]?"Delete regions record":"Supprimer l'intégralité des régions")&&j(n,s)},d(e){e&&w(t),i=!1,o()}}}function lt(e){let t,n,i,o,s=e[4]+"";return{c(){t=x("a"),n=E("#"),i=E(s),_(t,"href",o=""+(e[1]+e[4])),_(t,"class","tag is-dark mr-3 is-rounded")},m(e,o){y(e,t,o),$(t,n),$(t,i)},p(e,n){1&n&&s!==(s=e[4]+"")&&j(i,s),3&n&&o!==(o=""+(e[1]+e[4]))&&_(t,"href",o)},d(e){e&&w(t)}}}function rt(t){let n;let i=function(e,t){return e[3]?st:ot}(t),o=i(t);return{c(){n=x("div"),o.c(),_(n,"class","is-right")},m(e,t){y(e,n,t),o.m(n,null)},p(e,[t]){o.p(e,t)},i:e,o:e,d(e){e&&w(n),o.d()}}}async function ct(){}function at(e,t,n){let{witness:i}=t,{baseUrl:o}=t,{appLang:s="en"}=t;const l=o.split("regions/")[1];return e.$$set=e=>{"witness"in e&&n(0,i=e.witness),"baseUrl"in e&&n(1,o=e.baseUrl),"appLang"in e&&n(2,s=e.appLang)},[i,o,s,l]}class ut extends me{constructor(e){super(),ge(this,e,at,rt,l,{witness:0,baseUrl:1,appLang:2})}}function dt(e){let t;return{c(){t=L("path"),_(t,"d","M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"),_(t,"class","svelte-1dknt99")},m(e,n){y(e,t,n)},d(e){e&&w(t)}}}function ft(e){let t;return{c(){t=L("path"),_(t,"d","M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"),_(t,"class","svelte-1dknt99")},m(e,n){y(e,t,n)},d(e){e&&w(t)}}}function pt(e){let t,n="en"===e[0]?"Edit":"Modifier";return{c(){t=E(n)},m(e,n){y(e,t,n)},p(e,i){1&i&&n!==(n="en"===e[0]?"Edit":"Modifier")&&j(t,n)},d(e){e&&w(t)}}}function gt(e){let t,n="en"===e[0]?"Validate":"Valider";return{c(){t=E(n)},m(e,n){y(e,t,n)},p(e,i){1&i&&n!==(n="en"===e[0]?"Validate":"Valider")&&j(t,n)},d(e){e&&w(t)}}}function mt(e){let t,n,i,s,l,r,c,a,u,d,f,p,g,m,h,b,v,k="en"===e[0]?"Reload":"Recharger",L="en"===e[0]?"Go to editor":"Aller à l'éditeur",S="en"===e[0]?"Delete selected regions":"Supprimer les régions sélectionnées";return{c(){t=x("button"),n=x("i"),i=P(),s=E(k),l=P(),r=x("a"),c=x("i"),a=P(),u=E(L),f=P(),p=x("button"),g=x("i"),m=P(),h=E(S),_(n,"class","fa-solid fa-rotate-right"),_(t,"class","tag is-link is-light is-rounded mr-3"),_(c,"class","fa-solid fa-edit"),_(r,"class","tag is-link is-rounded mr-3"),_(r,"href",d=$e(e[1])),_(r,"target","_blank"),_(g,"class","fa-solid fa-trash"),_(p,"class","tag is-danger is-rounded")},m(o,d){y(o,t,d),$(t,n),$(t,i),$(t,s),y(o,l,d),y(o,r,d),$(r,c),$(r,a),$(r,u),y(o,f,d),y(o,p,d),$(p,g),$(p,m),$(p,h),b||(v=[O(t,"click",e[15]),O(p,"click",e[6])],b=!0)},p(e,t){1&t&&k!==(k="en"===e[0]?"Reload":"Recharger")&&j(s,k),1&t&&L!==(L="en"===e[0]?"Go to editor":"Aller à l'éditeur")&&j(u,L),2&t&&d!==(d=$e(e[1]))&&_(r,"href",d),1&t&&S!==(S="en"===e[0]?"Delete selected regions":"Supprimer les régions sélectionnées")&&j(h,S)},d(e){e&&w(t),e&&w(l),e&&w(r),e&&w(f),e&&w(p),b=!1,o(v)}}}function ht(t){let n,i,s,l,r,c,a,u,d,f,p,g,m,h,b,v,k,S,C,A="en"===t[0]?"Download":"Télécharger";function V(e,t){return e[2]?ft:dt}let R=V(t),I=R(t);function N(e,t){return e[2]?gt:pt}let M=N(t),T=M(t),U=t[2]&&mt(t);return{c(){n=x("div"),i=x("button"),s=L("svg"),I.c(),l=P(),T.c(),c=P(),a=x("button"),u=x("i"),d=P(),f=x("span"),f.textContent=`${t[7]()}`,p=P(),g=x("button"),m=x("i"),h=P(),b=E(A),v=P(),k=x("div"),U&&U.c(),_(s,"xmlns","http://www.w3.org/2000/svg"),_(s,"viewBox","0 0 384 512"),_(s,"class","pr-3"),_(i,"class",r="button "+(t[2]?"is-success":"is-link")+" mr-3"),_(u,"class","fa-solid fa-square-check"),_(f,"id","all-selection"),_(a,"class","button is-link is-light mr-3"),_(m,"class","fa-solid fa-download"),_(g,"class","button is-link is-light"),_(n,"class","is-left mb-3"),_(k,"class","edit-action svelte-1dknt99")},m(e,o){y(e,n,o),$(n,i),$(i,s),I.m(s,null),$(i,l),T.m(i,null),$(n,c),$(n,a),$(a,u),$(a,d),$(a,f),$(n,p),$(n,g),$(g,m),$(g,h),$(g,b),y(e,v,o),y(e,k,o),U&&U.m(k,null),S||(C=[O(i,"click",t[14]),O(a,"click",t[8]),O(g,"click",bt)],S=!0)},p(e,[t]){R!==(R=V(e))&&(I.d(1),I=R(e),I&&(I.c(),I.m(s,null))),M===(M=N(e))&&T?T.p(e,t):(T.d(1),T=M(e),T&&(T.c(),T.m(i,null))),4&t&&r!==(r="button "+(e[2]?"is-success":"is-link")+" mr-3")&&_(i,"class",r),1&t&&A!==(A="en"===e[0]?"Download":"Télécharger")&&j(b,A),e[2]?U?U.p(e,t):(U=mt(e),U.c(),U.m(k,null)):U&&(U.d(1),U=null)},i:e,o:e,d(e){e&&w(n),I.d(),T.d(),e&&w(v),e&&w(k),U&&U.d(),S=!1,o(C)}}}async function $t(e){const t=SAS_APP_URL.replace("https","http"),n=`${SAS_APP_URL}/annotation/destroy?uri=${t}/annotation/${e}`,i=await fetch(n,{method:"DELETE"});if(204!==i.status)throw new Error(`Failed to delete ${n} due to ${i.status}: '${i.statusText}'`)}const bt=()=>null;function vt(e,t,n){let i,o,s,l,r;const{selected:c,nbSelected:a}=xe;u(e,c,(e=>n(12,l=e))),u(e,a,(e=>n(13,r=e)));let{appLang:d}=t,{manifest:f}=t,{isValidated:p}=t,{regions:g}=t,{regionsType:m}=t;function h(){n(2,o=!o)}function $(){return i===Object.keys(g).length}function b(e){Le.updatePageRegions((t=>{for(const n in t)if(t[n][e]){const{[e]:i,...o}=t[n];return t[n]=o,t}return t}))}return e.$$set=e=>{"appLang"in e&&n(0,d=e.appLang),"manifest"in e&&n(1,f=e.manifest),"isValidated"in e&&n(10,p=e.isValidated),"regions"in e&&n(9,g=e.regions),"regionsType"in e&&n(11,m=e.regionsType)},e.$$.update=()=>{8192&e.$$.dirty&&(i=r(!0)),1024&e.$$.dirty&&n(2,o=!p),4096&e.$$.dirty&&(s=l(!0))},[d,f,o,c,a,h,async function(){if(await be("en"===d?"Are you sure you want to delete regions?":"Voulez-vous vraiment supprimer les régions?","en"===d?"Confirm deletion":"Confirmer la suppression",!0))for(const e of Object.keys(s))try{if(!g.hasOwnProperty(e))continue;await $t(e),delete g[e],n(9,g={...g}),b(e),xe.remove(e,m)}catch(t){await be(`Failed to delete region ${e}: ${t.message}`,"Error")}},function(e=null){return null===e&&(e=$()),e?"en"===d?"Unselect all":"Tout désélectionner":"en"===d?"Select all":"Tout sélectionner"},function(){$()?xe.removeAll(Object.keys(g),"Regions"):xe.addAll(Object.values(g))},g,p,m,l,r,()=>h(),()=>location.reload()]}class yt extends me{constructor(e){super(),ge(this,e,vt,ht,l,{appLang:0,manifest:1,isValidated:10,regions:9,regionsType:11})}}function wt(e,t,n){const i=e.slice();return i[28]=t[n][0],i[29]=t[n][1],i}function kt(e,t,n){const i=e.slice();return i[36]=t[n][0],i[37]=t[n][1],i}function xt(e,t,n){const i=e.slice();return i[32]=t[n],i}function Lt(e,t,n){const i=e.slice();return i[32]=t[n],i}function Et(e,t,n){const i=e.slice();return i[43]=t[n][0],i[29]=t[n][1],i}function Pt(e){let t,n,i,s,l,r,c=e[29].text+"";function a(){return e[25](e[43])}return{c(){t=x("li"),n=x("a"),i=E(c),s=P(),_(n,"href",null),A(t,"is-active",e[43]===e[13])},m(e,o){y(e,t,o),$(t,n),$(n,i),$(t,s),l||(r=[O(t,"click",a),O(t,"keyup",Ft)],l=!0)},p(n,o){e=n,1024&o[0]&&c!==(c=e[29].text+"")&&j(i,c),9216&o[0]&&A(t,"is-active",e[43]===e[13])},d(e){e&&w(t),l=!1,o(r)}}}function St(t){let n;return{c(){n=x("div"),n.textContent="tout doux"},m(e,t){y(e,n,t)},p:e,i:e,o:e,d(e){e&&w(n)}}}function Ot(t){let n;return{c(){n=x("div"),n.textContent="tout doux"},m(e,t){y(e,n,t)},p:e,i:e,o:e,d(e){e&&w(n)}}}function Ct(e){let t,n,i,o,s,l;t=new Ke({props:{nbOfPages:e[5]}});let r={ctx:e,current:null,token:null,hasCatch:!0,pending:Tt,then:At,catch:jt,value:35,error:42,blocks:[,,,]};return re(s=e[15],r),{c(){ue(t.$$.fragment),n=P(),i=x("table"),o=x("tbody"),r.block.c(),_(i,"class","table is-fullwidth")},m(e,s){de(t,e,s),y(e,n,s),y(e,i,s),$(i,o),r.block.m(o,r.anchor=null),r.mount=()=>o,r.anchor=null,l=!0},p(n,i){e=n;const o={};32&i[0]&&(o.nbOfPages=e[5]),t.$set(o),r.ctx=e,32768&i[0]&&s!==(s=e[15])&&re(s,r)||function(e,t,n){const i=t.slice(),{resolved:o}=e;e.current===e.then&&(i[e.value]=o),e.current===e.catch&&(i[e.error]=o),e.block.p(i,n)}(r,e,i)},i(e){l||(ie(t.$$.fragment,e),ie(r.block),l=!0)},o(e){oe(t.$$.fragment,e);for(let e=0;e<3;e+=1){oe(r.blocks[e])}l=!1},d(e){fe(t,e),e&&w(n),e&&w(i),r.block.d(),r.token=null,r=null}}}function _t(e){let t,n,i=[],o=new Map,s=Object.values(e[1]);const l=e=>e[32].id;for(let t=0;t<s.length;t+=1){let n=Lt(e,s,t),r=l(n);o.set(r,i[t]=zt(r,n))}let r=null;return s.length||(r=Ut(e)),{c(){t=x("div");for(let e=0;e<i.length;e+=1)i[e].c();r&&r.c(),_(t,"class","grid is-gap-2")},m(e,o){y(e,t,o);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);r&&r.m(t,null),n=!0},p(e,n){2099398&n[0]&&(s=Object.values(e[1]),te(),i=ae(i,n,l,1,e,s,o,t,ce,zt,null,Lt),ne(),!s.length&&r?r.p(e,n):s.length?r&&(te(),oe(r,1,1,(()=>{r=null})),ne()):(r=Ut(e),r.c(),ie(r,1),r.m(t,null)))},i(e){if(!n){for(let e=0;e<s.length;e+=1)ie(i[e]);n=!0}},o(e){for(let e=0;e<i.length;e+=1)oe(i[e]);n=!1},d(e){e&&w(t);for(let e=0;e<i.length;e+=1)i[e].d();r&&r.d()}}}function jt(t){let n,i,o,s=t[42]+"";return{c(){n=x("tr"),i=E("Error when retrieving paginated regions: "),o=E(s)},m(e,t){y(e,n,t),$(n,i),$(n,o)},p(e,t){32768&t[0]&&s!==(s=e[42]+"")&&j(o,s)},i:e,o:e,d(e){e&&w(n)}}}function At(e){let t,n,i,o,s;const l=[Rt,Vt],r=[];function c(e,n){return 65536&n[0]&&(t=null),null==t&&(t=!!(Object.values(e[16]).length>0)),t?0:1}return n=c(e,[-1,-1]),i=r[n]=l[n](e),{c(){i.c(),o=S()},m(e,t){r[n].m(e,t),y(e,o,t),s=!0},p(e,t){let s=n;n=c(e,t),n===s?r[n].p(e,t):(te(),oe(r[s],1,1,(()=>{r[s]=null})),ne(),i=r[n],i?i.p(e,t):(i=r[n]=l[n](e),i.c()),ie(i,1),i.m(o.parentNode,o))},i(e){s||(ie(i),s=!0)},o(e){oe(i),s=!1},d(e){r[n].d(e),e&&w(o)}}}function Vt(e){let t,n,i;return n=new nt({props:{appLang:e[2],modules:e[6],witness:e[7]}}),{c(){t=x("tr"),ue(n.$$.fragment)},m(e,o){y(e,t,o),de(n,t,null),i=!0},p(e,t){const i={};4&t[0]&&(i.appLang=e[2]),64&t[0]&&(i.modules=e[6]),128&t[0]&&(i.witness=e[7]),n.$set(i)},i(e){i||(ie(n.$$.fragment,e),i=!0)},o(e){oe(n.$$.fragment,e),i=!1},d(e){e&&w(t),fe(n)}}}function Rt(e){let t,n,i=Object.entries(e[16]),o=[];for(let t=0;t<i.length;t+=1)o[t]=Mt(kt(e,i,t));const s=e=>oe(o[e],1,1,(()=>{o[e]=null}));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=S()},m(e,i){for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(e,i);y(e,t,i),n=!0},p(e,n){if(3213324&n[0]){let l;for(i=Object.entries(e[16]),l=0;l<i.length;l+=1){const s=kt(e,i,l);o[l]?(o[l].p(s,n),ie(o[l],1)):(o[l]=Mt(s),o[l].c(),ie(o[l],1),o[l].m(t.parentNode,t))}for(te(),l=i.length;l<o.length;l+=1)s(l);ne()}},i(e){if(!n){for(let e=0;e<i.length;e+=1)ie(o[e]);n=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)oe(o[e]);n=!1},d(e){k(o,e),e&&w(t)}}}function It(e,t){let n,i,o;return i=new Ve({props:{item:t[32],appLang:t[2],isCopied:t[11](t[32])}}),i.$on("copyRef",t[21]),{key:e,first:null,c(){n=S(),ue(i.$$.fragment),this.first=n},m(e,t){y(e,n,t),de(i,e,t),o=!0},p(e,n){t=e;const o={};65536&n[0]&&(o.item=t[32]),4&n[0]&&(o.appLang=t[2]),67584&n[0]&&(o.isCopied=t[11](t[32])),i.$set(o)},i(e){o||(ie(i.$$.fragment,e),o=!0)},o(e){oe(i.$$.fragment,e),o=!1},d(e){e&&w(n),fe(i,e)}}}function Nt(e){let t,n,i=[],o=new Map,s=Object.values(e[37]);const l=e=>e[32].id;for(let t=0;t<s.length;t+=1){let n=xt(e,s,t),r=l(n);o.set(r,i[t]=It(r,n))}return{c(){for(let e=0;e<i.length;e+=1)i[e].c();t=P()},m(e,o){for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(e,o);y(e,t,o),n=!0},p(e,n){2164740&n[0]&&(s=Object.values(e[37]),te(),i=ae(i,n,l,1,e,s,o,t.parentNode,ce,It,t,xt),ne())},i(e){if(!n){for(let e=0;e<s.length;e+=1)ie(i[e]);n=!0}},o(e){for(let e=0;e<i.length;e+=1)oe(i[e]);n=!1},d(e){for(let t=0;t<i.length;t+=1)i[t].d(e);e&&w(t)}}}function Mt(e){let t,n;return t=new De({props:{canvasImg:e[20](e[36]),canvasNb:e[36],manifest:e[3],$$slots:{default:[Nt]},$$scope:{ctx:e}}}),{c(){ue(t.$$.fragment)},m(e,i){de(t,e,i),n=!0},p(e,n){const i={};65536&n[0]&&(i.canvasImg=e[20](e[36])),65536&n[0]&&(i.canvasNb=e[36]),8&n[0]&&(i.manifest=e[3]),67588&n[0]|32768&n[1]&&(i.$$scope={dirty:n,ctx:e}),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){oe(t.$$.fragment,e),n=!1},d(e){fe(t,e)}}}function Tt(t){let n;return{c(){n=x("tr"),n.textContent="Retrieving paginated regions...",_(n,"class","faded is-center")},m(e,t){y(e,n,t)},p:e,i:e,o:e,d(e){e&&w(n)}}}function Ut(e){let t,n;return t=new nt({props:{appLang:e[2],modules:e[6],witness:e[7]}}),{c(){ue(t.$$.fragment)},m(e,i){de(t,e,i),n=!0},p(e,n){const i={};4&n[0]&&(i.appLang=e[2]),64&n[0]&&(i.modules=e[6]),128&n[0]&&(i.witness=e[7]),t.$set(i)},i(e){n||(ie(t.$$.fragment,e),n=!0)},o(e){oe(t.$$.fragment,e),n=!1},d(e){fe(t,e)}}}function zt(e,t){let n,i,o;return i=new Ve({props:{item:t[32],appLang:t[2],isCopied:t[11](t[32])}}),i.$on("copyRef",t[21]),{key:e,first:null,c(){n=S(),ue(i.$$.fragment),this.first=n},m(e,t){y(e,n,t),de(i,e,t),o=!0},p(e,n){t=e;const o={};2&n[0]&&(o.item=t[32]),4&n[0]&&(o.appLang=t[2]),2050&n[0]&&(o.isCopied=t[11](t[32])),i.$set(o)},i(e){o||(ie(i.$$.fragment,e),o=!0)},o(e){oe(i.$$.fragment,e),o=!1},d(e){e&&w(n),fe(i,e)}}}function Ht(e){let t,n,i="en"===e[2]?"No regions in selection":"Aucune région sélectionnée";return{c(){t=x("div"),n=E(i)},m(e,i){y(e,t,i),$(t,n)},p(e,t){4&t[0]&&i!==(i="en"===e[2]?"No regions in selection":"Aucune région sélectionnée")&&j(n,i)},d(e){e&&w(t)}}}function Dt(e){let t,n,i=Object.entries(e[9]),o=[];for(let t=0;t<i.length;t+=1)o[t]=Bt(wt(e,i,t));return{c(){t=x("div"),n=x("div");for(let e=0;e<o.length;e+=1)o[e].c();_(n,"class","grid is-gap-2"),_(t,"class","fixed-grid has-6-cols")},m(e,i){y(e,t,i),$(t,n);for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(n,null)},p(e,t){if(513&t[0]){let s;for(i=Object.entries(e[9]),s=0;s<i.length;s+=1){const l=wt(e,i,s);o[s]?o[s].p(l,t):(o[s]=Bt(l),o[s].c(),o[s].m(n,null))}for(;s<o.length;s+=1)o[s].d(1);o.length=i.length}},d(e){e&&w(t),k(o,e)}}}function Bt(e){let t,n,i,o,s,l,r,a,u,d,f,p,g,m=e[29].title+"";function h(){return e[26](e[28])}return{c(){t=x("div"),n=x("figure"),i=x("img"),s=P(),l=x("div"),r=x("span"),a=E(m),u=P(),d=x("button"),f=P(),c(i.src,o=he(e[29].img,e[29].xyhw,"96,"))||_(i,"src",o),_(i,"alt","Extracted region"),_(r,"class","overlay-desc"),_(l,"class","overlay is-center svelte-1v1cdjv"),_(n,"class","image is-64x64 card"),_(d,"class","delete region-btn"),_(d,"aria-label","remove from selection"),_(t,"class","selection cell svelte-1v1cdjv")},m(e,o){y(e,t,o),$(t,n),$(n,i),$(n,s),$(n,l),$(l,r),$(r,a),$(t,u),$(t,d),$(t,f),p||(g=O(d,"click",h),p=!0)},p(t,n){e=t,512&n[0]&&!c(i.src,o=he(e[29].img,e[29].xyhw,"96,"))&&_(i,"src",o),512&n[0]&&m!==(m=e[29].title+"")&&j(a,m)},d(e){e&&w(t),p=!1,g()}}}function qt(e){let t,n,i,o,s,l,r,c,a,u,d,f,p,g,m,h,b,v,L,S,O,C,A,V,R,I,N,M,T,U,z,H,D,B,q,F="en"===e[2]?"Selected regions":"Regions sélectionnées";t=new We({props:{appLang:e[2]}}),i=new Ne({props:{selectionLength:e[8],appLang:e[2]}}),r=new ut({props:{appLang:e[2],witness:e[7],baseUrl:e[12]}}),a=new yt({props:{appLang:e[2],manifest:e[3],isValidated:e[4],regions:e[1],regionsType:e[0]}});let G=Object.entries(e[10]),J=[];for(let t=0;t<G.length;t+=1)J[t]=Pt(Et(e,G,t));const X=[_t,Ct,Ot,St],K=[];function Y(e,t){return"all"===e[13]?0:"page"===e[13]?1:"similarity"===e[13]?2:"vectorization"===e[13]?3:-1}function Q(e,t){return e[14]?Dt:Ht}~(g=Y(e))&&(m=K[g]=X[g](e));let W=Q(e),Z=W(e);return B=new Ue({props:{appLang:e[2],isRegion:!0}}),{c(){ue(t.$$.fragment),n=P(),ue(i.$$.fragment),o=P(),s=x("div"),l=x("div"),ue(r.$$.fragment),c=P(),ue(a.$$.fragment),u=P(),d=x("div"),f=x("ul");for(let e=0;e<J.length;e+=1)J[e].c();p=P(),m&&m.c(),h=P(),b=x("div"),v=x("div"),L=P(),S=x("div"),O=x("div"),C=x("div"),A=x("i"),V=P(),R=E(F),I=E("\n                ("),N=E(e[8]),M=E(")"),T=P(),U=x("button"),z=P(),H=x("section"),Z.c(),D=P(),ue(B.$$.fragment),_(l,"class","center-flex actions svelte-1v1cdjv"),_(f,"class","panel-tabs"),_(d,"class","tabs is-centered"),_(s,"id","nav-actions"),_(s,"class","mb-5 svelte-1v1cdjv"),_(v,"class","modal-background"),_(A,"class","fa-solid fa-book-bookmark"),_(C,"class","title is-4 mb-0 media-content"),_(U,"class","delete media-left"),_(U,"aria-label","close"),_(O,"class","modal-card-head media mb-0"),_(H,"class","modal-card-body"),_(S,"class","modal-content"),_(b,"id","selection-modal"),_(b,"class","modal fade"),_(b,"tabindex","-1"),_(b,"aria-labelledby","selection-modal-label"),_(b,"aria-hidden","true")},m(e,m){de(t,e,m),y(e,n,m),de(i,e,m),y(e,o,m),y(e,s,m),$(s,l),de(r,l,null),$(l,c),de(a,l,null),$(s,u),$(s,d),$(d,f);for(let e=0;e<J.length;e+=1)J[e]&&J[e].m(f,null);y(e,p,m),~g&&K[g].m(e,m),y(e,h,m),y(e,b,m),$(b,v),$(b,L),$(b,S),$(S,O),$(O,C),$(C,A),$(C,V),$(C,R),$(C,I),$(C,N),$(C,M),$(O,T),$(O,U),$(S,z),$(S,H),Z.m(H,null),$(S,D),de(B,S,null),q=!0},p(e,n){const o={};4&n[0]&&(o.appLang=e[2]),t.$set(o);const s={};256&n[0]&&(s.selectionLength=e[8]),4&n[0]&&(s.appLang=e[2]),i.$set(s);const l={};4&n[0]&&(l.appLang=e[2]),128&n[0]&&(l.witness=e[7]),4096&n[0]&&(l.baseUrl=e[12]),r.$set(l);const c={};if(4&n[0]&&(c.appLang=e[2]),8&n[0]&&(c.manifest=e[3]),16&n[0]&&(c.isValidated=e[4]),2&n[0]&&(c.regions=e[1]),a.$set(c),9216&n[0]){let t;for(G=Object.entries(e[10]),t=0;t<G.length;t+=1){const i=Et(e,G,t);J[t]?J[t].p(i,n):(J[t]=Pt(i),J[t].c(),J[t].m(f,null))}for(;t<J.length;t+=1)J[t].d(1);J.length=G.length}let u=g;g=Y(e),g===u?~g&&K[g].p(e,n):(m&&(te(),oe(K[u],1,1,(()=>{K[u]=null})),ne()),~g?(m=K[g],m?m.p(e,n):(m=K[g]=X[g](e),m.c()),ie(m,1),m.m(h.parentNode,h)):m=null),(!q||4&n[0])&&F!==(F="en"===e[2]?"Selected regions":"Regions sélectionnées")&&j(R,F),(!q||256&n[0])&&j(N,e[8]),W===(W=Q(e))&&Z?Z.p(e,n):(Z.d(1),Z=W(e),Z&&(Z.c(),Z.m(H,null)));const d={};4&n[0]&&(d.appLang=e[2]),B.$set(d)},i(e){q||(ie(t.$$.fragment,e),ie(i.$$.fragment,e),ie(r.$$.fragment,e),ie(a.$$.fragment,e),ie(m),ie(B.$$.fragment,e),q=!0)},o(e){oe(t.$$.fragment,e),oe(i.$$.fragment,e),oe(r.$$.fragment,e),oe(a.$$.fragment,e),oe(m),oe(B.$$.fragment,e),q=!1},d(e){fe(t,e),e&&w(n),fe(i,e),e&&w(o),e&&w(s),fe(r),fe(a),k(J,e),e&&w(p),~g&&K[g].d(e),e&&w(h),e&&w(b),Z.d(),fe(B)}}}const Ft=()=>null;function Gt(e,t,n){let i,o,s,l,r,c,a,d,f,p;const{selected:g}=xe;u(e,g,(e=>n(24,d=e)));const{pageRegions:m,fetchPages:h}=Le;u(e,m,(e=>n(16,p=e))),u(e,h,(e=>n(15,f=e)));const $="Regions";let{regions:b={}}=t,{appLang:v="en"}=t,{manifest:y=""}=t,{isValidated:w=!1}=t,{imgPrefix:k=""}=t,{nbOfPages:x=1}=t,{modules:L=[]}=t,{witness:E={}}=t;const P={all:{text:"en"===v?"All regions":"Toutes les régions"},page:{text:"en"===v?"Per page":"Par page"}};L.includes("similarity")&&(P.similarity={text:"en"===v?"Similarity":"Similarité"}),L.includes("vectorization")&&(P.vectorization={text:"en"===v?"Vectorization":"Vectorisation"});return e.$$set=e=>{"regions"in e&&n(1,b=e.regions),"appLang"in e&&n(2,v=e.appLang),"manifest"in e&&n(3,y=e.manifest),"isValidated"in e&&n(4,w=e.isValidated),"imgPrefix"in e&&n(22,k=e.imgPrefix),"nbOfPages"in e&&n(5,x=e.nbOfPages),"modules"in e&&n(6,L=e.modules),"witness"in e&&n(7,E=e.witness)},e.$$.update=()=>{16777216&e.$$.dirty[0]&&n(9,i=d(!0)),512&e.$$.dirty[0]&&n(8,o=Object.keys(i).length),256&e.$$.dirty[0]&&n(14,s=o>0),8388608&e.$$.dirty[0]&&n(11,a=e=>c===e.ref)},n(13,l="all"),n(12,r=`${window.location.origin}${window.location.pathname}`),n(23,c=""),[$,b,v,y,w,x,L,E,o,i,P,a,r,l,s,f,p,g,m,h,function(e){return`${k}_${t=e,n=String(x).length+1,t.toString().padStart(n,"0")}`;var t,n},function(e){const{item:t}=e.detail,i=a(t)?"":t.ref;navigator.clipboard.writeText(i),n(23,c=i)},k,c,d,e=>n(13,l=e),e=>xe.remove(e,$)]}var Jt;return new class extends me{constructor(e){super(),ge(this,e,Gt,qt,l,{regionsType:0,regions:1,appLang:2,manifest:3,isValidated:4,imgPrefix:22,nbOfPages:5,modules:6,witness:7},null,[-1,-1])}get regionsType(){return this.$$.ctx[0]}}({target:document.getElementById("region-list"),props:{witness:witness,regions:(Jt="regions-data",document.getElementById(Jt)?JSON.parse(document.getElementById(Jt).textContent):[]),regionsType:"Regions",appLang:APP_LANG,modules:ADDITIONAL_MODULES,manifest:manifest,isValidated:isValidated,imgPrefix:imgPrefix,nbOfPages:nbOfPages}})}();
//# sourceMappingURL=regionList.js.map
