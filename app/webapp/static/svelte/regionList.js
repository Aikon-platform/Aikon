var regionList=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function c(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let r,l;function s(t,e){return r||(r=document.createElement("a")),r.href=e,t===r.href}function a(t,e){t.appendChild(e)}function u(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode&&t.parentNode.removeChild(t)}function f(t){return document.createElement(t)}function p(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function g(t){return document.createTextNode(t)}function m(){return g(" ")}function h(){return g("")}function $(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function b(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function y(t,e){e=""+e,t.data!==e&&(t.data=e)}function v(t,e,n){t.classList[n?"add":"remove"](e)}function k(t){l=t}function w(){const t=function(){if(!l)throw new Error("Function called outside component initialization");return l}();return(e,n,{cancelable:o=!1}={})=>{const c=t.$$.callbacks[e];if(c){const i=function(t,e,{bubbles:n=!1,cancelable:o=!1}={}){const c=document.createEvent("CustomEvent");return c.initCustomEvent(t,n,o,e),c}(e,n,{cancelable:o});return c.slice().forEach((e=>{e.call(t,i)})),!i.defaultPrevented}return!0}}const x=[],L=[];let S=[];const _=[],A=Promise.resolve();let E=!1;function O(t){S.push(t)}const N=new Set;let j=0;function C(){if(0!==j)return;const t=l;do{try{for(;j<x.length;){const t=x[j];j++,k(t),P(t.$$)}}catch(t){throw x.length=0,j=0,t}for(k(null),x.length=0,j=0;L.length;)L.pop()();for(let t=0;t<S.length;t+=1){const e=S[t];N.has(e)||(N.add(e),e())}S.length=0}while(x.length);for(;_.length;)_.pop()();E=!1,N.clear(),k(t)}function P(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(O)}}const T=new Set;let V;function I(){V={r:0,c:[],p:V}}function M(){V.r||o(V.c),V=V.p}function B(t,e){t&&t.i&&(T.delete(t),t.i(e))}function R(t,e,n,o){if(t&&t.o){if(T.has(t))return;T.add(t),V.c.push((()=>{T.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}else o&&o()}function z(t,e){R(t,1,1,(()=>{e.delete(t.key)}))}function H(t){t&&t.c()}function J(t,n,i,r){const{fragment:l,after_update:s}=t.$$;l&&l.m(n,i),r||O((()=>{const n=t.$$.on_mount.map(e).filter(c);t.$$.on_destroy?t.$$.on_destroy.push(...n):o(n),t.$$.on_mount=[]})),s.forEach(O)}function U(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];S.forEach((o=>-1===t.indexOf(o)?e.push(o):n.push(o))),n.forEach((t=>t())),S=e}(n.after_update),o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function q(t,e){-1===t.$$.dirty[0]&&(x.push(t),E||(E=!0,A.then(C)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function F(e,c,i,r,s,a,u,f=[-1]){const p=l;k(e);const g=e.$$={fragment:null,ctx:[],props:a,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(c.context||(p?p.$$.context:[])),callbacks:n(),dirty:f,skip_bound:!1,root:c.target||p.$$.root};u&&u(g.root);let m=!1;if(g.ctx=i?i(e,c.props||{},((t,n,...o)=>{const c=o.length?o[0]:n;return g.ctx&&s(g.ctx[t],g.ctx[t]=c)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](c),m&&q(e,t)),n})):[],g.update(),m=!0,o(g.before_update),g.fragment=!!r&&r(g.ctx),c.target){if(c.hydrate){const t=function(t){return Array.from(t.childNodes)}(c.target);g.fragment&&g.fragment.l(t),t.forEach(d)}else g.fragment&&g.fragment.c();c.intro&&B(e.$$.fragment),J(e,c.target,c.anchor,c.customElement),C()}k(p)}class G{$destroy(){U(this,1),this.$destroy=t}$on(e,n){if(!c(n))return t;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function D(t=null,e="full",n="full"){if(!t)return"https://via.placeholder.com/96x96?text=No+Image";if((t=t.split("_")).length<3)return"https://via.placeholder.com/96x96?text=No+Image";const o=t[t.length-1].includes(",")?t.pop().replace(".jpg",""):e,c=t.join("_").replace(".jpg","");return`${CANTALOUPE_APP_URL??"http://localhost:8182"}/iiif/2/${c}.jpg/${o}/${n}/0/default.jpg`}function K(t){let e;return{c(){e=p("path"),b(e,"fill","currentColor"),b(e,"d","M0 48C0 21.5 21.5 0 48 0l0 48V441.4l130.1-92.9c8.3-6 19.6-6 27.9 0L336 441.4V48H48V0H336c26.5 0 48 21.5 48 48V488c0 9-5 17.2-13 21.3s-17.6 3.4-24.9-1.8L192 397.5 37.9 507.5c-7.3 5.2-16.9 5.9-24.9 1.8S0 497 0 488V48z"),b(e,"class","svelte-13ytpws")},m(t,n){u(t,e,n)},d(t){t&&d(e)}}}function Q(t){let e;return{c(){e=p("path"),b(e,"fill","currentColor"),b(e,"d","M0 48V487.7C0 501.1 10.9 512 24.3 512c5 0 9.9-1.5 14-4.4L192 400 345.7 507.6c4.1 2.9 9 4.4 14 4.4c13.4 0 24.3-10.9 24.3-24.3V48c0-26.5-21.5-48-48-48H48C21.5 0 0 21.5 0 48z"),b(e,"class","svelte-13ytpws")},m(t,n){u(t,e,n)},d(t){t&&d(e)}}}function W(e){let n,c,i,r,l,g,h,y,v,k,w;function x(t,e){return t[1]?Q:K}let L=x(e),S=L(e);return{c(){n=f("div"),c=f("figure"),i=f("img"),g=m(),h=f("button"),y=p("svg"),S.c(),s(i.src,r=D(e[0].metadata.img,e[0].metadata.xyhw,"96,"))||b(i,"src",r),b(i,"alt","Extracted region"),b(c,"id",l="region-"+e[0].id),b(c,"class","image is-96x96 card svelte-13ytpws"),b(y,"xmlns","http://www.w3.org/2000/svg"),b(y,"viewBox","0 0 384 512"),b(y,"class","svelte-13ytpws"),b(h,"class","button check-btn tag svelte-13ytpws"),b(n,"class",v="region image is-96x96 "+(e[1]?"checked":"")+" svelte-13ytpws"),b(n,"tabindex","-1")},m(t,o){u(t,n,o),a(n,c),a(c,i),a(n,g),a(n,h),a(h,y),S.m(y,null),k||(w=[$(n,"click",e[3]),$(n,"keyup",e[4])],k=!0)},p(t,[e]){1&e&&!s(i.src,r=D(t[0].metadata.img,t[0].metadata.xyhw,"96,"))&&b(i,"src",r),1&e&&l!==(l="region-"+t[0].id)&&b(c,"id",l),L!==(L=x(t))&&(S.d(1),S=L(t),S&&(S.c(),S.m(y,null))),2&e&&v!==(v="region image is-96x96 "+(t[1]?"checked":"")+" svelte-13ytpws")&&b(n,"class",v)},i:t,o:t,d(t){t&&d(n),S.d(),k=!1,o(w)}}}function X(t,e,n){const o=w();function c(t){o("toggleSelection",{block:t})}let{block:i}=e,{isSelected:r=!1}=e;return t.$$set=t=>{"block"in t&&n(0,i=t.block),"isSelected"in t&&n(1,r=t.isSelected)},[i,r,c,()=>c(i),t=>"Enter"===t.key&&c(i)]}class Y extends G{constructor(t){super(),F(this,t,X,W,i,{block:0,isSelected:1})}}function Z(t){localStorage.setItem("documentSet",JSON.stringify(t))}function tt(e){let n,o,c,i,r,l,s,p,h,$,k="en"===e[3]?"Selection":"Sélection";return{c(){n=f("div"),o=f("button"),c=f("span"),i=f("i"),r=m(),l=g(k),s=g("\n            ("),p=f("span"),h=g(e[2]),$=g(")"),b(i,"class","fa-solid fa-book-bookmark"),b(p,"id","selection-count"),b(p,"class","svelte-1ifntk3"),b(c,"class","svelte-1ifntk3"),b(o,"id","set-btn"),b(o,"class","button px-5 py-4 is-link js-modal-trigger svelte-1ifntk3"),b(o,"data-target","selection-modal"),v(o,"add-animation",e[0]),v(o,"remove-animation",e[1]),b(n,"class","set-container svelte-1ifntk3")},m(t,e){u(t,n,e),a(n,o),a(o,c),a(c,i),a(c,r),a(c,l),a(c,s),a(c,p),a(p,h),a(c,$)},p(t,[e]){8&e&&k!==(k="en"===t[3]?"Selection":"Sélection")&&y(l,k),4&e&&y(h,t[2]),1&e&&v(o,"add-animation",t[0]),2&e&&v(o,"remove-animation",t[1])},i:t,o:t,d(t){t&&d(n)}}}function et(t,e,n){let{addAnimation:o=!1}=e,{removeAnimation:c=!1}=e,{selectionLength:i=0}=e,{appLang:r="en"}=e;return t.$$set=t=>{"addAnimation"in t&&n(0,o=t.addAnimation),"removeAnimation"in t&&n(1,c=t.removeAnimation),"selectionLength"in t&&n(2,i=t.selectionLength),"appLang"in t&&n(3,r=t.appLang)},[o,c,i,r]}class nt extends G{constructor(t){super(),F(this,t,et,tt,i,{addAnimation:0,removeAnimation:1,selectionLength:2,appLang:3})}}function ot(e){let n,c,i,r,l,s,p,h,v,k,w,x="en"===e[0]?"Clear selection":"Vider la sélection",L="en"===e[0]?"Save selection":"Sauvegarder la sélection";return{c(){n=f("footer"),c=f("div"),i=f("button"),r=g(x),l=m(),s=f("button"),p=f("i"),h=m(),v=g(L),b(i,"class","button is-link is-light"),b(p,"class","fa-solid fa-floppy-disk"),b(s,"class","button is-link"),b(c,"class","buttons"),b(n,"class","modal-card-foot is-centered")},m(t,o){u(t,n,o),a(n,c),a(c,i),a(i,r),a(c,l),a(c,s),a(s,p),a(s,h),a(s,v),k||(w=[$(i,"click",e[2]),$(s,"click",e[3])],k=!0)},p(t,[e]){1&e&&x!==(x="en"===t[0]?"Clear selection":"Vider la sélection")&&y(r,x),1&e&&L!==(L="en"===t[0]?"Save selection":"Sauvegarder la sélection")&&y(v,L)},i:t,o:t,d(t){t&&d(n),k=!1,o(w)}}}function ct(t,e,n){const o=w();function c(t="save"){o("commitSelection",{updateType:t})}let{appLang:i="en"}=e;return t.$$set=t=>{"appLang"in t&&n(0,i=t.appLang)},[i,c,()=>c("clear"),()=>c("save")]}class it extends G{constructor(t){super(),F(this,t,ct,ot,i,{appLang:0})}}function rt(t,e,n){const o=t.slice();return o[13]=e[n][0],o[14]=e[n][1],o}function lt(t,e,n){const o=t.slice();return o[17]=e[n],o}function st(t){let e,n,c,i=[],r=new Map,l=t[1];const s=t=>t[17].id;for(let e=0;e<l.length;e+=1){let n=lt(t,l,e),o=s(n);r.set(o,i[e]=ut(o,n))}let p=null;return l.length||(p=at()),{c(){e=f("div"),n=f("div");for(let t=0;t<i.length;t+=1)i[t].c();p&&p.c(),b(n,"class","grid is-gap-2"),b(e,"class","fixed-grid has-auto-count")},m(t,o){u(t,e,o),a(e,n);for(let t=0;t<i.length;t+=1)i[t]&&i[t].m(n,null);p&&p.m(n,null),c=!0},p(t,e){1094&e&&(l=t[1],I(),i=function(t,e,n,c,i,r,l,s,a,u,d,f){let p=t.length,g=r.length,m=p;const h={};for(;m--;)h[t[m].key]=m;const $=[],b=new Map,y=new Map,v=[];for(m=g;m--;){const t=f(i,r,m),o=n(t);let s=l.get(o);s?c&&v.push((()=>s.p(t,e))):(s=u(o,t),s.c()),b.set(o,$[m]=s),o in h&&y.set(o,Math.abs(m-h[o]))}const k=new Set,w=new Set;function x(t){B(t,1),t.m(s,d),l.set(t.key,t),d=t.first,g--}for(;p&&g;){const e=$[g-1],n=t[p-1],o=e.key,c=n.key;e===n?(d=e.first,p--,g--):b.has(c)?!l.has(o)||k.has(o)?x(e):w.has(c)?p--:y.get(o)>y.get(c)?(w.add(o),x(e)):(k.add(c),p--):(a(n,l),p--)}for(;p--;){const e=t[p];b.has(e.key)||a(e,l)}for(;g;)x($[g-1]);return o(v),$}(i,e,s,1,t,l,r,n,z,ut,null,lt),M(),l.length?p&&(p.d(1),p=null):p||(p=at(),p.c(),p.m(n,null)))},i(t){if(!c){for(let t=0;t<l.length;t+=1)B(i[t]);c=!0}},o(t){for(let t=0;t<i.length;t+=1)R(i[t]);c=!1},d(t){t&&d(e);for(let t=0;t<i.length;t+=1)i[t].d();p&&p.d()}}}function at(e){return{c:t,m:t,d:t}}function ut(t,e){let n,o,c;return o=new Y({props:{block:e[17],appLang:e[2],isSelected:e[6](e[17])}}),o.$on("toggleSelection",e[10]),{key:t,first:null,c(){n=h(),H(o.$$.fragment),this.first=n},m(t,e){u(t,n,e),J(o,t,e),c=!0},p(t,n){e=t;const c={};2&n&&(c.block=e[17]),4&n&&(c.appLang=e[2]),66&n&&(c.isSelected=e[6](e[17])),o.$set(c)},i(t){c||(B(o.$$.fragment,t),c=!0)},o(t){R(o.$$.fragment,t),c=!1},d(t){t&&d(n),U(o,t)}}}function dt(t){let e,n,o,c="en"===t[2]?"No regions in selection":"Aucune région sélectionnée";return{c(){e=f("tr"),n=f("td"),o=g(c)},m(t,c){u(t,e,c),a(e,n),a(n,o)},p(t,e){4&e&&c!==(c="en"===t[2]?"No regions in selection":"Aucune région sélectionnée")&&y(o,c)},d(t){t&&d(e)}}}function ft(t){let e,n=Object.entries(t[3][t[0]]),o=[];for(let e=0;e<n.length;e+=1)o[e]=pt(rt(t,n,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=h()},m(t,n){for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,n);u(t,e,n)},p(t,c){if(521&c){let i;for(n=Object.entries(t[3][t[0]]),i=0;i<n.length;i+=1){const r=rt(t,n,i);o[i]?o[i].p(r,c):(o[i]=pt(r),o[i].c(),o[i].m(e.parentNode,e))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}},d(t){!function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(o,t),t&&d(e)}}}function pt(t){let e,n,o,c,i,r,l,s,p,h,v,k,w,x,L,S,_=t[13]+"",A=t[14].title+"";function E(){return t[11](t[13])}return{c(){e=f("tr"),n=f("th"),o=f("span"),c=g("#"),i=g(_),r=m(),l=f("td"),s=f("a"),p=g(A),v=m(),k=f("td"),w=f("button"),x=m(),b(o,"class","tag px-2 py-1 mb-1 is-dark is-rounded"),b(n,"class","is-narrow is-3"),b(s,"href",h=t[14].url),b(s,"target","_blank"),b(w,"class","delete"),b(w,"aria-label","close"),b(k,"class","is-narrow")},m(t,d){u(t,e,d),a(e,n),a(n,o),a(o,c),a(o,i),a(e,r),a(e,l),a(l,s),a(s,p),a(e,v),a(e,k),a(k,w),a(e,x),L||(S=$(w,"click",E),L=!0)},p(e,n){t=e,8&n&&_!==(_=t[13]+"")&&y(i,_),8&n&&A!==(A=t[14].title+"")&&y(p,A),8&n&&h!==(h=t[14].url)&&b(s,"href",h)},d(t){t&&d(e),L=!1,S()}}}function gt(t){let e,n,o,c,i,r,l,s,p,h,$,v,k,w,x,L,S,_,A,E,O,N,j,C,P,T,V="en"===t[2]?"Selected regions":"Regions sélectionnées";e=new nt({props:{addAnimation:t[4],removeAnimation:t[5],selectionLength:t[7],appLang:t[2]}});let z=0!==t[1].length&&st(t);function q(t,e){return 8&e&&(j=null),null==j&&(j=!!(t[3].hasOwnProperty(t[0])&&Object.keys(t[3][t[0]]).length>0)),j?ft:dt}let F=q(t,-1),G=F(t);return P=new it({props:{appLang:t[2]}}),P.$on("commitSelection",t[8]),{c(){H(e.$$.fragment),n=m(),z&&z.c(),o=m(),c=f("div"),i=f("div"),r=m(),l=f("div"),s=f("div"),p=f("div"),h=f("i"),$=m(),v=g(V),k=g("\n                ("),w=f("span"),x=g(t[7]),L=g(")"),S=m(),_=f("button"),A=m(),E=f("section"),O=f("table"),N=f("tbody"),G.c(),C=m(),H(P.$$.fragment),b(i,"class","modal-background"),b(h,"class","fa-solid fa-book-bookmark"),b(w,"id","selection-count"),b(p,"class","title is-4 mb-0 media-content"),b(_,"class","delete media-left"),b(_,"aria-label","close"),b(s,"class","modal-card-head media mb-0"),b(O,"class","table pl-2 is-fullwidth"),b(E,"class","modal-card-body"),b(l,"class","modal-content"),b(c,"id","selection-modal"),b(c,"class","modal fade"),b(c,"tabindex","-1"),b(c,"aria-labelledby","selection-modal-label"),b(c,"aria-hidden","true")},m(t,d){J(e,t,d),u(t,n,d),z&&z.m(t,d),u(t,o,d),u(t,c,d),a(c,i),a(c,r),a(c,l),a(l,s),a(s,p),a(p,h),a(p,$),a(p,v),a(p,k),a(p,w),a(w,x),a(p,L),a(s,S),a(s,_),a(l,A),a(l,E),a(E,O),a(O,N),G.m(N,null),a(l,C),J(P,l,null),T=!0},p(t,[n]){const c={};16&n&&(c.addAnimation=t[4]),32&n&&(c.removeAnimation=t[5]),128&n&&(c.selectionLength=t[7]),4&n&&(c.appLang=t[2]),e.$set(c),0!==t[1].length?z?(z.p(t,n),2&n&&B(z,1)):(z=st(t),z.c(),B(z,1),z.m(o.parentNode,o)):z&&(I(),R(z,1,1,(()=>{z=null})),M()),(!T||4&n)&&V!==(V="en"===t[2]?"Selected regions":"Regions sélectionnées")&&y(v,V),(!T||128&n)&&y(x,t[7]),F===(F=q(t,n))&&G?G.p(t,n):(G.d(1),G=F(t),G&&(G.c(),G.m(N,null)));const i={};4&n&&(i.appLang=t[2]),P.$set(i)},i(t){T||(B(e.$$.fragment,t),B(z),B(P.$$.fragment,t),T=!0)},o(t){R(e.$$.fragment,t),R(z),R(P.$$.fragment,t),T=!1},d(t){U(e,t),t&&d(n),z&&z.d(t),t&&d(o),t&&d(c),G.d(),U(P)}}}function mt(t,e,n){let o,c,i=!1,r=!1;const l="Regions";let{regions:s=[]}=e,{appLang:a="en"}=e,u=JSON.parse(localStorage.getItem("documentSet"))??{};function d(t){n(3,u=function(t,e,n){const{[e]:o,...c}=t[n];return t[n]=c,Z(t),t}(u,t,l)),n(5,r=!0),setTimeout((()=>n(5,r=!1)),300)}function f(t){n(3,u=function(t,e){return t.hasOwnProperty(e.type)||(t[e.type]=[]),t[e.type]={...t[e.type],[e.id]:e},Z(t),t}(u,t)),n(4,i=!0),setTimeout((()=>n(4,i=!1)),300)}return t.$$set=t=>{"regions"in t&&n(1,s=t.regions),"appLang"in t&&n(2,a=t.appLang)},t.$$.update=()=>{8&t.$$.dirty&&n(7,o=u.hasOwnProperty(l)?Object.keys(u[l]).length:0),8&t.$$.dirty&&n(6,c=t=>u[l]?.hasOwnProperty(t.id))},[l,s,a,u,i,r,c,o,function(t){const{updateType:e}=t.detail;"clear"===e?n(3,u=function(t,e){return e.map((e=>!t.hasOwnProperty(e)||delete t[e])),Z(t),t}(u,[l])):"save"===e&&n(3,u=function(t){return console.log(t),t}(u))},d,function(t){const{block:e}=t.detail;c(e)?d(e.id):f(e)},t=>d(t)]}const ht=($t="regions-data",document.getElementById($t)?JSON.parse(document.getElementById($t).textContent):[]);var $t;APP_LANG;return new class extends G{constructor(t){super(),F(this,t,mt,gt,i,{regionsType:0,regions:1,appLang:2})}get regionsType(){return this.$$.ctx[0]}}({target:document.getElementById("region-list"),props:{regions:ht,regionsType:"Regions"}})}();
//# sourceMappingURL=regionList.js.map
