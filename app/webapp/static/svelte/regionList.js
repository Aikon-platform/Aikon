var regionList=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function l(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let c,s;function r(t,e){return c||(c=document.createElement("a")),c.href=e,t===c.href}function a(t,e,n,l){return t[1]&&l?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](l(e))):n.ctx}function u(t,e){t.appendChild(e)}function d(t,e,n){t.insertBefore(e,n||null)}function f(t){t.parentNode&&t.parentNode.removeChild(t)}function p(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function g(t){return document.createElement(t)}function m(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function h(t){return document.createTextNode(t)}function b(){return h(" ")}function v(){return h("")}function $(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function k(t){return function(e){return e.preventDefault(),t.call(this,e)}}function y(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function x(t,e){e=""+e,t.data!==e&&(t.data=e)}function w(t,e,n){t.classList[n?"add":"remove"](e)}function L(t){s=t}function S(){if(!s)throw new Error("Function called outside component initialization");return s}function E(){const t=S();return(e,n,{cancelable:l=!1}={})=>{const o=t.$$.callbacks[e];if(o){const i=function(t,e,{bubbles:n=!1,cancelable:l=!1}={}){const o=document.createEvent("CustomEvent");return o.initCustomEvent(t,n,l,e),o}(e,n,{cancelable:l});return o.slice().forEach((e=>{e.call(t,i)})),!i.defaultPrevented}return!0}}const N=[],C=[];let O=[];const P=[],A=Promise.resolve();let j=!1;function _(t){O.push(t)}const I=new Set;let V=0;function T(){if(0!==V)return;const t=s;do{try{for(;V<N.length;){const t=N[V];V++,L(t),z(t.$$)}}catch(t){throw N.length=0,V=0,t}for(L(null),N.length=0,V=0;C.length;)C.pop()();for(let t=0;t<O.length;t+=1){const e=O[t];I.has(e)||(I.add(e),e())}O.length=0}while(N.length);for(;P.length;)P.pop()();j=!1,I.clear(),L(t)}function z(t){if(null!==t.fragment){t.update(),l(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(_)}}const M=new Set;let H;function R(){H={r:0,c:[],p:H}}function B(){H.r||l(H.c),H=H.p}function D(t,e){t&&t.i&&(M.delete(t),t.i(e))}function U(t,e,n,l){if(t&&t.o){if(M.has(t))return;M.add(t),H.c.push((()=>{M.delete(t),l&&(n&&t.d(1),l())})),t.o(e)}else l&&l()}function q(t,e){const n=e.token={};function l(t,l,o,i){if(e.token!==n)return;e.resolved=i;let c=e.ctx;void 0!==o&&(c=c.slice(),c[o]=i);const s=t&&(e.current=t)(c);let r=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==l&&t&&(R(),U(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),B())})):e.block.d(1),s.c(),D(s,1),s.m(e.mount(),e.anchor),r=!0),e.block=s,e.blocks&&(e.blocks[l]=s),r&&T()}if(!(o=t)||"object"!=typeof o&&"function"!=typeof o||"function"!=typeof o.then){if(e.current!==e.then)return l(e.then,1,e.value,t),!0;e.resolved=t}else{const n=S();if(t.then((t=>{L(n),l(e.then,1,e.value,t),L(null)}),(t=>{if(L(n),l(e.catch,2,e.error,t),L(null),!e.hasCatch)throw t})),e.current!==e.pending)return l(e.pending,0),!0}var o}function F(t,e){U(t,1,1,(()=>{e.delete(t.key)}))}function G(t,e,n,o,i,c,s,r,a,u,d,f){let p=t.length,g=c.length,m=p;const h={};for(;m--;)h[t[m].key]=m;const b=[],v=new Map,$=new Map,k=[];for(m=g;m--;){const t=f(i,c,m),l=n(t);let r=s.get(l);r?o&&k.push((()=>r.p(t,e))):(r=u(l,t),r.c()),v.set(l,b[m]=r),l in h&&$.set(l,Math.abs(m-h[l]))}const y=new Set,x=new Set;function w(t){D(t,1),t.m(r,d),s.set(t.key,t),d=t.first,g--}for(;p&&g;){const e=b[g-1],n=t[p-1],l=e.key,o=n.key;e===n?(d=e.first,p--,g--):v.has(o)?!s.has(l)||y.has(l)?w(e):x.has(o)?p--:$.get(l)>$.get(o)?(x.add(l),w(e)):(y.add(o),p--):(a(n,s),p--)}for(;p--;){const e=t[p];v.has(e.key)||a(e,s)}for(;g;)w(b[g-1]);return l(k),b}function J(t){t&&t.c()}function K(t,n,i,c){const{fragment:s,after_update:r}=t.$$;s&&s.m(n,i),c||_((()=>{const n=t.$$.on_mount.map(e).filter(o);t.$$.on_destroy?t.$$.on_destroy.push(...n):l(n),t.$$.on_mount=[]})),r.forEach(_)}function Q(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];O.forEach((l=>-1===t.indexOf(l)?e.push(l):n.push(l))),n.forEach((t=>t())),O=e}(n.after_update),l(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function W(t,e){-1===t.$$.dirty[0]&&(N.push(t),j||(j=!0,A.then(T)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function X(e,o,i,c,r,a,u,d=[-1]){const p=s;L(e);const g=e.$$={fragment:null,ctx:[],props:a,update:t,not_equal:r,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(p?p.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:o.target||p.$$.root};u&&u(g.root);let m=!1;if(g.ctx=i?i(e,o.props||{},((t,n,...l)=>{const o=l.length?l[0]:n;return g.ctx&&r(g.ctx[t],g.ctx[t]=o)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](o),m&&W(e,t)),n})):[],g.update(),m=!0,l(g.before_update),g.fragment=!!c&&c(g.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);g.fragment&&g.fragment.l(t),t.forEach(f)}else g.fragment&&g.fragment.c();o.intro&&D(e.$$.fragment),K(e,o.target,o.anchor,o.customElement),T()}L(p)}class Y{$destroy(){Q(this,1),this.$destroy=t}$on(e,n){if(!o(n))return t;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const t=l.indexOf(n);-1!==t&&l.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Z(t){localStorage.setItem("documentSet",JSON.stringify(t))}function tt(t=null,e="full",n="full"){if(!t)return"https://via.placeholder.com/96x96?text=No+Image";if((t=t.split("_")).length<3)return"https://via.placeholder.com/96x96?text=No+Image";const l=t[t.length-1].includes(",")?t.pop().replace(".jpg",""):e,o=t.join("_").replace(".jpg","");return`${CANTALOUPE_APP_URL??"http://localhost:8182"}/iiif/2/${o}.jpg/${l}/${n}/0/default.jpg`}function et(t=null,e=1){return`${SAS_APP_URL??"http://localhost:3000"}/index.html?iiif-content=${t}&canvas=${e}`}function nt(t,e=null,n=!1){return new Promise((l=>{if(document.getElementById("msg-modal")){n&&(document.getElementById("modal-footer").hidden=!1),e&&(document.getElementById("modal-title").textContent=e),document.getElementById("modal-body").textContent=t,document.getElementById("hidden-msg-btn").click();const o=document.getElementById("cancel-btn"),i=document.getElementById("ok-btn"),c=document.getElementById("modal-bkg"),s=()=>{o.removeEventListener("click",r),c.removeEventListener("click",r),i.removeEventListener("click",a),document.getElementById("modal-footer").hidden=!0},r=()=>{s(),l(!1)},a=()=>{s(),l(!0)};o.addEventListener("click",r),i.addEventListener("click",a)}else n?l(window.confirm(t)):(window.alert(t),l(void 0))}))}function lt(t){let e;return{c(){e=m("path"),y(e,"d","M384 336H192c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16l140.1 0L400 115.9V320c0 8.8-7.2 16-16 16zM192 384H384c35.3 0 64-28.7 64-64V115.9c0-12.7-5.1-24.9-14.1-33.9L366.1 14.1c-9-9-21.2-14.1-33.9-14.1H192c-35.3 0-64 28.7-64 64V320c0 35.3 28.7 64 64 64zM64 128c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H256c35.3 0 64-28.7 64-64V416H272v32c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V192c0-8.8 7.2-16 16-16H96V128H64z"),y(e,"class","svelte-l0tzvr")},m(t,n){d(t,e,n)},d(t){t&&f(e)}}}function ot(t){let e;return{c(){e=m("path"),y(e,"d","M208 0H332.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H208c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128h80v64H64V448H256V416h64v48c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48z"),y(e,"class","svelte-l0tzvr")},m(t,n){d(t,e,n)},d(t){t&&f(e)}}}function it(t){let e,n="en"===t[3]?"Copy ID":"Copier l'ID";return{c(){e=h(n)},m(t,n){d(t,e,n)},p(t,l){8&l&&n!==(n="en"===t[3]?"Copy ID":"Copier l'ID")&&x(e,n)},d(t){t&&f(e)}}}function ct(t){let e,n="en"===t[3]?"Copied!":"Copié !";return{c(){e=h(n)},m(t,n){d(t,e,n)},p(t,l){8&l&&n!==(n="en"===t[3]?"Copied!":"Copié !")&&x(e,n)},d(t){t&&f(e)}}}function st(e){let n,o,i,c,s,a,p,v,k,w,L,S,E,N,C,O,P,A=e[0].title+"";function j(t,e){return t[2]?ot:lt}let _=j(e),I=_(e);function V(t,e){return t[2]?ct:it}let T=V(e),z=T(e);return{c(){n=g("div"),o=g("figure"),i=g("img"),s=b(),a=g("div"),p=g("span"),v=h(A),k=b(),w=g("button"),L=m("svg"),I.c(),S=b(),E=g("span"),z.c(),r(i.src,c=tt(e[0].img,e[0].xyhw,"96,"))||y(i,"src",c),y(i,"alt","Extracted region"),y(p,"class","overlay-desc"),y(a,"class","overlay is-center svelte-l0tzvr"),y(o,"class","image is-96x96 card svelte-l0tzvr"),y(o,"tabindex","-1"),y(L,"xmlns","http://www.w3.org/2000/svg"),y(L,"viewBox","0 0 384 512"),y(L,"class","svelte-l0tzvr"),y(E,"class","tooltip svelte-l0tzvr"),y(w,"class","button region-btn tag svelte-l0tzvr"),y(n,"id",N=e[0].id),y(n,"class",C="region image is-96x96 "+(e[1]?"checked":"")+" svelte-l0tzvr")},m(t,l){d(t,n,l),u(n,o),u(o,i),u(o,s),u(o,a),u(a,p),u(p,v),u(n,k),u(n,w),u(w,L),I.m(L,null),u(w,S),u(w,E),z.m(E,null),O||(P=[$(o,"click",e[6]),$(o,"keyup",rt),$(w,"click",e[7])],O=!0)},p(t,[e]){1&e&&!r(i.src,c=tt(t[0].img,t[0].xyhw,"96,"))&&y(i,"src",c),1&e&&A!==(A=t[0].title+"")&&x(v,A),_!==(_=j(t))&&(I.d(1),I=_(t),I&&(I.c(),I.m(L,null))),T===(T=V(t))&&z?z.p(t,e):(z.d(1),z=T(t),z&&(z.c(),z.m(E,null))),1&e&&N!==(N=t[0].id)&&y(n,"id",N),2&e&&C!==(C="region image is-96x96 "+(t[1]?"checked":"")+" svelte-l0tzvr")&&y(n,"class",C)},i:t,o:t,d(t){t&&f(n),I.d(),z.d(),O=!1,l(P)}}}const rt=()=>null;function at(t,e,n){const l=E();let{block:o}=e,{isSelected:i=!1}=e,{isCopied:c=!1}=e,{appLang:s="en"}=e;function r(){l("toggleSelection",{block:o})}function a(){l("copyRef",{block:o})}return t.$$set=t=>{"block"in t&&n(0,o=t.block),"isSelected"in t&&n(1,i=t.isSelected),"isCopied"in t&&n(2,c=t.isCopied),"appLang"in t&&n(3,s=t.appLang)},[o,i,c,s,r,a,()=>r(),()=>a()]}class ut extends Y{constructor(t){super(),X(this,t,at,st,i,{block:0,isSelected:1,isCopied:2,appLang:3})}}function dt(e){let n,l,o,i,c,s,r,a,p,m,v="en"===e[3]?"Selection":"Sélection";return{c(){n=g("div"),l=g("button"),o=g("span"),i=g("i"),c=b(),s=h(v),r=h("\n            ("),a=g("span"),p=h(e[2]),m=h(")"),y(i,"class","fa-solid fa-book-bookmark"),y(a,"id","selection-count"),y(a,"class","svelte-1ifntk3"),y(o,"class","svelte-1ifntk3"),y(l,"id","set-btn"),y(l,"class","button px-5 py-4 is-link js-modal-trigger svelte-1ifntk3"),y(l,"data-target","selection-modal"),w(l,"add-animation",e[0]),w(l,"remove-animation",e[1]),y(n,"class","set-container svelte-1ifntk3")},m(t,e){d(t,n,e),u(n,l),u(l,o),u(o,i),u(o,c),u(o,s),u(o,r),u(o,a),u(a,p),u(o,m)},p(t,[e]){8&e&&v!==(v="en"===t[3]?"Selection":"Sélection")&&x(s,v),4&e&&x(p,t[2]),1&e&&w(l,"add-animation",t[0]),2&e&&w(l,"remove-animation",t[1])},i:t,o:t,d(t){t&&f(n)}}}function ft(t,e,n){let{addAnimation:l=!1}=e,{removeAnimation:o=!1}=e,{selectionLength:i=0}=e,{appLang:c="en"}=e;return t.$$set=t=>{"addAnimation"in t&&n(0,l=t.addAnimation),"removeAnimation"in t&&n(1,o=t.removeAnimation),"selectionLength"in t&&n(2,i=t.selectionLength),"appLang"in t&&n(3,c=t.appLang)},[l,o,i,c]}class pt extends Y{constructor(t){super(),X(this,t,ft,dt,i,{addAnimation:0,removeAnimation:1,selectionLength:2,appLang:3})}}function gt(e){let n,o,i,c,s,r,a,p,m,v,k,w="en"===e[0]?"Clear selection":"Vider la sélection",L="en"===e[0]?"Save selection":"Sauvegarder la sélection";return{c(){n=g("footer"),o=g("div"),i=g("button"),c=h(w),s=b(),r=g("button"),a=g("i"),p=b(),m=h(L),y(i,"class","button is-link is-light"),y(a,"class","fa-solid fa-floppy-disk"),y(r,"class","button is-link"),y(o,"class","buttons"),y(n,"class","modal-card-foot is-center")},m(t,l){d(t,n,l),u(n,o),u(o,i),u(i,c),u(o,s),u(o,r),u(r,a),u(r,p),u(r,m),v||(k=[$(i,"click",e[2]),$(r,"click",e[3])],v=!0)},p(t,[e]){1&e&&w!==(w="en"===t[0]?"Clear selection":"Vider la sélection")&&x(c,w),1&e&&L!==(L="en"===t[0]?"Save selection":"Sauvegarder la sélection")&&x(m,L)},i:t,o:t,d(t){t&&f(n),v=!1,l(k)}}}function mt(t,e,n){const l=E();function o(t="save"){l("commitSelection",{updateType:t})}let{appLang:i="en"}=e;return t.$$set=t=>{"appLang"in t&&n(0,i=t.appLang)},[i,o,()=>o("clear"),()=>o("save")]}class ht extends Y{constructor(t){super(),X(this,t,mt,gt,i,{appLang:0})}}function bt(t){let e,n,l,o,i,c,s,p,m,v,$,k,w,L,S,E,N,C;const O=t[4].default,P=function(t,e,n,l){if(t){const o=a(t,e,n,l);return t[0](o)}}(O,t,t[3],null);return{c(){var a,u,d,f;e=g("tr"),n=g("th"),l=g("div"),o=g("img"),s=b(),p=g("div"),m=g("a"),v=g("i"),$=h("\n                    Page "),k=h(t[0]),L=b(),S=g("td"),E=g("div"),N=g("div"),P&&P.c(),r(o.src,i=tt(t[1],"full","250,"))||y(o,"src",i),y(o,"alt",c="Canvas "+t[0]),y(o,"class","mb-3 card"),y(v,"class","fa-solid fa-pen-to-square"),y(m,"class","tag px-2 py-1 is-rounded"),y(m,"href",w=et(t[2],t[0])),y(m,"target","_blank"),y(p,"class","is-center mb-1"),y(l,"class","content-wrapper py-5"),y(n,"class","is-3 center-flex is-narrow"),a=n,u="width",null==(d="260px")?a.style.removeProperty(u):a.style.setProperty(u,d,f?"important":""),y(N,"class","grid is-gap-2"),y(E,"class","fixed-grid has-6-cols"),y(S,"class","p-5 is-fullwidth")},m(t,i){d(t,e,i),u(e,n),u(n,l),u(l,o),u(l,s),u(l,p),u(p,m),u(m,v),u(m,$),u(m,k),u(e,L),u(e,S),u(S,E),u(E,N),P&&P.m(N,null),C=!0},p(t,[e]){(!C||2&e&&!r(o.src,i=tt(t[1],"full","250,")))&&y(o,"src",i),(!C||1&e&&c!==(c="Canvas "+t[0]))&&y(o,"alt",c),(!C||1&e)&&x(k,t[0]),(!C||5&e&&w!==(w=et(t[2],t[0])))&&y(m,"href",w),P&&P.p&&(!C||8&e)&&function(t,e,n,l,o,i){if(o){const c=a(e,n,l,i);t.p(c,o)}}(P,O,t,t[3],C?function(t,e,n,l){if(t[2]&&l){const o=t[2](l(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let l=0;l<n;l+=1)t[l]=e.dirty[l]|o[l];return t}return e.dirty|o}return e.dirty}(O,t[3],e,null):function(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}(t[3]),null)},i(t){C||(D(P,t),C=!0)},o(t){U(P,t),C=!1},d(t){t&&f(e),P&&P.d(t)}}}function vt(t,e,n){let{$$slots:l={},$$scope:o}=e,{canvasNb:i}=e,{canvasImg:c}=e,{manifest:s}=e;return t.$$set=t=>{"canvasNb"in t&&n(0,i=t.canvasNb),"canvasImg"in t&&n(1,c=t.canvasImg),"manifest"in t&&n(2,s=t.manifest),"$$scope"in t&&n(3,o=t.$$scope)},[i,c,s,o,l]}class $t extends Y{constructor(t){super(),X(this,t,vt,bt,i,{canvasNb:0,canvasImg:1,manifest:2})}}function kt(t){let e,n,l,o,i,c,s,r,a,p=t[0]>1&&yt(t),m=t[0]<t[1]&&wt(t);return{c(){e=g("nav"),n=g("ul"),p&&p.c(),l=b(),o=g("li"),i=g("a"),c=h(t[0]),s=b(),m&&m.c(),y(i,"class","pagination-link is-current"),y(i,"href",null),y(n,"class","pagination-list"),y(e,"class","pagination is-centered"),y(e,"aria-label","pagination")},m(f,g){d(f,e,g),u(e,n),p&&p.m(n,null),u(n,l),u(n,o),u(o,i),u(i,c),u(n,s),m&&m.m(n,null),r||(a=$(i,"click",k(t[5])),r=!0)},p(t,e){t[0]>1?p?p.p(t,e):(p=yt(t),p.c(),p.m(n,l)):p&&(p.d(1),p=null),1&e&&x(c,t[0]),t[0]<t[1]?m?m.p(t,e):(m=wt(t),m.c(),m.m(n,null)):m&&(m.d(1),m=null)},d(t){t&&f(e),p&&p.d(),m&&m.d(),r=!1,a()}}}function yt(t){let e,n,l,o,i,c,s=t[0]-1>1&&xt(t);return{c(){e=g("li"),n=g("a"),n.textContent="1",l=b(),s&&s.c(),o=v(),y(n,"class","pagination-link"),y(n,"href",null)},m(r,a){d(r,e,a),u(e,n),d(r,l,a),s&&s.m(r,a),d(r,o,a),i||(c=$(n,"click",k(t[3])),i=!0)},p(t,e){t[0]-1>1?s?s.p(t,e):(s=xt(t),s.c(),s.m(o.parentNode,o)):s&&(s.d(1),s=null)},d(t){t&&f(e),t&&f(l),s&&s.d(t),t&&f(o),i=!1,c()}}}function xt(t){let e,n,l,o,i,c,s,r=t[0]-1+"";return{c(){e=g("li"),e.innerHTML='<span class="pagination-ellipsis">…</span>',n=b(),l=g("li"),o=g("a"),i=h(r),y(o,"class","pagination-link"),y(o,"href",null)},m(r,a){d(r,e,a),d(r,n,a),d(r,l,a),u(l,o),u(o,i),c||(s=$(o,"click",k(t[4])),c=!0)},p(t,e){1&e&&r!==(r=t[0]-1+"")&&x(i,r)},d(t){t&&f(e),t&&f(n),t&&f(l),c=!1,s()}}}function wt(t){let e,n,l,o,i,c,s=t[0]+1<t[1]&&Lt(t);return{c(){s&&s.c(),e=b(),n=g("li"),l=g("a"),o=h(t[1]),y(l,"class","pagination-link"),y(l,"href",null)},m(r,a){s&&s.m(r,a),d(r,e,a),d(r,n,a),u(n,l),u(l,o),i||(c=$(l,"click",k(t[7])),i=!0)},p(t,n){t[0]+1<t[1]?s?s.p(t,n):(s=Lt(t),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),2&n&&x(o,t[1])},d(t){s&&s.d(t),t&&f(e),t&&f(n),i=!1,c()}}}function Lt(t){let e,n,l,o,i,c,s,r=t[0]+1+"";return{c(){e=g("li"),n=g("a"),l=h(r),o=b(),i=g("li"),i.innerHTML='<span class="pagination-ellipsis">…</span>',y(n,"class","pagination-link"),y(n,"href",null)},m(r,a){d(r,e,a),u(e,n),u(n,l),d(r,o,a),d(r,i,a),c||(s=$(n,"click",k(t[6])),c=!0)},p(t,e){1&e&&r!==(r=t[0]+1+"")&&x(l,r)},d(t){t&&f(e),t&&f(o),t&&f(i),c=!1,s()}}}function St(e){let n,l=e[1]>1&&kt(e);return{c(){l&&l.c(),n=v()},m(t,e){l&&l.m(t,e),d(t,n,e)},p(t,[e]){t[1]>1?l?l.p(t,e):(l=kt(t),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},i:t,o:t,d(t){l&&l.d(t),t&&f(n)}}}function Et(t,e,n){const l=E();let{pageNb:o}=e,{maxPage:i}=e;function c(t){l("pageUpdate",{pageNb:t})}return t.$$set=t=>{"pageNb"in t&&n(0,o=t.pageNb),"maxPage"in t&&n(1,i=t.maxPage)},[o,i,c,()=>c(1),()=>c(o-1),()=>c(o),()=>c(o+1),()=>c(i)]}class Nt extends Y{constructor(t){super(),X(this,t,Et,St,i,{pageNb:0,maxPage:1})}}function Ct(e){let n,l,o,i,c,s,r,a,p,m,v,$,k,w,L,S,E="en"===e[0]?"Cancel":"Annuler";return{c(){n=g("button"),l=b(),o=g("div"),i=g("div"),c=b(),s=g("div"),r=g("div"),r.innerHTML='<div class="title is-4 mb-0 media-content"><h3 id="modal-title" class="mb-0"></h3></div> \n            <button class="delete media-left" aria-label="close"></button>',a=b(),p=g("section"),m=b(),v=g("footer"),$=g("div"),k=g("button"),w=h(E),L=b(),S=g("button"),S.textContent="OK",y(n,"id","hidden-msg-btn"),y(n,"class","js-modal-trigger"),y(n,"data-target","msg-modal"),n.hidden=!0,y(i,"id","modal-bkg"),y(i,"class","modal-background"),y(r,"class","modal-card-head media mb-0"),y(p,"id","modal-body"),y(p,"class","modal-card-body"),y(k,"id","cancel-btn"),y(k,"class","button is-link is-light"),y(S,"id","ok-btn"),y(S,"class","button is-link"),y($,"class","buttons"),y(v,"id","modal-footer"),y(v,"class","modal-card-foot is-center"),v.hidden=!0,y(s,"class","modal-content"),y(o,"id","msg-modal"),y(o,"class","modal fade"),y(o,"tabindex","-1"),y(o,"aria-labelledby","selection-modal-label"),y(o,"aria-hidden","true")},m(t,e){d(t,n,e),d(t,l,e),d(t,o,e),u(o,i),u(o,c),u(o,s),u(s,r),u(s,a),u(s,p),u(s,m),u(s,v),u(v,$),u($,k),u(k,w),u($,L),u($,S)},p(t,[e]){1&e&&E!==(E="en"===t[0]?"Cancel":"Annuler")&&x(w,E)},i:t,o:t,d(t){t&&f(n),t&&f(l),t&&f(o)}}}function Ot(t,e,n){let{appLang:l="en"}=e;return t.$$set=t=>{"appLang"in t&&n(0,l=t.appLang)},[l]}class Pt extends Y{constructor(t){super(),X(this,t,Ot,Ct,i,{appLang:0})}}function At(t,e,n){const l=t.slice();return l[31]=e[n][0],l[32]=e[n][1],l}function jt(t,e,n){const l=t.slice();return l[39]=e[n][0],l[40]=e[n][1],l}function _t(t,e,n){const l=t.slice();return l[35]=e[n],l}function It(t,e,n){const l=t.slice();return l[35]=e[n],l}function Vt(t,e,n){const l=t.slice();return l[46]=e[n][0],l[32]=e[n][1],l}function Tt(t){let e;return{c(){e=m("path"),y(e,"d","M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160V416c0 53 43 96 96 96H352c53 0 96-43 96-96V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h96c17.7 0 32-14.3 32-32s-14.3-32-32-32H96z"),y(e,"class","svelte-1jta9w9")},m(t,n){d(t,e,n)},d(t){t&&f(e)}}}function zt(t){let e;return{c(){e=m("path"),y(e,"d","M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"),y(e,"class","svelte-1jta9w9")},m(t,n){d(t,e,n)},d(t){t&&f(e)}}}function Mt(t){let e,n="en"===t[2]?"Edit":"Modifier";return{c(){e=h(n)},m(t,n){d(t,e,n)},p(t,l){4&l[0]&&n!==(n="en"===t[2]?"Edit":"Modifier")&&x(e,n)},d(t){t&&f(e)}}}function Ht(t){let e,n="en"===t[2]?"Validate":"Valider";return{c(){e=h(n)},m(t,n){d(t,e,n)},p(t,l){4&l[0]&&n!==(n="en"===t[2]?"Validate":"Valider")&&x(e,n)},d(t){t&&f(e)}}}function Rt(t){let e,n,o,i,c,s,r,a,p,m,v,k,w,L,S,E,N,C="en"===t[2]?"Reload":"Recharger",O="en"===t[2]?"Go to editor":"Aller à l'éditeur",P="en"===t[2]?"Delete selected regions":"Supprimer les régions sélectionnées";return{c(){e=g("button"),n=g("i"),o=b(),i=h(C),c=b(),s=g("a"),r=g("i"),a=b(),p=h(O),v=b(),k=g("button"),w=g("i"),L=b(),S=h(P),y(n,"class","fa-solid fa-rotate-right"),y(e,"class","tag is-link is-light is-rounded mr-3"),y(r,"class","fa-solid fa-edit"),y(s,"class","tag is-link is-rounded mr-3"),y(s,"href",m=et(t[3])),y(s,"target","_blank"),y(w,"class","fa-solid fa-trash"),y(k,"class","tag is-danger is-rounded")},m(l,f){d(l,e,f),u(e,n),u(e,o),u(e,i),d(l,c,f),d(l,s,f),u(s,r),u(s,a),u(s,p),d(l,v,f),d(l,k,f),u(k,w),u(k,L),u(k,S),E||(N=[$(e,"click",t[27]),$(k,"click",t[16])],E=!0)},p(t,e){4&e[0]&&C!==(C="en"===t[2]?"Reload":"Recharger")&&x(i,C),4&e[0]&&O!==(O="en"===t[2]?"Go to editor":"Aller à l'éditeur")&&x(p,O),8&e[0]&&m!==(m=et(t[3]))&&y(s,"href",m),4&e[0]&&P!==(P="en"===t[2]?"Delete selected regions":"Supprimer les régions sélectionnées")&&x(S,P)},d(t){t&&f(e),t&&f(c),t&&f(s),t&&f(v),t&&f(k),E=!1,l(N)}}}function Bt(t){let e,n,o,i,c,s,r=t[32].text+"";function a(){return t[28](t[46])}return{c(){e=g("li"),n=g("a"),o=h(r),i=b(),y(n,"href",null),w(e,"is-active",t[46]===t[10])},m(t,l){d(t,e,l),u(e,n),u(n,o),u(e,i),c||(s=[$(e,"click",a),$(e,"keyup",ae)],c=!0)},p(n,l){t=n,1049600&l[0]&&w(e,"is-active",t[46]===t[10])},d(t){t&&f(e),c=!1,l(s)}}}function Dt(e){let n;return{c(){n=g("div"),n.textContent="tout doux"},m(t,e){d(t,n,e)},p:t,i:t,o:t,d(t){t&&f(n)}}}function Ut(e){let n;return{c(){n=g("div"),n.textContent="tout doux"},m(t,e){d(t,n,e)},p:t,i:t,o:t,d(t){t&&f(n)}}}function qt(t){let e,n,l,o,i,c;e=new Nt({props:{pageNb:t[5],maxPage:10}}),e.$on("pageUpdate",t[21]);let s={ctx:t,current:null,token:null,hasCatch:!0,pending:Zt,then:Jt,catch:Gt,value:38,error:45,blocks:[,,,]};return q(i=t[8],s),{c(){J(e.$$.fragment),n=b(),l=g("table"),o=g("tbody"),s.block.c(),y(l,"class","table is-fullwidth")},m(t,i){K(e,t,i),d(t,n,i),d(t,l,i),u(l,o),s.block.m(o,s.anchor=null),s.mount=()=>o,s.anchor=null,c=!0},p(n,l){t=n;const o={};32&l[0]&&(o.pageNb=t[5]),e.$set(o),s.ctx=t,256&l[0]&&i!==(i=t[8])&&q(i,s)||function(t,e,n){const l=e.slice(),{resolved:o}=t;t.current===t.then&&(l[t.value]=o),t.current===t.catch&&(l[t.error]=o),t.block.p(l,n)}(s,t,l)},i(t){c||(D(e.$$.fragment,t),D(s.block),c=!0)},o(t){U(e.$$.fragment,t);for(let t=0;t<3;t+=1){U(s.blocks[t])}c=!1},d(t){Q(e,t),t&&f(n),t&&f(l),s.block.d(),s.token=null,s=null}}}function Ft(t){let e,n,l,o=[],i=new Map,c=Object.values(t[1]);const s=t=>t[35].id;for(let e=0;e<c.length;e+=1){let n=It(t,c,e),l=s(n);i.set(l,o[e]=ee(l,n))}let r=null;return c.length||(r=te()),{c(){e=g("div"),n=g("div");for(let t=0;t<o.length;t+=1)o[t].c();r&&r.c(),y(n,"class","grid is-gap-2"),y(e,"class","fixed-grid has-auto-count")},m(t,i){d(t,e,i),u(e,n);for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(n,null);r&&r.m(n,null),l=!0},p(t,e){792582&e[0]&&(c=Object.values(t[1]),R(),o=G(o,e,s,1,t,c,i,n,F,ee,null,It),B(),c.length?r&&(r.d(1),r=null):r||(r=te(),r.c(),r.m(n,null)))},i(t){if(!l){for(let t=0;t<c.length;t+=1)D(o[t]);l=!0}},o(t){for(let t=0;t<o.length;t+=1)U(o[t]);l=!1},d(t){t&&f(e);for(let t=0;t<o.length;t+=1)o[t].d();r&&r.d()}}}function Gt(e){let n,l,o,i=e[45]+"";return{c(){n=g("tr"),l=h("Error when retrieving paginated regions: "),o=h(i)},m(t,e){d(t,n,e),u(n,l),u(n,o)},p(t,e){256&e[0]&&i!==(i=t[45]+"")&&x(o,i)},i:t,o:t,d(t){t&&f(n)}}}function Jt(t){let e,n,l,o,i;const c=[Qt,Kt],s=[];function r(t,n){return 256&n[0]&&(e=null),null==e&&(e=!!(Object.values(t[38]).length>0)),e?0:1}return n=r(t,[-1,-1]),l=s[n]=c[n](t),{c(){l.c(),o=v()},m(t,e){s[n].m(t,e),d(t,o,e),i=!0},p(t,e){let i=n;n=r(t,e),n===i?s[n].p(t,e):(R(),U(s[i],1,1,(()=>{s[i]=null})),B(),l=s[n],l?l.p(t,e):(l=s[n]=c[n](t),l.c()),D(l,1),l.m(o.parentNode,o))},i(t){i||(D(l),i=!0)},o(t){U(l),i=!1},d(t){s[n].d(t),t&&f(o)}}}function Kt(e){let n;return{c(){n=g("tr"),n.textContent="NO ANNOTATION"},m(t,e){d(t,n,e)},p:t,i:t,o:t,d(t){t&&f(n)}}}function Qt(t){let e,n,l=Object.entries(t[38]),o=[];for(let e=0;e<l.length;e+=1)o[e]=Yt(jt(t,l,e));const i=t=>U(o[t],1,1,(()=>{o[t]=null}));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=v()},m(t,l){for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,l);d(t,e,l),n=!0},p(t,n){if(792844&n[0]){let c;for(l=Object.entries(t[38]),c=0;c<l.length;c+=1){const i=jt(t,l,c);o[c]?(o[c].p(i,n),D(o[c],1)):(o[c]=Yt(i),o[c].c(),D(o[c],1),o[c].m(e.parentNode,e))}for(R(),c=l.length;c<o.length;c+=1)i(c);B()}},i(t){if(!n){for(let t=0;t<l.length;t+=1)D(o[t]);n=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)U(o[t]);n=!1},d(t){p(o,t),t&&f(e)}}}function Wt(t,e){let n,l,o;return l=new ut({props:{block:e[35],appLang:e[2],isSelected:e[12](e[35]),isCopied:e[11](e[35])}}),l.$on("toggleSelection",e[18]),l.$on("copyRef",e[19]),{key:t,first:null,c(){n=v(),J(l.$$.fragment),this.first=n},m(t,e){d(t,n,e),K(l,t,e),o=!0},p(t,n){e=t;const o={};256&n[0]&&(o.block=e[35]),4&n[0]&&(o.appLang=e[2]),4352&n[0]&&(o.isSelected=e[12](e[35])),2304&n[0]&&(o.isCopied=e[11](e[35])),l.$set(o)},i(t){o||(D(l.$$.fragment,t),o=!0)},o(t){U(l.$$.fragment,t),o=!1},d(t){t&&f(n),Q(l,t)}}}function Xt(t){let e,n,l=[],o=new Map,i=Object.values(t[40]);const c=t=>t[35].id;for(let e=0;e<i.length;e+=1){let n=_t(t,i,e),s=c(n);o.set(s,l[e]=Wt(s,n))}return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=b()},m(t,o){for(let e=0;e<l.length;e+=1)l[e]&&l[e].m(t,o);d(t,e,o),n=!0},p(t,n){792836&n[0]&&(i=Object.values(t[40]),R(),l=G(l,n,c,1,t,i,o,e.parentNode,F,Wt,e,_t),B())},i(t){if(!n){for(let t=0;t<i.length;t+=1)D(l[t]);n=!0}},o(t){for(let t=0;t<l.length;t+=1)U(l[t]);n=!1},d(t){for(let e=0;e<l.length;e+=1)l[e].d(t);t&&f(e)}}}function Yt(t){let e,n;return e=new $t({props:{canvasImg:Object.values(t[40])[0].img,canvasNb:t[39],manifest:t[3],$$slots:{default:[Xt]},$$scope:{ctx:t}}}),{c(){J(e.$$.fragment)},m(t,l){K(e,t,l),n=!0},p(t,n){const l={};256&n[0]&&(l.canvasImg=Object.values(t[40])[0].img),256&n[0]&&(l.canvasNb=t[39]),8&n[0]&&(l.manifest=t[3]),6404&n[0]|262144&n[1]&&(l.$$scope={dirty:n,ctx:t}),e.$set(l)},i(t){n||(D(e.$$.fragment,t),n=!0)},o(t){U(e.$$.fragment,t),n=!1},d(t){Q(e,t)}}}function Zt(e){let n;return{c(){n=g("tr"),n.textContent="Retrieving paginated regions...",y(n,"class","faded is-center")},m(t,e){d(t,n,e)},p:t,i:t,o:t,d(t){t&&f(n)}}}function te(t){let e;return{c(){e=h("NO ANNOTATION")},m(t,n){d(t,e,n)},d(t){t&&f(e)}}}function ee(t,e){let n,l,o;return l=new ut({props:{block:e[35],appLang:e[2],isSelected:e[12](e[35]),isCopied:e[11](e[35])}}),l.$on("toggleSelection",e[18]),l.$on("copyRef",e[19]),{key:t,first:null,c(){n=v(),J(l.$$.fragment),this.first=n},m(t,e){d(t,n,e),K(l,t,e),o=!0},p(t,n){e=t;const o={};2&n[0]&&(o.block=e[35]),4&n[0]&&(o.appLang=e[2]),4098&n[0]&&(o.isSelected=e[12](e[35])),2050&n[0]&&(o.isCopied=e[11](e[35])),l.$set(o)},i(t){o||(D(l.$$.fragment,t),o=!0)},o(t){U(l.$$.fragment,t),o=!1},d(t){t&&f(n),Q(l,t)}}}function ne(t){let e,n,l="en"===t[2]?"No regions in selection":"Aucune région sélectionnée";return{c(){e=g("div"),n=h(l)},m(t,l){d(t,e,l),u(e,n)},p(t,e){4&e[0]&&l!==(l="en"===t[2]?"No regions in selection":"Aucune région sélectionnée")&&x(n,l)},d(t){t&&f(e)}}}function le(t){let e,n,l=Object.entries(t[4][t[0]]),o=[];for(let e=0;e<l.length;e+=1)o[e]=oe(At(t,l,e));return{c(){e=g("div"),n=g("div");for(let t=0;t<o.length;t+=1)o[t].c();y(n,"class","grid is-gap-2"),y(e,"class","fixed-grid has-6-cols")},m(t,l){d(t,e,l),u(e,n);for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(n,null)},p(t,e){if(131089&e[0]){let i;for(l=Object.entries(t[4][t[0]]),i=0;i<l.length;i+=1){const c=At(t,l,i);o[i]?o[i].p(c,e):(o[i]=oe(c),o[i].c(),o[i].m(n,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=l.length}},d(t){t&&f(e),p(o,t)}}}function oe(t){let e,n,l,o,i,c,s,a,p,m,v,k,w,L=t[32].title+"";function S(){return t[29](t[31])}return{c(){e=g("div"),n=g("figure"),l=g("img"),i=b(),c=g("div"),s=g("span"),a=h(L),p=b(),m=g("button"),v=b(),r(l.src,o=tt(t[32].img,t[32].xyhw,"96,"))||y(l,"src",o),y(l,"alt","Extracted region"),y(s,"class","overlay-desc"),y(c,"class","overlay is-center svelte-1jta9w9"),y(n,"class","image is-64x64 card"),y(m,"class","delete region-btn"),y(m,"aria-label","remove from selection"),y(e,"class","selection cell svelte-1jta9w9")},m(t,o){d(t,e,o),u(e,n),u(n,l),u(n,i),u(n,c),u(c,s),u(s,a),u(e,p),u(e,m),u(e,v),k||(w=$(m,"click",S),k=!0)},p(e,n){t=e,16&n[0]&&!r(l.src,o=tt(t[32].img,t[32].xyhw,"96,"))&&y(l,"src",o),16&n[0]&&L!==(L=t[32].title+"")&&x(a,L)},d(t){t&&f(e),k=!1,w()}}}function ie(t){let e,n,o,i,c,s,r,a,v,k,w,L,S,E,N,C,O,P,A,j,_,I,V,T,z,M,H,q,F,G,W,X,Y,Z,tt,et,nt,lt,ot,it,ct,st,rt,at,ut,dt,ft,gt,mt,bt,vt,$t="en"===t[2]?"Select all":"Tout sélectionner",kt="en"===t[2]?"Download":"Télecharger",yt="en"===t[2]?"Selected regions":"Regions sélectionnées";function xt(t,e){return t[9]?zt:Tt}e=new Pt({props:{appLang:t[2]}}),o=new pt({props:{addAnimation:t[6],removeAnimation:t[7],selectionLength:t[14],appLang:t[2]}});let wt=xt(t),Lt=wt(t);function St(t,e){return t[9]?Ht:Mt}let Et=St(t),Nt=Et(t),Ct=t[9]&&Rt(t),Ot=Object.entries(t[20]),At=[];for(let e=0;e<Ot.length;e+=1)At[e]=Bt(Vt(t,Ot,e));const jt=[Ft,qt,Ut,Dt],_t=[];function It(t,e){return"all"===t[10]?0:"page"===t[10]?1:"similarity"===t[10]?2:"vectorization"===t[10]?3:-1}function Gt(t,e){return t[13]?le:ne}~(H=It(t))&&(q=_t[H]=jt[H](t));let Jt=Gt(t),Kt=Jt(t);return gt=new ht({props:{appLang:t[2]}}),gt.$on("commitSelection",t[15]),{c(){J(e.$$.fragment),n=b(),J(o.$$.fragment),i=b(),c=g("div"),s=g("div"),r=g("button"),a=m("svg"),Lt.c(),v=b(),Nt.c(),w=b(),L=g("button"),S=g("i"),E=b(),N=h($t),C=b(),O=g("button"),P=g("i"),A=b(),j=h(kt),_=b(),I=g("div"),Ct&&Ct.c(),V=b(),T=g("div"),z=g("ul");for(let t=0;t<At.length;t+=1)At[t].c();M=b(),q&&q.c(),F=b(),G=g("div"),W=g("div"),X=b(),Y=g("div"),Z=g("div"),tt=g("div"),et=g("i"),nt=b(),lt=h(yt),ot=h("\n                ("),it=g("span"),ct=h(t[14]),st=h(")"),rt=b(),at=g("button"),ut=b(),dt=g("section"),Kt.c(),ft=b(),J(gt.$$.fragment),y(a,"xmlns","http://www.w3.org/2000/svg"),y(a,"viewBox","0 0 384 512"),y(a,"class","pr-3"),y(r,"class",k="button "+(t[9]?"is-success":"is-link")+" mr-3"),y(S,"class","fa-solid fa-square-check"),y(L,"class","button is-link is-light mr-3"),y(P,"class","fa-solid fa-download"),y(O,"class","button is-link is-light"),y(s,"class","svelte-1jta9w9"),y(I,"class","edit-action svelte-1jta9w9"),y(c,"class","is-left center-flex actions svelte-1jta9w9"),y(z,"class","panel-tabs"),y(T,"class","tabs is-centered"),y(W,"class","modal-background"),y(et,"class","fa-solid fa-book-bookmark"),y(it,"id","selection-count"),y(tt,"class","title is-4 mb-0 media-content"),y(at,"class","delete media-left"),y(at,"aria-label","close"),y(Z,"class","modal-card-head media mb-0"),y(dt,"class","modal-card-body"),y(Y,"class","modal-content"),y(G,"id","selection-modal"),y(G,"class","modal fade"),y(G,"tabindex","-1"),y(G,"aria-labelledby","selection-modal-label"),y(G,"aria-hidden","true")},m(l,f){K(e,l,f),d(l,n,f),K(o,l,f),d(l,i,f),d(l,c,f),u(c,s),u(s,r),u(r,a),Lt.m(a,null),u(r,v),Nt.m(r,null),u(s,w),u(s,L),u(L,S),u(L,E),u(L,N),u(s,C),u(s,O),u(O,P),u(O,A),u(O,j),u(c,_),u(c,I),Ct&&Ct.m(I,null),d(l,V,f),d(l,T,f),u(T,z);for(let t=0;t<At.length;t+=1)At[t]&&At[t].m(z,null);d(l,M,f),~H&&_t[H].m(l,f),d(l,F,f),d(l,G,f),u(G,W),u(G,X),u(G,Y),u(Y,Z),u(Z,tt),u(tt,et),u(tt,nt),u(tt,lt),u(tt,ot),u(tt,it),u(it,ct),u(tt,st),u(Z,rt),u(Z,at),u(Y,ut),u(Y,dt),Kt.m(dt,null),u(Y,ft),K(gt,Y,null),mt=!0,bt||(vt=[$(r,"click",t[26]),$(L,"click",se),$(O,"click",re)],bt=!0)},p(t,n){const l={};4&n[0]&&(l.appLang=t[2]),e.$set(l);const i={};if(64&n[0]&&(i.addAnimation=t[6]),128&n[0]&&(i.removeAnimation=t[7]),16384&n[0]&&(i.selectionLength=t[14]),4&n[0]&&(i.appLang=t[2]),o.$set(i),wt!==(wt=xt(t))&&(Lt.d(1),Lt=wt(t),Lt&&(Lt.c(),Lt.m(a,null))),Et===(Et=St(t))&&Nt?Nt.p(t,n):(Nt.d(1),Nt=Et(t),Nt&&(Nt.c(),Nt.m(r,null))),(!mt||512&n[0]&&k!==(k="button "+(t[9]?"is-success":"is-link")+" mr-3"))&&y(r,"class",k),(!mt||4&n[0])&&$t!==($t="en"===t[2]?"Select all":"Tout sélectionner")&&x(N,$t),(!mt||4&n[0])&&kt!==(kt="en"===t[2]?"Download":"Télecharger")&&x(j,kt),t[9]?Ct?Ct.p(t,n):(Ct=Rt(t),Ct.c(),Ct.m(I,null)):Ct&&(Ct.d(1),Ct=null),1049600&n[0]){let e;for(Ot=Object.entries(t[20]),e=0;e<Ot.length;e+=1){const l=Vt(t,Ot,e);At[e]?At[e].p(l,n):(At[e]=Bt(l),At[e].c(),At[e].m(z,null))}for(;e<At.length;e+=1)At[e].d(1);At.length=Ot.length}let c=H;H=It(t),H===c?~H&&_t[H].p(t,n):(q&&(R(),U(_t[c],1,1,(()=>{_t[c]=null})),B()),~H?(q=_t[H],q?q.p(t,n):(q=_t[H]=jt[H](t),q.c()),D(q,1),q.m(F.parentNode,F)):q=null),(!mt||4&n[0])&&yt!==(yt="en"===t[2]?"Selected regions":"Regions sélectionnées")&&x(lt,yt),(!mt||16384&n[0])&&x(ct,t[14]),Jt===(Jt=Gt(t))&&Kt?Kt.p(t,n):(Kt.d(1),Kt=Jt(t),Kt&&(Kt.c(),Kt.m(dt,null)));const s={};4&n[0]&&(s.appLang=t[2]),gt.$set(s)},i(t){mt||(D(e.$$.fragment,t),D(o.$$.fragment,t),D(q),D(gt.$$.fragment,t),mt=!0)},o(t){U(e.$$.fragment,t),U(o.$$.fragment,t),U(q),U(gt.$$.fragment,t),mt=!1},d(t){Q(e,t),t&&f(n),Q(o,t),t&&f(i),t&&f(c),Lt.d(),Nt.d(),Ct&&Ct.d(),t&&f(V),t&&f(T),p(At,t),t&&f(M),~H&&_t[H].d(t),t&&f(F),t&&f(G),Kt.d(),Q(gt),bt=!1,l(vt)}}}async function ce(t){const e=SAS_APP_URL.replace("https","http"),n=`${SAS_APP_URL}/annotation/destroy?uri=${e}/annotation/${t}`,l=await fetch(n,{method:"DELETE"});if(204!==l.status)throw new Error(`Failed to delete ${n} due to ${l.status}: '${l.statusText}'`)}const se=()=>null,re=()=>null,ae=()=>null;function ue(t,e,n){let l,o,i,c,s,r,a,u,d,f,p=!1,g=!1;const m="Regions";let{regions:h={}}=e,{appLang:b="en"}=e,{manifest:v=""}=e,{imgPrefix:$=""}=e,{nbOfPages:k=1}=e,y=JSON.parse(localStorage.getItem("documentSet"))??{};function x(t){n(4,y=function(t,e,n){const{[e]:l,...o}=t[n];return t[n]=o,Z(t),t}(y,t,m)),n(7,g=!0),setTimeout((()=>n(7,g=!1)),300)}function w(t){n(4,y=function(t,e){return t.hasOwnProperty(e.type)||(t[e.type]=[]),t[e.type]={...t[e.type],[e.id]:e},Z(t),t}(y,t)),n(6,p=!0),setTimeout((()=>n(6,p=!1)),300)}const L={all:{text:"en"===b?"All regions":"Toutes les régions"},page:{text:"en"===b?"Per page":"Par page"},similarity:{text:"en"===b?"Similarity":"Similarité"},vectorization:{text:"en"===b?"Vectorization":"Vectorisation"}};return t.$$set=t=>{"regions"in t&&n(1,h=t.regions),"appLang"in t&&n(2,b=t.appLang),"manifest"in t&&n(3,v=t.manifest),"imgPrefix"in t&&n(22,$=t.imgPrefix),"nbOfPages"in t&&n(23,k=t.nbOfPages)},t.$$.update=()=>{16&t.$$.dirty[0]&&n(14,l=y.hasOwnProperty(m)?Object.keys(y[m]).length:0),16&t.$$.dirty[0]&&n(12,o=t=>y[m]?.hasOwnProperty(t.id)),16&t.$$.dirty[0]&&n(13,i=Object.keys(y[m]??{}).length>0),33554432&t.$$.dirty[0]&&n(11,s=t=>c===t.ref),16777248&t.$$.dirty[0]&&n(8,f=(async()=>{const t=await fetch(`${u}canvas?p=${d}`);return await t.json()})())},n(25,c=""),n(10,r="all"),n(9,a=!1),n(24,u=`${window.location.origin}${window.location.pathname}`),n(5,d=parseInt(new URLSearchParams(window.location.search).get("p")??1)),[m,h,b,v,y,d,p,g,f,a,r,s,o,i,l,function(t){const{updateType:e}=t.detail;"clear"===e?n(4,y=function(t,e){return e.map((e=>!t.hasOwnProperty(e)||delete t[e])),Z(t),t}(y,[m])):"save"===e&&n(4,y=function(t){return console.log(t),t}(y))},async function(){if(await nt("en"===b?"Are you sure you want to delete regions?":"Voulez-vous vraiment supprimer les régions?","en"===b?"Confirm deletion":"Confirmer la suppression",!0))for(const t of Object.keys(y[m]))try{if(!h.hasOwnProperty(t))continue;await ce(t),delete h[t],delete y[m][t]}catch(e){await nt(`Failed to delete region ${t}: ${e.message}`,"Error")}},x,function(t){const{block:e}=t.detail;o(e)?x(e.id):w(e)},function(t){const{block:e}=t.detail,l=s(e)?"":e.ref;navigator.clipboard.writeText(l),n(25,c=l)},L,function(t){const{pageNb:e}=t.detail;n(5,d=e);const l=new URL(u);l.searchParams.set("p",d),window.history.pushState({},"",l)},$,k,u,c,()=>n(9,a=!a),()=>location.reload(),t=>n(10,r=t),t=>x(t)]}const de=(fe="regions-data",document.getElementById(fe)?JSON.parse(document.getElementById(fe).textContent):[]);var fe;return new class extends Y{constructor(t){super(),X(this,t,ue,ie,i,{regionsType:0,regions:1,appLang:2,manifest:3,imgPrefix:22,nbOfPages:23},null,[-1,-1])}get regionsType(){return this.$$.ctx[0]}}({target:document.getElementById("region-list"),props:{regions:de,regionsType:"Regions",appLang:APP_LANG,manifest:manifest,imgPrefix:img_prefix}})}();
//# sourceMappingURL=regionList.js.map
