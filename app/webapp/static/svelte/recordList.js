var recordList=function(){"use strict";function e(){}function t(e,t){for(const n in t)e[n]=t[n];return e}function n(e){return e()}function l(){return Object.create(null)}function s(e){e.forEach(n)}function c(e){return"function"==typeof e}function r(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let o;function i(e,t){return o||(o=document.createElement("a")),o.href=t,e===o.href}function a(t,...n){if(null==t)return e;const l=t.subscribe(...n);return l.unsubscribe?()=>l.unsubscribe():l}function u(e){let t;return a(e,(e=>t=e))(),t}function d(e,t,n){e.$$.on_destroy.push(a(t,n))}function m(e,n,l,s){return e[1]&&s?t(l.ctx.slice(),e[1](s(n))):l.ctx}function f(e,t){e.appendChild(t)}function p(e,t,n){e.insertBefore(t,n||null)}function h(e){e.parentNode&&e.parentNode.removeChild(e)}function g(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function b(e){return document.createElement(e)}function $(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function y(e){return document.createTextNode(e)}function v(){return y(" ")}function w(){return y("")}function k(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function x(e){return function(t){return t.preventDefault(),e.call(this,t)}}function _(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}const S=["width","height"];function P(e,t){const n=Object.getOwnPropertyDescriptors(e.__proto__);for(const l in t)null==t[l]?e.removeAttribute(l):"style"===l?e.style.cssText=t[l]:"__value"===l?e.value=e[l]=t[l]:n[l]&&n[l].set&&-1===S.indexOf(l)?e[l]=t[l]:_(e,l,t[l])}function L(e){return""===e?null:+e}function O(e,t){t=""+t,e.data!==t&&(e.data=t)}function A(e,t){e.value=null==t?"":t}function N(e,t,n){for(let n=0;n<e.options.length;n+=1){const l=e.options[n];if(l.__value===t)return void(l.selected=!0)}n&&void 0===t||(e.selectedIndex=-1)}function R(e,t){for(let n=0;n<e.options.length;n+=1){const l=e.options[n];l.selected=~t.indexOf(l.__value)}}function E(e,t,n){e.classList[n?"add":"remove"](t)}let j;function C(e){j=e}function T(){if(!j)throw new Error("Function called outside component initialization");return j}const I=[],M=[];let F=[];const U=[],H=Promise.resolve();let z=!1;function D(e){F.push(e)}const V=new Set;let G=0;function B(){if(0!==G)return;const e=j;do{try{for(;G<I.length;){const e=I[G];G++,C(e),q(e.$$)}}catch(e){throw I.length=0,G=0,e}for(C(null),I.length=0,G=0;M.length;)M.pop()();for(let e=0;e<F.length;e+=1){const t=F[e];V.has(t)||(V.add(t),t())}F.length=0}while(I.length);for(;U.length;)U.pop()();z=!1,V.clear(),C(e)}function q(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(D)}}const J=new Set;let X;function K(){X={r:0,c:[],p:X}}function Y(){X.r||s(X.c),X=X.p}function Q(e,t){e&&e.i&&(J.delete(e),e.i(t))}function W(e,t,n,l){if(e&&e.o){if(J.has(e))return;J.add(e),X.c.push((()=>{J.delete(e),l&&(n&&e.d(1),l())})),e.o(t)}else l&&l()}function Z(e,t){W(e,1,1,(()=>{t.delete(e.key)}))}function ee(e){e&&e.c()}function te(e,t,l,r){const{fragment:o,after_update:i}=e.$$;o&&o.m(t,l),r||D((()=>{const t=e.$$.on_mount.map(n).filter(c);e.$$.on_destroy?e.$$.on_destroy.push(...t):s(t),e.$$.on_mount=[]})),i.forEach(D)}function ne(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];F.forEach((l=>-1===e.indexOf(l)?t.push(l):n.push(l))),n.forEach((e=>e())),F=t}(n.after_update),s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function le(e,t){-1===e.$$.dirty[0]&&(I.push(e),z||(z=!0,H.then(B)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function se(t,n,c,r,o,i,a,u=[-1]){const d=j;C(t);const m=t.$$={fragment:null,ctx:[],props:i,update:e,not_equal:o,bound:l(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(d?d.$$.context:[])),callbacks:l(),dirty:u,skip_bound:!1,root:n.target||d.$$.root};a&&a(m.root);let f=!1;if(m.ctx=c?c(t,n.props||{},((e,n,...l)=>{const s=l.length?l[0]:n;return m.ctx&&o(m.ctx[e],m.ctx[e]=s)&&(!m.skip_bound&&m.bound[e]&&m.bound[e](s),f&&le(t,e)),n})):[],m.update(),f=!0,s(m.before_update),m.fragment=!!r&&r(m.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);m.fragment&&m.fragment.l(e),e.forEach(h)}else m.fragment&&m.fragment.c();n.intro&&Q(t.$$.fragment),te(t,n.target,n.anchor,n.customElement),B()}C(d)}class ce{$destroy(){ne(this,1),this.$destroy=e}$on(t,n){if(!c(n))return e;const l=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return l.push(n),()=>{const e=l.indexOf(n);-1!==e&&l.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const re=[];function oe(t,n=e){let l;const s=new Set;function c(e){if(r(t,e)&&(t=e,l)){const e=!re.length;for(const e of s)e[1](),re.push(e,t);if(e){for(let e=0;e<re.length;e+=2)re[e][0](re[e+1]);re.length=0}}}return{set:c,update:function(e){c(e(t))},subscribe:function(r,o=e){const i=[r,o];return s.add(i),1===s.size&&(l=n(c)||e),r(t),()=>{s.delete(i),0===s.size&&l&&(l(),l=null)}}}}function ie(t,n,l){const r=!Array.isArray(t),o=r?[t]:t,i=n.length<2;return u=t=>{let l=!1;const u=[];let d=0,m=e;const f=()=>{if(d)return;m();const l=n(r?u[0]:u,t);i?t(l):m=c(l)?l:e},p=o.map(((e,t)=>a(e,(e=>{u[t]=e,d&=~(1<<t),l&&f()}),(()=>{d|=1<<t}))));return l=!0,f(),function(){s(p),m(),l=!1}},{subscribe:oe(l,u).subscribe};var u}const ae=APP_LANG,ue=APP_NAME;USER_ID;const de=CSRF_TOKEN;ADDITIONAL_MODULES;const me="Regions";SAS_APP_URL;const fe=CANTALOUPE_APP_URL;function pe(e=null,t="full",n="full"){if(!e)return"https://via.placeholder.com/96x96?text=No+Image";if((e=e.split("_")).length<3)return"https://via.placeholder.com/96x96?text=No+Image";const l=e[e.length-1].includes(",")?e.pop().replace(".jpg",""):t,s=e.join("_").replace(".jpg","");return`${fe??"http://localhost:8182"}/iiif/2/${s}.jpg/${l}/${n}/0/default.jpg`}MEDIA_PATH;const he=function(){const e={id:null,type:"documentSet",title:"en"===ae?"Document set":"Set de document",selected:{}},t={id:null,type:"regionsSet",title:"en"===ae?"Regions set":"Set de régions",selected:{}},n=oe({records:JSON.parse(localStorage.getItem("documentSet"))||e,regions:JSON.parse(localStorage.getItem("regionsSet"))||t}),{subscribe:l,update:s,get:c}=n,r=oe(!1);function o(e,t=!1){r.set(t),localStorage.setItem(e.type,JSON.stringify(e))}function i(e,t){return e[t?"regions":"records"]?.selected||{}}function a(e,t=!0){const n=i(e,t);return t?n[me]??{}:Object.entries(n)}function u(e,t,n){const l=n===me?"regions":"records",s=e[l],{[t]:c,...r}=s.selected[n];return e[l]={...s,selected:{...s.selected,[n]:r}},o(e[l]),e}function d(e,t,n=!0){const l=t.type===me?"regions":"records",s=e[l],c=s.selected,r=t.type===me?t:{title:t.title,url:t.url};return e[l]={...s,selected:{...c,[t.type]:{...c[t.type]||{},[t.id]:r}}},n&&o(e[l]),e}return{subscribe:l,save:e=>s((t=>function(e,t){const n=t?"regions-set":"document-set";if(t)return window.alert("Region set management is not yet implemented"),e;let l=e[t?"regions":"records"],c={};Object.entries(l.selected).forEach((([e,t])=>{c[e]=Object.keys(t)}));const o=null!==l.id?`${l.id}/change`:"add";return fetch(`${window.location.origin}/${n}/${o}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":de},body:JSON.stringify({title:l.title,...c})}).then((e=>e.json())).then((e=>{if(!e?.document_set_id)throw new Error("Failed to save selection");s((n=>{const l=n[t?"regions":"records"];return l.id=e.document_set_id,l.title=e.document_set_title,r.set(!0),n}))})).catch((e=>console.error("Error:",e))),e}(t,e))),empty:n=>s((l=>(l[n?"regions":"records"]=n?t:e,o(l[n?"regions":"records"]),l))),removeAll:(e,t)=>s((n=>function(e,t,n){const l=n===me?"regions":"records",s=e[l];let c=s.selected[n];return c&&Object.keys(c).length?(t.forEach((e=>{delete c[e]})),e[l]={...s,selected:{...s.selected,[n]:c}},o(e[l]),e):e}(n,e,t))),remove:(e,t)=>s((n=>u(n,e,t))),addAll:e=>s((t=>function(e,t){const n=t[0].type===me;return t.forEach((t=>{e=d(e,t,!1)})),o(e[n?"regions":"records"]),e}(t,e))),add:e=>s((t=>d(t,e))),toggle:e=>s((t=>{const n=i(t,e.type===me);return n[e.type]?.[e.id]?u(t,e.id,e.type):d(t,e)})),updateTitle:(e,t)=>s((n=>{const l=t?"regions":"records";return n[l]={...n[l],title:e},o(n[l],!0),n})),isSaved:r,isSelected:ie(n,(e=>t=>i(e,t.type===me)[t.type]?.hasOwnProperty(t.id)||!1)),selected:ie(n,(e=>t=>a(e,t))),nbSelected:ie(n,(e=>t=>{const n=a(e,t);return t?Object.keys(n).length:n.reduce(((e,[t,n])=>e+Object.keys(n).length),0)})),selectionTitle:ie(n,(e=>t=>e[t?"regions":"records"].title)),selection:ie(n,(e=>t=>e[t?"regions":"records"]))}}();function ge(e){let t,n,l,s,c;return{c(){t=b("a"),n=b("i"),l=v(),s=b("span"),s.textContent=""+("en"===ae?"Relaunch same treatment":"Relancer le même traitement"),_(n,"class","fa-solid fa-arrow-rotate-left"),_(t,"href",c="add/"+e[0].query_parameters),_(t,"class","button is-small is-rounded is-primary is-outlined px-2 py-1 mr-2"),_(t,"title","en"===ae?"Relaunch same treatment":"Relancer le même traitement")},m(e,c){p(e,t,c),f(t,n),f(t,l),f(t,s)},p(e,n){1&n&&c!==(c="add/"+e[0].query_parameters)&&_(t,"href",c)},d(e){e&&h(t)}}}function be(t){let n,l,s,c,r,o;return{c(){n=b("button"),l=b("i"),s=v(),c=b("span"),c.textContent=""+("en"===ae?"Cancel treatment":"Annuler le traitement"),_(l,"class","fa-solid fa-ban"),_(n,"class","button is-small is-rounded is-danger is-outlined px-2 py-1 mr-2"),_(n,"title","en"===ae?"Cancel treatment":"Annuler le traitement")},m(e,i){p(e,n,i),f(n,l),f(n,s),f(n,c),r||(o=k(n,"click",t[1]),r=!0)},p:e,d(e){e&&h(n),r=!1,o()}}}function $e(e){let t,n,l=e[0].status+"";return{c(){t=b("span"),n=y(l),_(t,"class","tag is-info p-1 mb-1")},m(e,l){p(e,t,l),f(t,n)},p(e,t){1&t&&l!==(l=e[0].status+"")&&O(n,l)},d(e){e&&h(t)}}}function ye(e){let t,n,l=e[0].status+"";return{c(){t=b("span"),n=y(l),_(t,"class","tag is-danger p-1 mb-1")},m(e,l){p(e,t,l),f(t,n)},p(e,t){1&t&&l!==(l=e[0].status+"")&&O(n,l)},d(e){e&&h(t)}}}function ve(e){let t,n,l=e[0].status+"";return{c(){t=b("span"),n=y(l),_(t,"class","tag is-success p-1 mb-1")},m(e,l){p(e,t,l),f(t,n)},p(e,t){1&t&&l!==(l=e[0].status+"")&&O(n,l)},d(e){e&&h(t)}}}function we(t){let n,l;function s(e,t){return!e[0].is_finished&&e[0].api_tracking_id?be:e[0].is_finished&&"ERROR"===e[0].status?ge:void 0}let c=s(t),r=c&&c(t);function o(e,t){return"SUCCESS"===e[0].status?ve:"ERROR"===e[0].status?ye:$e}let i=o(t),a=i(t);return{c(){n=b("div"),r&&r.c(),l=v(),a.c()},m(e,t){p(e,n,t),r&&r.m(n,null),f(n,l),a.m(n,null)},p(e,[t]){c===(c=s(e))&&r?r.p(e,t):(r&&r.d(1),r=c&&c(e),r&&(r.c(),r.m(n,l))),i===(i=o(e))&&a?a.p(e,t):(a.d(1),a=i(e),a&&(a.c(),a.m(n,null)))},i:e,o:e,d(e){e&&h(n),r&&r.d(),a.d()}}}function ke(e,t,n){let{item:l}=t;return e.$$set=e=>{"item"in e&&n(0,l=e.item)},[l,()=>async function(e){if(confirm("en"===APP_LANG?"Are you sure you want to cancel treatment?":"Êtes-vous sûr de vouloir annuler le traitement en cours ?"))try{(await fetch(`/${ue}/cancel-treatment/${e}`,{method:"GET"})).ok?window.alert("en"===APP_LANG?"Successfully cancelled treatment":"Le traitement a été annulé"):window.alert("en"===APP_LANG?"Treatment could not be cancelled":"Le traitement n'a pas pu être annulé")}catch(e){window.alert("en"===APP_LANG?"Error connecting to API":"Erreur lors de la connexion à l'API")}}(l.id)]}class xe extends ce{constructor(e){super(),se(this,e,ke,we,r,{item:0})}}function _e(e){let t,n,l=e[1]?"Retirer de la":"Ajouter à la";return{c(){t=y(l),n=y(" sélection")},m(e,l){p(e,t,l),p(e,n,l)},p(e,n){2&n&&l!==(l=e[1]?"Retirer de la":"Ajouter à la")&&O(t,l)},d(e){e&&h(t),e&&h(n)}}}function Se(e){let t,n,l=e[1]?"Remove from":"Add to";return{c(){t=y(l),n=y(" selection")},m(e,l){p(e,t,l),p(e,n,l)},p(e,n){2&n&&l!==(l=e[1]?"Remove from":"Add to")&&O(t,l)},d(e){e&&h(t),e&&h(n)}}}function Pe(e){let t;return{c(){t=$("path"),_(t,"d","M0 48C0 21.5 21.5 0 48 0l0 48V441.4l130.1-92.9c8.3-6 19.6-6 27.9 0L336 441.4V48H48V0H336c26.5 0 48 21.5 48 48V488c0 9-5 17.2-13 21.3s-17.6 3.4-24.9-1.8L192 397.5 37.9 507.5c-7.3 5.2-16.9 5.9-24.9 1.8S0 497 0 488V48z")},m(e,n){p(e,t,n)},d(e){e&&h(t)}}}function Le(e){let t;return{c(){t=$("path"),_(t,"d","M0 48V487.7C0 501.1 10.9 512 24.3 512c5 0 9.9-1.5 14-4.4L192 400 345.7 507.6c4.1 2.9 9 4.4 14 4.4c13.4 0 24.3-10.9 24.3-24.3V48c0-26.5-21.5-48-48-48H48C21.5 0 0 21.5 0 48z")},m(e,n){p(e,t,n)},d(e){e&&h(t)}}}function Oe(t){let n,l,s,c,r;let o=("en"===ae?Se:_e)(t);function i(e,t){return e[1]?Le:Pe}let a=i(t),u=a(t);return{c(){n=b("button"),o.c(),l=v(),s=$("svg"),u.c(),_(s,"xmlns","http://www.w3.org/2000/svg"),_(s,"viewBox","0 0 384 512"),_(s,"class","svelte-135nggd"),_(n,"class","button"),E(n,"is-inverted",t[1])},m(e,i){p(e,n,i),o.m(n,null),f(n,l),f(n,s),u.m(s,null),c||(r=k(n,"click",t[2]),c=!0)},p(e,[t]){o.p(e,t),a!==(a=i(e))&&(u.d(1),u=a(e),u&&(u.c(),u.m(s,null))),2&t&&E(n,"is-inverted",e[1])},i:e,o:e,d(e){e&&h(n),o.d(),u.d(),c=!1,r()}}}function Ae(e,t,n){let{item:l}=t,{itemSelected:s}=t;return e.$$set=e=>{"item"in e&&n(0,l=e.item),"itemSelected"in e&&n(1,s=e.itemSelected)},[l,s,()=>he.toggle(l)]}class Ne extends ce{constructor(e){super(),se(this,e,Ae,Oe,r,{item:0,itemSelected:1})}}function Re(e,t,n){const l=e.slice();return l[4]=t[n][0],l[5]=t[n][1],l}function Ee(e,t,n){const l=e.slice();return l[8]=t[n],l}function je(e){let t,n,l,s;return{c(){t=b("div"),n=b("figure"),l=b("img"),i(l.src,s=pe(e[0].img,"full","250,"))||_(l,"src",s),_(l,"alt","Record illustration"),_(n,"class","card image is-96x96 svelte-sga8e3"),_(t,"class","media-left")},m(e,s){p(e,t,s),f(t,n),f(n,l)},p(e,t){1&t&&!i(l.src,s=pe(e[0].img,"full","250,"))&&_(l,"src",s)},d(e){e&&h(t)}}}function Ce(e){let t,n,l,s,c,r,o,i,a,u=e[0].type+"",d=e[0].id+"",m=e[0].title+"",g=e[0].is_public&&Ie();return{c(){t=b("a"),n=b("span"),l=y(u),s=y(" #"),c=y(d),r=v(),o=y(m),i=v(),g&&g.c(),_(n,"class","tag px-2 py-1 mb-1 mr-1 is-dark is-rounded"),_(t,"href",a=e[0].url),_(t,"class","title is-4 hoverable pt-2 svelte-sga8e3")},m(e,a){p(e,t,a),f(t,n),f(n,l),f(n,s),f(n,c),f(t,r),f(t,o),f(t,i),g&&g.m(t,null)},p(e,n){1&n&&u!==(u=e[0].type+"")&&O(l,u),1&n&&d!==(d=e[0].id+"")&&O(c,d),1&n&&m!==(m=e[0].title+"")&&O(o,m),e[0].is_public?g||(g=Ie(),g.c(),g.m(t,null)):g&&(g.d(1),g=null),1&n&&a!==(a=e[0].url)&&_(t,"href",a)},d(e){e&&h(t),g&&g.d()}}}function Te(e){let t,n,l,s,c,r,o,i=e[0].type+"",a=e[0].id+"",u=e[0].title+"";return{c(){t=b("span"),n=b("span"),l=y(i),s=y(" #"),c=y(a),r=v(),o=y(u),_(n,"class","tag px-2 py-1 mb-1 mr-1 is-dark is-rounded"),_(t,"class","title is-4 pt-2")},m(e,i){p(e,t,i),f(t,n),f(n,l),f(n,s),f(n,c),f(t,r),f(t,o)},p(e,t){1&t&&i!==(i=e[0].type+"")&&O(l,i),1&t&&a!==(a=e[0].id+"")&&O(c,a),1&t&&u!==(u=e[0].title+"")&&O(o,u)},d(e){e&&h(t)}}}function Ie(e){let t;return{c(){t=b("span"),t.innerHTML='<span class="icon has-text-success"><i class="fas fa-check-circle"></i></span> \n                                <span style="margin-left: -0.5rem">Public</span>',_(t,"class","pl-3 icon-text is-size-7 is-center has-text-weight-normal")},m(e,n){p(e,t,n)},d(e){e&&h(t)}}}function Me(e){let t,n=e[0].user+"";return{c(){t=y(n)},m(e,n){p(e,t,n)},p(e,l){1&l&&n!==(n=e[0].user+"")&&O(t,n)},d(e){e&&h(t)}}}function Fe(e){let t,n,l=e[0].updated_at+"";return{c(){t=b("span"),n=y(l),_(t,"class","tag p-1 mb-1")},m(e,l){p(e,t,l),f(t,n)},p(e,t){1&t&&l!==(l=e[0].updated_at+"")&&O(n,l)},d(e){e&&h(t)}}}function Ue(e){let t,n,l=e[0].hasOwnProperty("iiif"),s=e[0].buttons.hasOwnProperty("regions"),c=l&&He(e),r=s&&De(e);return{c(){t=b("p"),c&&c.c(),n=v(),r&&r.c(),_(t,"class","subtitle is-6 mb-0 ml-2 pt-2 is-middle")},m(e,l){p(e,t,l),c&&c.m(t,null),f(t,n),r&&r.m(t,null)},p(e,o){1&o&&(l=e[0].hasOwnProperty("iiif")),l?c?c.p(e,o):(c=He(e),c.c(),c.m(t,n)):c&&(c.d(1),c=null),1&o&&(s=e[0].buttons.hasOwnProperty("regions")),s?r?r.p(e,o):(r=De(e),r.c(),r.m(t,null)):r&&(r.d(1),r=null)},d(e){e&&h(t),c&&c.d(),r&&r.d()}}}function He(e){let t,n=e[0].iiif,l=[];for(let t=0;t<n.length;t+=1)l[t]=ze(Ee(e,n,t));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=w()},m(e,n){for(let t=0;t<l.length;t+=1)l[t]&&l[t].m(e,n);p(e,t,n)},p(e,s){if(1&s){let c;for(n=e[0].iiif,c=0;c<n.length;c+=1){const r=Ee(e,n,c);l[c]?l[c].p(r,s):(l[c]=ze(r),l[c].c(),l[c].m(t.parentNode,t))}for(;c<l.length;c+=1)l[c].d(1);l.length=n.length}},d(e){g(l,e),e&&h(t)}}}function ze(e){let t,n=e[8]+"";return{c(){t=b("span"),_(t,"class","tag logo mt-1")},m(e,l){p(e,t,l),t.innerHTML=n},p(e,l){1&l&&n!==(n=e[8]+"")&&(t.innerHTML=n)},d(e){e&&h(t)}}}function De(e){let t,n,l,s,c;return{c(){t=b("a"),n=b("span"),l=v(),s=b("span"),s.textContent=""+("en"===ae?"Show regions":"Afficher les régions"),_(n,"class","iconify"),_(n,"data-icon","entypo:documents"),_(s,"class","ml-2"),_(t,"href",c=e[0].buttons.regions),_(t,"class","regions-btn button is-small is-rounded is-link px-2 svelte-sga8e3"),_(t,"title","en"===ae?"View image regions":"Afficher les régions d'images")},m(e,c){p(e,t,c),f(t,n),f(t,l),f(t,s)},p(e,n){1&n&&c!==(c=e[0].buttons.regions)&&_(t,"href",c)},d(e){e&&h(t)}}}function Ve(e){let t,n;return t=new Ne({props:{item:e[0],itemSelected:e[1]}}),{c(){ee(t.$$.fragment)},m(e,l){te(t,e,l),n=!0},p(e,n){const l={};1&n&&(l.item=e[0]),2&n&&(l.itemSelected=e[1]),t.$set(l)},i(e){n||(Q(t.$$.fragment,e),n=!0)},o(e){W(t.$$.fragment,e),n=!1},d(e){ne(t,e)}}}function Ge(e){let t,n;return t=new xe({props:{item:e[0]}}),{c(){ee(t.$$.fragment)},m(e,l){te(t,e,l),n=!0},p(e,n){const l={};1&n&&(l.item=e[0]),t.$set(l)},i(e){n||(Q(t.$$.fragment,e),n=!0)},o(e){W(t.$$.fragment,e),n=!1},d(e){ne(t,e)}}}function Be(e){let t,n,l,s,c,r,o,i=e[4]+"",a=e[5]+"";return{c(){t=b("div"),n=b("div"),l=y(i),s=v(),c=b("div"),o=v(),_(n,"class","column is-4 is-bold"),_(c,"class",r="column is-8 "+("-"===e[5]?"faded":"")),_(t,"class","datum is-middle columns svelte-sga8e3")},m(e,r){p(e,t,r),f(t,n),f(n,l),f(t,s),f(t,c),c.innerHTML=a,f(t,o)},p(e,t){1&t&&i!==(i=e[4]+"")&&O(l,i),1&t&&a!==(a=e[5]+"")&&(c.innerHTML=a),1&t&&r!==(r="column is-8 "+("-"===e[5]?"faded":""))&&_(c,"class",r)},d(e){e&&h(t)}}}function qe(e){let t,n,l,s,c,r,o,i,a,u,d,m,$,y,w,k,x,S,P=e[0].hasOwnProperty("img"),L=e[0].hasOwnProperty("buttons")&&0!==Object.keys(e[0].buttons).length,O=P&&je(e);function A(e,t){return"Treatment"===e[0].class?Te:Ce}let N=A(e),R=N(e),E=e[0].user&&Me(e),j=e[0].updated_at&&Fe(e),C=L&&Ue(e);const T=[Ge,Ve],I=[];function M(e,t){return"Treatment"===e[0].class?0:1}$=M(e),y=I[$]=T[$](e);let F=Object.entries(e[0].metadata),U=[];for(let t=0;t<F.length;t+=1)U[t]=Be(Re(e,F,t));return{c(){t=b("div"),n=b("div"),l=b("div"),s=b("div"),O&&O.c(),c=v(),r=b("div"),R.c(),o=v(),i=b("p"),E&&E.c(),a=v(),j&&j.c(),u=v(),C&&C.c(),d=v(),m=b("div"),y.c(),w=v(),k=b("div"),x=b("div");for(let e=0;e<U.length;e+=1)U[e].c();_(i,"class","subtitle is-6 mb-0 ml-2 pt-2"),_(r,"class","media-content"),_(m,"class","media-right"),_(s,"class","media"),_(x,"class","grid metadata pt-2 svelte-sga8e3"),_(k,"class","content fixed-grid px-5"),_(l,"class","card-content"),_(n,"class","card mb-3"),_(t,"class","item")},m(e,h){p(e,t,h),f(t,n),f(n,l),f(l,s),O&&O.m(s,null),f(s,c),f(s,r),R.m(r,null),f(r,o),f(r,i),E&&E.m(i,null),f(i,a),j&&j.m(i,null),f(r,u),C&&C.m(r,null),f(s,d),f(s,m),I[$].m(m,null),f(l,w),f(l,k),f(k,x);for(let e=0;e<U.length;e+=1)U[e]&&U[e].m(x,null);S=!0},p(e,[t]){1&t&&(P=e[0].hasOwnProperty("img")),P?O?O.p(e,t):(O=je(e),O.c(),O.m(s,c)):O&&(O.d(1),O=null),N===(N=A(e))&&R?R.p(e,t):(R.d(1),R=N(e),R&&(R.c(),R.m(r,o))),e[0].user?E?E.p(e,t):(E=Me(e),E.c(),E.m(i,a)):E&&(E.d(1),E=null),e[0].updated_at?j?j.p(e,t):(j=Fe(e),j.c(),j.m(i,null)):j&&(j.d(1),j=null),1&t&&(L=e[0].hasOwnProperty("buttons")&&0!==Object.keys(e[0].buttons).length),L?C?C.p(e,t):(C=Ue(e),C.c(),C.m(r,null)):C&&(C.d(1),C=null);let n=$;if($=M(e),$===n?I[$].p(e,t):(K(),W(I[n],1,1,(()=>{I[n]=null})),Y(),y=I[$],y?y.p(e,t):(y=I[$]=T[$](e),y.c()),Q(y,1),y.m(m,null)),1&t){let n;for(F=Object.entries(e[0].metadata),n=0;n<F.length;n+=1){const l=Re(e,F,n);U[n]?U[n].p(l,t):(U[n]=Be(l),U[n].c(),U[n].m(x,null))}for(;n<U.length;n+=1)U[n].d(1);U.length=F.length}},i(e){S||(Q(y),S=!0)},o(e){W(y),S=!1},d(e){e&&h(t),O&&O.d(),R.d(),E&&E.d(),j&&j.d(),C&&C.d(),I[$].d(),g(U,e)}}}function Je(e,t,n){let l,s;const{isSelected:c}=he;d(e,c,(e=>n(3,s=e)));let{item:r}=t;return e.$$set=e=>{"item"in e&&n(0,r=e.item)},e.$$.update=()=>{9&e.$$.dirty&&n(1,l=s(r))},[r,l,c,s]}class Xe extends ce{constructor(e){super(),se(this,e,Je,qe,r,{item:0})}}function Ke(t){let n,l,s,c,r,o,i,a,u,d="en"===ae?"Selection":"Sélection";return{c(){n=b("div"),l=b("button"),s=b("span"),c=b("i"),r=v(),o=y(d),i=y("\n            ("),a=y(t[0]),u=y(")"),_(c,"class","fa-solid fa-book-bookmark"),_(s,"id","btn-content"),_(l,"id","set-btn"),_(l,"class","button px-5 py-4 is-link js-modal-trigger svelte-hs48f9"),_(l,"data-target","selection-modal"),_(n,"class","set-container svelte-hs48f9")},m(e,t){p(e,n,t),f(n,l),f(l,s),f(s,c),f(s,r),f(s,o),f(s,i),f(s,a),f(s,u)},p(e,[t]){1&t&&O(a,e[0])},i:e,o:e,d(e){e&&h(n)}}}function Ye(e,t,n){let{selectionLength:l=0}=t,s=l;return e.$$set=e=>{"selectionLength"in e&&n(0,l=e.selectionLength)},e.$$.update=()=>{if(3&e.$$.dirty&&l!==s){const e=l>s;n(1,s=l);const t=document.getElementById("btn-content");t&&t.animate([{transform:e?"translateY(-7px)":"translateX(-5px)"},{transform:e?"translateY(7px)":"translateX(5px)"},{transform:"translate(0)"}],{duration:300,easing:"cubic-bezier(0.65, 0, 0.35, 1)"})}},[l,s]}class Qe extends ce{constructor(e){super(),se(this,e,Ye,Ke,r,{selectionLength:0})}}function We(t){let n,l,s,c,r,o,i,a="en"===ae?"Save selection":"Sauvegarder la sélection";return{c(){n=b("button"),l=b("span"),s=b("i"),c=v(),r=y(a),_(s,"class","fa-solid fa-floppy-disk"),_(n,"class","button is-link")},m(e,a){p(e,n,a),f(n,l),f(l,s),f(l,c),f(l,r),o||(i=k(n,"click",t[6]),o=!0)},p:e,d(e){e&&h(n),o=!1,i()}}}function Ze(e){let t,n,l,s,c,r,o="en"===ae?"Go to treatment":"Accéder au traitement";return{c(){t=b("a"),n=b("span"),l=b("i"),s=v(),c=y(o),_(l,"class","fa-solid fa-gear"),_(t,"class","button is-link"),_(t,"href",r="/treatment/add/?document_set="+e[2](e[0]).id)},m(e,r){p(e,t,r),f(t,n),f(n,l),f(n,s),f(n,c)},p(e,n){5&n&&r!==(r="/treatment/add/?document_set="+e[2](e[0]).id)&&_(t,"href",r)},d(e){e&&h(t)}}}function et(t){let n,l,s,c,r,o;function i(e,t){return e[1]?Ze:We}let a=i(t),u=a(t);return{c(){n=b("footer"),l=b("div"),s=b("button"),s.textContent=""+("en"===ae?"Clear selection":"Vider la sélection"),c=v(),u.c(),_(s,"class","button button-close is-link is-light"),_(l,"class","buttons"),_(n,"class","modal-card-foot is-center")},m(e,i){p(e,n,i),f(n,l),f(l,s),f(l,c),u.m(l,null),r||(o=k(s,"click",t[5]),r=!0)},p(e,[t]){a===(a=i(e))&&u?u.p(e,t):(u.d(1),u=a(e),u&&(u.c(),u.m(l,null)))},i:e,o:e,d(e){e&&h(n),u.d(),r=!1,o()}}}function tt(e,t,n){let l,s;const{isSaved:c,selection:r}=he;d(e,c,(e=>n(1,l=e))),d(e,r,(e=>n(2,s=e)));let{isRegion:o=!0}=t;return e.$$set=e=>{"isRegion"in e&&n(0,o=e.isRegion)},[o,l,s,c,r,()=>he.empty(o),()=>he.save(o)]}class nt extends ce{constructor(e){super(),se(this,e,tt,et,r,{isRegion:0})}}function lt(e){let t,n,l,c,r,o,i=e[5](e[0])+"";return{c(){t=b("span"),n=y(i),l=v(),c=b("span"),c.innerHTML='<i class="fas fa-edit"></i>',_(c,"class","pl-3 smaller has-text-link")},m(s,i){p(s,t,i),f(t,n),f(t,l),f(t,c),r||(o=[k(t,"click",e[7]),k(t,"keyup",null)],r=!0)},p(e,t){33&t&&i!==(i=e[5](e[0])+"")&&O(n,i)},d(e){e&&h(t),r=!1,s(o)}}}function st(e){let t,n,l;return{c(){t=b("input"),_(t,"class","input selection-title svelte-sgypdx")},m(s,c){p(s,t,c),e[12](t),A(t,e[4]),n||(l=[k(t,"input",e[13]),k(t,"keydown",e[8]),k(t,"blur",e[9])],n=!0)},p(e,n){16&n&&t.value!==e[4]&&A(t,e[4])},d(c){c&&h(t),e[12](null),n=!1,s(l)}}}function ct(e){let t,n,l,s,c,r,o,i,a,u,d,g,$,w,k,x,S,P;function L(e,t){return e[2]?st:lt}let A=L(e),N=A(e);const R=e[11].default,E=function(e,t,n,l){if(e){const s=m(e,t,n,l);return e[0](s)}}(R,e,e[10],null);return S=new nt({props:{isRegion:e[0]}}),{c(){t=b("div"),n=b("div"),l=v(),s=b("div"),c=b("div"),r=b("div"),o=b("i"),i=v(),N.c(),a=y("\n                ("),u=y(e[1]),d=y(")"),g=v(),$=b("button"),w=v(),k=b("section"),E&&E.c(),x=v(),ee(S.$$.fragment),_(n,"class","modal-background"),_(o,"class","fa-solid fa-book-bookmark"),_(r,"class","title is-4 mb-0 media-content"),_($,"class","delete media-left"),_($,"aria-label","close"),_(c,"class","modal-card-head media mb-0 is-middle"),_(k,"class","modal-card-body"),_(s,"class","modal-content"),_(t,"id","selection-modal"),_(t,"class","modal fade"),_(t,"tabindex","-1"),_(t,"aria-labelledby","selection-modal-label"),_(t,"aria-hidden","true")},m(e,m){p(e,t,m),f(t,n),f(t,l),f(t,s),f(s,c),f(c,r),f(r,o),f(r,i),N.m(r,null),f(r,a),f(r,u),f(r,d),f(c,g),f(c,$),f(s,w),f(s,k),E&&E.m(k,null),f(s,x),te(S,s,null),P=!0},p(e,[t]){A===(A=L(e))&&N?N.p(e,t):(N.d(1),N=A(e),N&&(N.c(),N.m(r,a))),(!P||2&t)&&O(u,e[1]),E&&E.p&&(!P||1024&t)&&function(e,t,n,l,s,c){if(s){const r=m(t,n,l,c);e.p(r,s)}}(E,R,e,e[10],P?function(e,t,n,l){if(e[2]&&l){const s=e[2](l(n));if(void 0===t.dirty)return s;if("object"==typeof s){const e=[],n=Math.max(t.dirty.length,s.length);for(let l=0;l<n;l+=1)e[l]=t.dirty[l]|s[l];return e}return t.dirty|s}return t.dirty}(R,e[10],t,null):function(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}(e[10]),null);const n={};1&t&&(n.isRegion=e[0]),S.$set(n)},i(e){P||(Q(E,e),Q(S.$$.fragment,e),P=!0)},o(e){W(E,e),W(S.$$.fragment,e),P=!1},d(e){e&&h(t),N.d(),E&&E.d(e),ne(S)}}}function rt(e,t,n){let l,{$$slots:s={},$$scope:c}=t;const{selectionTitle:r,updateTitle:o,save:i}=he;d(e,r,(e=>n(5,l=e)));let a,u,{isRegion:m=!1}=t,{selectionLength:f=!1}=t,p=!1;function h(){n(2,p=!1),o(u,m),i(m)}return e.$$set=e=>{"isRegion"in e&&n(0,m=e.isRegion),"selectionLength"in e&&n(1,f=e.selectionLength),"$$scope"in e&&n(10,c=e.$$scope)},[m,f,p,a,u,l,r,function(){n(2,p=!0),n(4,u=l(m)),setTimeout((()=>a&&a.focus()),0)},function(e){"Enter"===e.key&&h()},h,c,s,function(e){M[e?"unshift":"push"]((()=>{a=e,n(3,a)}))},function(){u=this.value,n(4,u)}]}class ot extends ce{constructor(e){super(),se(this,e,rt,ct,r,{isRegion:0,selectionLength:1})}}function it(e,t,n){const l=e.slice();return l[13]=t[n],l[14]=t,l[15]=n,l}function at(e,t,n){const l=e.slice();return l[16]=t[n],l}function ut(e){let t,n,l,s,c,r,o,i,a,u,d="en"===ae?"Search":"Rechercher",m=e[0],$=[];for(let t=0;t<m.length;t+=1)$[t]=$t(it(e,m,t));return{c(){t=b("form"),n=b("article");for(let e=0;e<$.length;e+=1)$[e].c();l=v(),s=b("div"),c=b("button"),r=b("i"),o=v(),i=y(d),_(n,"class","message grid"),_(r,"class","fa-solid fa-magnifying-glass"),_(c,"type","submit"),_(c,"class","button is-link is-outlined is-fullwidth"),_(s,"class","panel-block columns"),_(t,"class","fixed-grid is-center")},m(d,m){p(d,t,m),f(t,n);for(let e=0;e<$.length;e+=1)$[e]&&$[e].m(n,null);f(t,l),f(t,s),f(s,c),f(c,r),f(c,o),f(c,i),a||(u=k(t,"submit",e[3]),a=!0)},p(e,t){if(19&t){let l;for(m=e[0],l=0;l<m.length;l+=1){const s=it(e,m,l);$[l]?$[l].p(s,t):($[l]=$t(s),$[l].c(),$[l].m(n,null))}for(;l<$.length;l+=1)$[l].d(1);$.length=m.length}},d(e){e&&h(t),g($,e),a=!1,u()}}}function dt(e){let t,n,l,s,c;function r(){e[10].call(t,e[13])}return{c(){t=b("input"),_(t,"type","text"),_(t,"class","input is-small is-wide"),_(t,"id",n=e[13].name),_(t,"name",l=e[13].name)},m(n,l){p(n,t,l),A(t,e[1][e[13].name]),s||(c=k(t,"input",r),s=!0)},p(s,c){e=s,1&c&&n!==(n=e[13].name)&&_(t,"id",n),1&c&&l!==(l=e[13].name)&&_(t,"name",l),3&c&&t.value!==e[1][e[13].name]&&A(t,e[1][e[13].name])},d(e){e&&h(t),s=!1,c()}}}function mt(e){let t,n,l,s,c;function r(){e[9].call(t,e[13])}return{c(){t=b("input"),_(t,"type","number"),_(t,"class","input is-small is-wide"),_(t,"id",n=e[13].name),_(t,"name",l=e[13].name)},m(n,l){p(n,t,l),A(t,e[1][e[13].name]),s||(c=k(t,"input",r),s=!0)},p(s,c){e=s,1&c&&n!==(n=e[13].name)&&_(t,"id",n),1&c&&l!==(l=e[13].name)&&_(t,"name",l),3&c&&L(t.value)!==e[1][e[13].name]&&A(t,e[1][e[13].name])},d(e){e&&h(t),s=!1,c()}}}function ft(e){let t,n,l,s,c,r;function o(){e[8].call(n,e[13])}return{c(){t=y("}\n                            "),n=b("input"),_(n,"type","date"),_(n,"class","input is-small is-wide"),_(n,"id",l=e[13].name),_(n,"name",s=e[13].name)},m(l,s){p(l,t,s),p(l,n,s),A(n,e[1][e[13].name]),c||(r=k(n,"input",o),c=!0)},p(t,c){e=t,1&c&&l!==(l=e[13].name)&&_(n,"id",l),1&c&&s!==(s=e[13].name)&&_(n,"name",s),3&c&&A(n,e[1][e[13].name])},d(e){e&&h(t),e&&h(n),c=!1,r()}}}function pt(e){let t,n,l,s,c;function r(){e[7].call(t,e[13])}return{c(){t=b("input"),_(t,"type","checkbox"),_(t,"id",n=e[13].name),_(t,"name",l=e[13].name)},m(n,l){p(n,t,l),t.checked=e[1][e[13].name],s||(c=k(t,"change",r),s=!0)},p(s,c){e=s,1&c&&n!==(n=e[13].name)&&_(t,"id",n),1&c&&l!==(l=e[13].name)&&_(t,"name",l),3&c&&(t.checked=e[1][e[13].name])},d(e){e&&h(t),s=!1,c()}}}function ht(e){let n,l,s,c,r,o,i,a,u=!e[4](e[13]),d=u&&gt(),m=e[13].choices,$=[];for(let t=0;t<m.length;t+=1)$[t]=bt(at(e,m,t));let y=[{id:c=e[13].name},{name:r=e[13].name},{class:"is-wide"},e[4](e[13])?{size:3,multiple:!0}:{}],v={};for(let e=0;e<y.length;e+=1)v=t(v,y[e]);function x(){e[6].call(l,e[13])}return{c(){n=b("div"),l=b("select"),d&&d.c(),s=w();for(let e=0;e<$.length;e+=1)$[e].c();P(l,v),void 0===e[1][e[13].name]&&D(x),E(l,"svelte-wwfwxh",!0),_(n,"class",o="select is-small is-wide "+(e[4](e[13])?"is-multiple":""))},m(t,c){p(t,n,c),f(n,l),d&&d.m(l,null),f(l,s);for(let e=0;e<$.length;e+=1)$[e]&&$[e].m(l,null);"value"in v&&(v.multiple?R:N)(l,v.value),l.autofocus&&l.focus(),N(l,e[1][e[13].name],!0),i||(a=k(l,"change",x),i=!0)},p(t,i){if(e=t,1&i&&(u=!e[4](e[13])),u?d||(d=gt(),d.c(),d.m(l,s)):d&&(d.d(1),d=null),1&i){let t;for(m=e[13].choices,t=0;t<m.length;t+=1){const n=at(e,m,t);$[t]?$[t].p(n,i):($[t]=bt(n),$[t].c(),$[t].m(l,null))}for(;t<$.length;t+=1)$[t].d(1);$.length=m.length}P(l,v=function(e,t){const n={},l={},s={$$scope:1};let c=e.length;for(;c--;){const r=e[c],o=t[c];if(o){for(const e in r)e in o||(l[e]=1);for(const e in o)s[e]||(n[e]=o[e],s[e]=1);e[c]=o}else for(const e in r)s[e]=1}for(const e in l)e in n||(n[e]=void 0);return n}(y,[1&i&&c!==(c=e[13].name)&&{id:c},1&i&&r!==(r=e[13].name)&&{name:r},{class:"is-wide"},1&i&&(e[4](e[13])?{size:3,multiple:!0}:{})])),17&i&&"value"in v&&(v.multiple?R:N)(l,v.value),3&i&&N(l,e[1][e[13].name]),E(l,"svelte-wwfwxh",!0),1&i&&o!==(o="select is-small is-wide "+(e[4](e[13])?"is-multiple":""))&&_(n,"class",o)},d(e){e&&h(n),d&&d.d(),g($,e),i=!1,a()}}}function gt(e){let t;return{c(){t=b("option"),t.textContent="Select ...",t.__value="",t.value=t.__value,t.disabled=!0,t.selected=!0,_(t,"class","faded")},m(e,n){p(e,t,n)},d(e){e&&h(t)}}}function bt(e){let t,n,l,s=e[16].label+"";return{c(){t=b("option"),n=y(s),t.__value=l=e[16].value,t.value=t.__value},m(e,l){p(e,t,l),f(t,n)},p(e,c){1&c&&s!==(s=e[16].label+"")&&O(n,s),1&c&&l!==(l=e[16].value)&&(t.__value=l,t.value=t.__value)},d(e){e&&h(t)}}}function $t(e){let t,n,l,s,c,r,o,i,a,u=e[13].label+"";function d(e,t){return 1&t&&(o=null),1&t&&(i=null),null==o&&(o=!!e[13].type.includes("ChoiceField")),o?ht:"BooleanField"===e[13].type?pt:(null==i&&(i=!!e[13].type.includes("Date")),i?ft:"IntegerField"===e[13].type||"FloatField"===e[13].type?mt:dt)}let m=d(e,-1),g=m(e);return{c(){t=b("div"),n=b("label"),l=y(u),c=v(),r=b("div"),g.c(),a=v(),_(n,"for",s=e[13].name),_(n,"class","label column is-small is-3 svelte-wwfwxh"),_(r,"class","control has-icons-right column is-9"),_(t,"class","search-field field columns is-middle svelte-wwfwxh")},m(e,s){p(e,t,s),f(t,n),f(n,l),f(t,c),f(t,r),g.m(r,null),f(t,a)},p(e,t){1&t&&u!==(u=e[13].label+"")&&O(l,u),1&t&&s!==(s=e[13].name)&&_(n,"for",s),m===(m=d(e,t))&&g?g.p(e,t):(g.d(1),g=m(e),g&&(g.c(),g.m(r,null)))},d(e){e&&h(t),g.d()}}}function yt(t){let n,l=t[0].length>0&&ut(t);return{c(){l&&l.c(),n=w()},m(e,t){l&&l.m(e,t),p(e,n,t)},p(e,[t]){e[0].length>0?l?l.p(e,t):(l=ut(e),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},i:e,o:e,d(e){l&&l.d(e),e&&h(n)}}}function vt(e,t,n){let l,{recordsStore:s}=t;const{recordSearch:c,searchParams:r}=s;d(e,r,(e=>n(11,l=e)));let{searchFields:o=[]}=t,i={};var a;a=()=>{const e=l??new URLSearchParams(window.location.search);o.forEach((t=>{n(1,i[t.name]=e.get(t.name)||t.initial||"",i)}))},T().$$.on_mount.push(a);return e.$$set=e=>{"recordsStore"in e&&n(5,s=e.recordsStore),"searchFields"in e&&n(0,o=e.searchFields)},[o,i,r,function(e){e.preventDefault(),c(i)},e=>e.type.includes("Multiple"),s,function(e){i[e.name]=function(e){const t=e.querySelector(":checked");return t&&t.__value}(this),n(1,i),n(0,o)},function(e){i[e.name]=this.checked,n(1,i),n(0,o)},function(e){i[e.name]=this.value,n(1,i),n(0,o)},function(e){i[e.name]=L(this.value),n(1,i),n(0,o)},function(e){i[e.name]=this.value,n(1,i),n(0,o)}]}class wt extends ce{constructor(e){super(),se(this,e,vt,yt,r,{recordsStore:5,searchFields:0})}}function kt(e){let t,n,l,s,c,r,o,i,a,u=e[4]>1&&xt(e),d=e[4]<e[3]&&Pt(e);return{c(){t=b("nav"),n=b("ul"),u&&u.c(),l=v(),s=b("li"),c=b("a"),r=y(e[4]),o=v(),d&&d.c(),_(c,"class","pagination-link is-current"),_(c,"href",null),_(n,"class","pagination-list ml-0"),_(t,"class","pagination is-centered mb-2"),_(t,"aria-label","pagination")},m(m,h){p(m,t,h),f(t,n),u&&u.m(n,null),f(n,l),f(n,s),f(s,c),f(c,r),f(n,o),d&&d.m(n,null),i||(a=k(c,"click",x(e[8])),i=!0)},p(e,t){e[4]>1?u?u.p(e,t):(u=xt(e),u.c(),u.m(n,l)):u&&(u.d(1),u=null),16&t&&O(r,e[4]),e[4]<e[3]?d?d.p(e,t):(d=Pt(e),d.c(),d.m(n,null)):d&&(d.d(1),d=null)},d(e){e&&h(t),u&&u.d(),d&&d.d(),i=!1,a()}}}function xt(e){let t,n,l,s,c,r,o=e[4]-1>1&&_t(e);return{c(){t=b("li"),n=b("a"),n.textContent="1",l=v(),o&&o.c(),s=w(),_(n,"class","pagination-link"),_(n,"href",null)},m(i,a){p(i,t,a),f(t,n),p(i,l,a),o&&o.m(i,a),p(i,s,a),c||(r=k(n,"click",x(e[6])),c=!0)},p(e,t){e[4]-1>1?o?o.p(e,t):(o=_t(e),o.c(),o.m(s.parentNode,s)):o&&(o.d(1),o=null)},d(e){e&&h(t),e&&h(l),o&&o.d(e),e&&h(s),c=!1,r()}}}function _t(e){let t,n,l,s,c,r,o=e[4]-1+"",i=e[4]-1>2&&St();return{c(){i&&i.c(),t=v(),n=b("li"),l=b("a"),s=y(o),_(l,"class","pagination-link"),_(l,"href",null)},m(o,a){i&&i.m(o,a),p(o,t,a),p(o,n,a),f(n,l),f(l,s),c||(r=k(l,"click",x(e[7])),c=!0)},p(e,n){e[4]-1>2?i||(i=St(),i.c(),i.m(t.parentNode,t)):i&&(i.d(1),i=null),16&n&&o!==(o=e[4]-1+"")&&O(s,o)},d(e){i&&i.d(e),e&&h(t),e&&h(n),c=!1,r()}}}function St(e){let t;return{c(){t=b("li"),t.innerHTML='<span class="pagination-ellipsis">…</span>'},m(e,n){p(e,t,n)},d(e){e&&h(t)}}}function Pt(e){let t,n,l,s,c,r,o=e[4]+1<e[3]&&Lt(e);return{c(){o&&o.c(),t=v(),n=b("li"),l=b("a"),s=y(e[3]),_(l,"class","pagination-link"),_(l,"href",null)},m(i,a){o&&o.m(i,a),p(i,t,a),p(i,n,a),f(n,l),f(l,s),c||(r=k(l,"click",x(e[10])),c=!0)},p(e,n){e[4]+1<e[3]?o?o.p(e,n):(o=Lt(e),o.c(),o.m(t.parentNode,t)):o&&(o.d(1),o=null),8&n&&O(s,e[3])},d(e){o&&o.d(e),e&&h(t),e&&h(n),c=!1,r()}}}function Lt(e){let t,n,l,s,c,r,o,i=e[4]+1+"",a=e[4]+2<e[3]&&Ot();return{c(){t=b("li"),n=b("a"),l=y(i),s=v(),a&&a.c(),c=w(),_(n,"class","pagination-link"),_(n,"href",null)},m(i,u){p(i,t,u),f(t,n),f(n,l),p(i,s,u),a&&a.m(i,u),p(i,c,u),r||(o=k(n,"click",x(e[9])),r=!0)},p(e,t){16&t&&i!==(i=e[4]+1+"")&&O(l,i),e[4]+2<e[3]?a||(a=Ot(),a.c(),a.m(c.parentNode,c)):a&&(a.d(1),a=null)},d(e){e&&h(t),e&&h(s),a&&a.d(e),e&&h(c),r=!1,o()}}}function Ot(e){let t;return{c(){t=b("li"),t.innerHTML='<span class="pagination-ellipsis">…</span>'},m(e,n){p(e,t,n)},d(e){e&&h(t)}}}function At(t){let n,l,s,c,r,o,i,a=t[4]*t[2]-t[2]+1+"",u=Math.min(t[4]*t[2],t[1])+"",d=t[3]>1&&kt(t);return{c(){d&&d.c(),n=v(),l=b("div"),s=y(a),c=y(" - "),r=y(u),o=y(" / "),i=y(t[1]),_(l,"class","is-size-7 is-center mb-4")},m(e,t){d&&d.m(e,t),p(e,n,t),p(e,l,t),f(l,s),f(l,c),f(l,r),f(l,o),f(l,i)},p(e,[t]){e[3]>1?d?d.p(e,t):(d=kt(e),d.c(),d.m(n.parentNode,n)):d&&(d.d(1),d=null),20&t&&a!==(a=e[4]*e[2]-e[2]+1+"")&&O(s,a),22&t&&u!==(u=Math.min(e[4]*e[2],e[1])+"")&&O(r,u),2&t&&O(i,e[1])},i:e,o:e,d(e){d&&d.d(e),e&&h(n),e&&h(l)}}}function Nt(e,t,n){let l,s,{store:c}=t;const{currentPage:r}=c;d(e,r,(e=>n(4,s=e)));let{nbOfItems:o}=t,{pageLength:i=50}=t;return e.$$set=e=>{"store"in e&&n(0,c=e.store),"nbOfItems"in e&&n(1,o=e.nbOfItems),"pageLength"in e&&n(2,i=e.pageLength)},e.$$.update=()=>{6&e.$$.dirty&&n(3,l=Math.ceil(o/i))},[c,o,i,l,s,r,()=>c.handlePageUpdate(1),()=>c.handlePageUpdate(s-1),()=>c.handlePageUpdate(s),()=>c.handlePageUpdate(s+1),()=>c.handlePageUpdate(l)]}class Rt extends ce{constructor(e){super(),se(this,e,Nt,At,r,{store:0,nbOfItems:1,pageLength:2})}}function Et(t){let n,l,s,c,r,o,i,a,u,d,m,g,$,y,w;return{c(){n=b("button"),l=v(),s=b("div"),c=b("div"),r=v(),o=b("div"),i=b("div"),i.innerHTML='<div class="title is-4 mb-0 media-content"><span id="modal-title" class="mb-0"></span></div> \n            <button class="delete media-left" aria-label="close"></button>',a=v(),u=b("section"),d=v(),m=b("footer"),g=b("div"),$=b("button"),$.textContent=""+("en"===ae?"Cancel":"Annuler"),y=v(),w=b("button"),w.textContent="OK",_(n,"id","hidden-msg-btn"),_(n,"class","js-modal-trigger"),_(n,"data-target","msg-modal"),n.hidden=!0,_(c,"id","modal-bkg"),_(c,"class","modal-background"),_(i,"class","modal-card-head media mb-0"),_(u,"id","modal-body"),_(u,"class","modal-card-body"),_($,"id","cancel-btn"),_($,"class","button is-link is-light button-close"),_(w,"id","ok-btn"),_(w,"class","button is-link button-close"),_(g,"class","buttons"),_(m,"id","modal-footer"),_(m,"class","modal-card-foot is-center pt-3"),m.hidden=!0,_(o,"class","modal-content"),_(s,"id","msg-modal"),_(s,"class","modal fade"),_(s,"tabindex","-1"),_(s,"aria-labelledby","selection-modal-label"),_(s,"aria-hidden","true")},m(e,t){p(e,n,t),p(e,l,t),p(e,s,t),f(s,c),f(s,r),f(s,o),f(o,i),f(o,a),f(o,u),f(o,d),f(o,m),f(m,g),f(g,$),f(g,y),f(g,w)},p:e,i:e,o:e,d(e){e&&h(n),e&&h(l),e&&h(s)}}}class jt extends ce{constructor(e){super(),se(this,e,null,Et,r,{})}}function Ct(e){const t=e,n=oe(1),l=oe([]),s=oe(0),c=oe(new URLSearchParams(window.location.search));async function r(){const e=u(c);e.set("p",`${u(n)}`);try{const c=await fetch(`${window.location.origin}/search/${t}/?${e.toString()}`),r=await c.json();l.set(r.results),s.set(r.count),n.set(r.current_page),e.set("p",String(u(n)));const o=`${window.location.pathname}?${e.toString()}`;return history.pushState(null,"",o),r}catch(e){throw console.error("Error fetching page:",e),e}}!function(e,t){if("undefined"!=typeof window){const n=parseInt(new URLSearchParams(window.location.search).get(t));if(!isNaN(n))return e.set(n),n}e.set(1)}(n,"p");let o=r();function i(e){!function(e,t,n){if(t.set(e),"undefined"!=typeof window){const t=new URL(window.location.href);t.searchParams.set(n,e),window.history.pushState({},"",t)}}(e,n,"p"),o=r()}return{currentPage:n,pageRecords:l,resultPage:o,resultNumber:s,fetchPage:r,handlePageUpdate:i,recordSearch:function(e){const t=new URLSearchParams(e);c.set(t),i(1)}}}function Tt(e,t,n){const l=e.slice();return l[15]=t[n][0],l[16]=t[n][1],l}function It(e,t,n){const l=e.slice();return l[19]=t[n][0],l[20]=t[n][1],l}function Mt(e,t,n){const l=e.slice();return l[24]=t[n],l}function Ft(t){let n,l,s,c,r="en"===ae?"Error when retrieving records: ":"Erreur lors de la récupération des enregistrements : ",o=t[27]+"";return{c(){n=b("div"),l=y(r),s=v(),c=y(o),_(n,"class","faded is-center")},m(e,t){p(e,n,t),f(n,l),f(n,s),f(n,c)},p:e,i:e,o:e,d(e){e&&h(n)}}}function Ut(e){let t,n,l=0!==e[3].length&&Ht(e);return{c(){l&&l.c(),t=w()},m(e,s){l&&l.m(e,s),p(e,t,s),n=!0},p(e,n){0!==e[3].length?l?(l.p(e,n),8&n&&Q(l,1)):(l=Ht(e),l.c(),Q(l,1),l.m(t.parentNode,t)):l&&(K(),W(l,1,1,(()=>{l=null})),Y())},i(e){n||(Q(l),n=!0)},o(e){W(l),n=!1},d(e){l&&l.d(e),e&&h(t)}}}function Ht(e){let t,n,l,c,r,o,i=[],a=new Map;t=new Rt({props:{store:e[7],nbOfItems:e[4]}});let u=e[3];const d=e=>e[24].id;for(let t=0;t<u.length;t+=1){let n=Mt(e,u,t),l=d(n);a.set(l,i[t]=Dt(l,n))}let m=null;return u.length||(m=zt()),r=new Rt({props:{store:e[7],nbOfItems:e[4]}}),{c(){ee(t.$$.fragment),n=v(),l=b("div");for(let e=0;e<i.length;e+=1)i[e].c();m&&m.c(),c=v(),ee(r.$$.fragment)},m(e,s){te(t,e,s),p(e,n,s),p(e,l,s);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(l,null);m&&m.m(l,null),p(e,c,s),te(r,e,s),o=!0},p(e,n){const c={};16&n&&(c.nbOfItems=e[4]),t.$set(c),8&n&&(u=e[3],K(),i=function(e,t,n,l,c,r,o,i,a,u,d,m){let f=e.length,p=r.length,h=f;const g={};for(;h--;)g[e[h].key]=h;const b=[],$=new Map,y=new Map,v=[];for(h=p;h--;){const e=m(c,r,h),s=n(e);let i=o.get(s);i?l&&v.push((()=>i.p(e,t))):(i=u(s,e),i.c()),$.set(s,b[h]=i),s in g&&y.set(s,Math.abs(h-g[s]))}const w=new Set,k=new Set;function x(e){Q(e,1),e.m(i,d),o.set(e.key,e),d=e.first,p--}for(;f&&p;){const t=b[p-1],n=e[f-1],l=t.key,s=n.key;t===n?(d=t.first,f--,p--):$.has(s)?!o.has(l)||w.has(l)?x(t):k.has(s)?f--:y.get(l)>y.get(s)?(k.add(l),x(t)):(w.add(s),f--):(a(n,o),f--)}for(;f--;){const t=e[f];$.has(t.key)||a(t,o)}for(;p;)x(b[p-1]);return s(v),b}(i,n,d,1,e,u,a,l,Z,Dt,null,Mt),Y(),!u.length&&m?m.p(e,n):u.length?m&&(m.d(1),m=null):(m=zt(),m.c(),m.m(l,null)));const o={};16&n&&(o.nbOfItems=e[4]),r.$set(o)},i(e){if(!o){Q(t.$$.fragment,e);for(let e=0;e<u.length;e+=1)Q(i[e]);Q(r.$$.fragment,e),o=!0}},o(e){W(t.$$.fragment,e);for(let e=0;e<i.length;e+=1)W(i[e]);W(r.$$.fragment,e),o=!1},d(e){ne(t,e),e&&h(n),e&&h(l);for(let e=0;e<i.length;e+=1)i[e].d();m&&m.d(),e&&h(c),ne(r,e)}}}function zt(t){let n;return{c(){n=b("p"),n.textContent=""+("en"===ae?"No records found":"Aucun enregistrement trouvé")},m(e,t){p(e,n,t)},p:e,d(e){e&&h(n)}}}function Dt(e,t){let n,l,s;return l=new Xe({props:{item:t[24]}}),{key:e,first:null,c(){n=w(),ee(l.$$.fragment),this.first=n},m(e,t){p(e,n,t),te(l,e,t),s=!0},p(e,n){t=e;const s={};8&n&&(s.item=t[24]),l.$set(s)},i(e){s||(Q(l.$$.fragment,e),s=!0)},o(e){W(l.$$.fragment,e),s=!1},d(e){e&&h(n),ne(l,e)}}}function Vt(t){let n;return{c(){n=b("div"),n.textContent=""+("en"===ae?"Retrieving records...":"Récupération des enregistrements..."),_(n,"class","faded is-center")},m(e,t){p(e,n,t)},p:e,i:e,o:e,d(e){e&&h(n)}}}function Gt(t){let n,l,s;return{c(){n=b("tr"),l=b("td"),l.textContent=""+("en"===ae?"No documents in selection":"Aucun document sélectionné"),s=v()},m(e,t){p(e,n,t),f(n,l),f(n,s)},p:e,d(e){e&&h(n)}}}function Bt(t){let n,l,s;return{c(){n=b("tr"),l=b("td"),l.textContent=""+("en"===ae?"No documents in selection":"Aucun document sélectionné"),s=v()},m(e,t){p(e,n,t),f(n,l),f(n,s)},p:e,d(e){e&&h(n)}}}function qt(e){let t,n,l,s,c,r,o,i,a,u,d,m,g,$,w,x,S=e[19]+"",P=e[20].title+"";function L(){return e[14](e[19],e[15])}return{c(){t=b("tr"),n=b("th"),l=b("span"),s=y("#"),c=y(S),r=v(),o=b("td"),i=b("a"),a=y(P),d=v(),m=b("td"),g=b("button"),$=v(),_(l,"class","tag px-2 py-1 mb-1 is-dark is-rounded"),_(n,"class","is-narrow is-3"),_(i,"href",u=e[20].url),_(i,"target","_blank"),_(g,"class","delete"),_(g,"aria-label","close"),_(m,"class","is-narrow")},m(e,u){p(e,t,u),f(t,n),f(n,l),f(l,s),f(l,c),f(t,r),f(t,o),f(o,i),f(i,a),f(t,d),f(t,m),f(m,g),f(t,$),w||(x=k(g,"click",L),w=!0)},p(t,n){e=t,4&n&&S!==(S=e[19]+"")&&O(c,S),4&n&&P!==(P=e[20].title+"")&&O(a,P),4&n&&u!==(u=e[20].url)&&_(i,"href",u)},d(e){e&&h(t),w=!1,x()}}}function Jt(e){let t,n,l,s,c,r,o=e[15]+"",i=Object.entries(e[16]),a=[];for(let t=0;t<i.length;t+=1)a[t]=qt(It(e,i,t));let u=null;return i.length||(u=Bt()),{c(){t=b("h3"),n=y(o),l=v(),s=b("table"),c=b("tbody");for(let e=0;e<a.length;e+=1)a[e].c();u&&u.c(),r=v(),_(s,"class","table pl-2 is-fullwidth")},m(e,o){p(e,t,o),f(t,n),p(e,l,o),p(e,s,o),f(s,c);for(let e=0;e<a.length;e+=1)a[e]&&a[e].m(c,null);u&&u.m(c,null),f(s,r)},p(e,t){if(4&t&&o!==(o=e[15]+"")&&O(n,o),4&t){let n;for(i=Object.entries(e[16]),n=0;n<i.length;n+=1){const l=It(e,i,n);a[n]?a[n].p(l,t):(a[n]=qt(l),a[n].c(),a[n].m(c,null))}for(;n<a.length;n+=1)a[n].d(1);a.length=i.length,!i.length&&u?u.p(e,t):i.length?u&&(u.d(1),u=null):(u=Bt(),u.c(),u.m(c,null))}},d(e){e&&h(t),e&&h(l),e&&h(s),g(a,e),u&&u.d()}}}function Xt(e){let t,n=e[2],l=[];for(let t=0;t<n.length;t+=1)l[t]=Jt(Tt(e,n,t));let s=null;return n.length||(s=Gt()),{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=w(),s&&s.c()},m(e,n){for(let t=0;t<l.length;t+=1)l[t]&&l[t].m(e,n);p(e,t,n),s&&s.m(e,n)},p(e,c){if(4&c){let r;for(n=e[2],r=0;r<n.length;r+=1){const s=Tt(e,n,r);l[r]?l[r].p(s,c):(l[r]=Jt(s),l[r].c(),l[r].m(t.parentNode,t))}for(;r<l.length;r+=1)l[r].d(1);l.length=n.length,!n.length&&s?s.p(e,c):n.length?s&&(s.d(1),s=null):(s=Gt(),s.c(),s.m(t.parentNode,t))}},d(e){g(l,e),e&&h(t),s&&s.d(e)}}}function Kt(e){let t,n,l,s,c,r,o,i,a;t=new jt({}),l=new Qe({props:{selectionLength:e[1]}}),c=new wt({props:{recordsStore:e[7],searchFields:e[0]}});let u={ctx:e,current:null,token:null,hasCatch:!0,pending:Vt,then:Ut,catch:Ft,value:23,error:27,blocks:[,,,]};return function(e,t){const n=t.token={};function l(e,l,s,c){if(t.token!==n)return;t.resolved=c;let r=t.ctx;void 0!==s&&(r=r.slice(),r[s]=c);const o=e&&(t.current=e)(r);let i=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==l&&e&&(K(),W(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),Y())})):t.block.d(1),o.c(),Q(o,1),o.m(t.mount(),t.anchor),i=!0),t.block=o,t.blocks&&(t.blocks[l]=o),i&&B()}if(!(s=e)||"object"!=typeof s&&"function"!=typeof s||"function"!=typeof s.then){if(t.current!==t.then)return l(t.then,1,t.value,e),!0;t.resolved=e}else{const n=T();if(e.then((e=>{C(n),l(t.then,1,t.value,e),C(null)}),(e=>{if(C(n),l(t.catch,2,t.error,e),C(null),!t.hasCatch)throw e})),t.current!==t.pending)return l(t.pending,0),!0}var s}(e[9],u),i=new ot({props:{selectionLength:e[1],$$slots:{default:[Xt]},$$scope:{ctx:e}}}),{c(){ee(t.$$.fragment),n=v(),ee(l.$$.fragment),s=v(),ee(c.$$.fragment),r=v(),u.block.c(),o=v(),ee(i.$$.fragment)},m(e,d){te(t,e,d),p(e,n,d),te(l,e,d),p(e,s,d),te(c,e,d),p(e,r,d),u.block.m(e,u.anchor=d),u.mount=()=>o.parentNode,u.anchor=o,p(e,o,d),te(i,e,d),a=!0},p(t,[n]){e=t;const s={};2&n&&(s.selectionLength=e[1]),l.$set(s);const r={};1&n&&(r.searchFields=e[0]),c.$set(r),function(e,t,n){const l=t.slice(),{resolved:s}=e;e.current===e.then&&(l[e.value]=s),e.current===e.catch&&(l[e.error]=s),e.block.p(l,n)}(u,e,n);const o={};2&n&&(o.selectionLength=e[1]),268435460&n&&(o.$$scope={dirty:n,ctx:e}),i.$set(o)},i(e){a||(Q(t.$$.fragment,e),Q(l.$$.fragment,e),Q(c.$$.fragment,e),Q(u.block),Q(i.$$.fragment,e),a=!0)},o(e){W(t.$$.fragment,e),W(l.$$.fragment,e),W(c.$$.fragment,e);for(let e=0;e<3;e+=1){W(u.blocks[e])}W(i.$$.fragment,e),a=!1},d(e){ne(t,e),e&&h(n),ne(l,e),e&&h(s),ne(c,e),e&&h(r),u.block.d(e),u.token=null,u=null,e&&h(o),ne(i,e)}}}function Yt(e,t,n){let l,s,c,r,o,i;const{selected:a,nbSelected:u}=he;d(e,a,(e=>n(13,r=e))),d(e,u,(e=>n(12,c=e)));let{modelName:m=""}=t;var f,p;f="modelName",p=m,T().$$.context.set(f,p);const h=Ct(m),{pageRecords:g,resultPage:b,resultNumber:$}=h;d(e,g,(e=>n(3,o=e))),d(e,$,(e=>n(4,i=e)));let{searchFields:y=[]}=t;return e.$$set=e=>{"modelName"in e&&n(11,m=e.modelName),"searchFields"in e&&n(0,y=e.searchFields)},e.$$.update=()=>{8192&e.$$.dirty&&n(2,l=r(!1)),4096&e.$$.dirty&&n(1,s=c(!1))},[y,s,l,o,i,a,u,h,g,b,$,m,c,r,(e,t)=>he.remove(e,t)]}return new class extends ce{constructor(e){super(),se(this,e,Yt,Kt,r,{modelName:11,searchFields:0})}}({target:document.getElementById("record-list"),props:{searchFields:searchFields,modelName:modelName}})}();
//# sourceMappingURL=recordList.js.map
